| distributed init (rank 0): env://, gpu 0
| distributed init (rank 1): env://, gpu 1
Namespace(batch_size=200, epochs=20, update_freq=1, save_ckpt_freq=3, robust_test=None, model='EEGPT', qkv_bias=True, rel_pos_bias=False, abs_pos_emb=True, layer_scale_init_value=0.1, input_size=200, drop=0.0, attn_drop_rate=0.0, drop_path=0.2, disable_eval_during_finetuning=False, model_ema=False, model_ema_decay=0.9999, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, weight_decay_end=None, lr=0.0005, layer_decay=0.65, warmup_lr=1e-06, min_lr=1e-06, warmup_epochs=5, warmup_steps=-1, smoothing=0.1, reprob=0.25, remode='pixel', recount=1, resplit=False, finetune='/home/aa2650/playground/EEGPT/checkpoint/eegpt_mcae_58chs_4s_large4E.ckpt', model_key='model|module|state_dict', model_prefix='', model_filter_name='gzp', init_scale=0.001, use_mean_pooling=True, disable_weight_decay_on_rel_pos_bias=False, nb_classes=0, output_dir='./checkpoints_TUEV/finetune_tuev_eegpt/', log_dir='./log/finetune_tuev_eegpt', device='cuda', seed=0, resume='', auto_resume=True, save_ckpt=True, start_epoch=0, eval=False, dist_eval=True, num_workers=10, pin_mem=True, world_size=2, local_rank=-1, dist_on_itp=False, dist_url='env://', enable_deepspeed=False, dataset='TUEV', rank=0, gpu=0, distributed=True, dist_backend='nccl')
65967 17965 28305
Sampler_train = <torch.utils.data.distributed.DistributedSampler object at 0x71d2d2dbac50>
Warning: Enabling distributed evaluation with an eval dataset not divisible by process number. This will slightly alter validation results as extra duplicate entries are added to achieve equal num of samples per-process.
Patch size = 200
Load ckpt from /home/aa2650/playground/EEGPT/checkpoint/eegpt_mcae_58chs_4s_large4E.ckpt
Weights of EEGPTClassifier not initialized from pretrained model: ['chan_conv.0.weight', 'chan_conv.0.bias', 'chan_conv.1.weight', 'chan_conv.1.bias', 'chan_conv.1.running_mean', 'chan_conv.1.running_var', 'chan_conv.3.weight', 'chan_conv.3.bias', 'chan_conv.4.weight', 'chan_conv.4.bias', 'chan_conv.4.running_mean', 'chan_conv.4.running_var', 'reconstructor.cls_token', 'fc_norm.weight', 'fc_norm.bias', 'head.1.weight', 'head.1.bias']
Weights from pretrained model not used in EEGPTClassifier: ['encoder.summary_token', 'encoder.patch_embed.proj.weight', 'encoder.patch_embed.proj.bias', 'encoder.chan_embed.weight', 'encoder.blocks.0.norm1.weight', 'encoder.blocks.0.norm1.bias', 'encoder.blocks.0.attn.qkv.weight', 'encoder.blocks.0.attn.qkv.bias', 'encoder.blocks.0.attn.proj.weight', 'encoder.blocks.0.attn.proj.bias', 'encoder.blocks.0.norm2.weight', 'encoder.blocks.0.norm2.bias', 'encoder.blocks.0.mlp.fc1.weight', 'encoder.blocks.0.mlp.fc1.bias', 'encoder.blocks.0.mlp.fc2.weight', 'encoder.blocks.0.mlp.fc2.bias', 'encoder.blocks.1.norm1.weight', 'encoder.blocks.1.norm1.bias', 'encoder.blocks.1.attn.qkv.weight', 'encoder.blocks.1.attn.qkv.bias', 'encoder.blocks.1.attn.proj.weight', 'encoder.blocks.1.attn.proj.bias', 'encoder.blocks.1.norm2.weight', 'encoder.blocks.1.norm2.bias', 'encoder.blocks.1.mlp.fc1.weight', 'encoder.blocks.1.mlp.fc1.bias', 'encoder.blocks.1.mlp.fc2.weight', 'encoder.blocks.1.mlp.fc2.bias', 'encoder.blocks.2.norm1.weight', 'encoder.blocks.2.norm1.bias', 'encoder.blocks.2.attn.qkv.weight', 'encoder.blocks.2.attn.qkv.bias', 'encoder.blocks.2.attn.proj.weight', 'encoder.blocks.2.attn.proj.bias', 'encoder.blocks.2.norm2.weight', 'encoder.blocks.2.norm2.bias', 'encoder.blocks.2.mlp.fc1.weight', 'encoder.blocks.2.mlp.fc1.bias', 'encoder.blocks.2.mlp.fc2.weight', 'encoder.blocks.2.mlp.fc2.bias', 'encoder.blocks.3.norm1.weight', 'encoder.blocks.3.norm1.bias', 'encoder.blocks.3.attn.qkv.weight', 'encoder.blocks.3.attn.qkv.bias', 'encoder.blocks.3.attn.proj.weight', 'encoder.blocks.3.attn.proj.bias', 'encoder.blocks.3.norm2.weight', 'encoder.blocks.3.norm2.bias', 'encoder.blocks.3.mlp.fc1.weight', 'encoder.blocks.3.mlp.fc1.bias', 'encoder.blocks.3.mlp.fc2.weight', 'encoder.blocks.3.mlp.fc2.bias', 'encoder.blocks.4.norm1.weight', 'encoder.blocks.4.norm1.bias', 'encoder.blocks.4.attn.qkv.weight', 'encoder.blocks.4.attn.qkv.bias', 'encoder.blocks.4.attn.proj.weight', 'encoder.blocks.4.attn.proj.bias', 'encoder.blocks.4.norm2.weight', 'encoder.blocks.4.norm2.bias', 'encoder.blocks.4.mlp.fc1.weight', 'encoder.blocks.4.mlp.fc1.bias', 'encoder.blocks.4.mlp.fc2.weight', 'encoder.blocks.4.mlp.fc2.bias', 'encoder.blocks.5.norm1.weight', 'encoder.blocks.5.norm1.bias', 'encoder.blocks.5.attn.qkv.weight', 'encoder.blocks.5.attn.qkv.bias', 'encoder.blocks.5.attn.proj.weight', 'encoder.blocks.5.attn.proj.bias', 'encoder.blocks.5.norm2.weight', 'encoder.blocks.5.norm2.bias', 'encoder.blocks.5.mlp.fc1.weight', 'encoder.blocks.5.mlp.fc1.bias', 'encoder.blocks.5.mlp.fc2.weight', 'encoder.blocks.5.mlp.fc2.bias', 'encoder.blocks.6.norm1.weight', 'encoder.blocks.6.norm1.bias', 'encoder.blocks.6.attn.qkv.weight', 'encoder.blocks.6.attn.qkv.bias', 'encoder.blocks.6.attn.proj.weight', 'encoder.blocks.6.attn.proj.bias', 'encoder.blocks.6.norm2.weight', 'encoder.blocks.6.norm2.bias', 'encoder.blocks.6.mlp.fc1.weight', 'encoder.blocks.6.mlp.fc1.bias', 'encoder.blocks.6.mlp.fc2.weight', 'encoder.blocks.6.mlp.fc2.bias', 'encoder.blocks.7.norm1.weight', 'encoder.blocks.7.norm1.bias', 'encoder.blocks.7.attn.qkv.weight', 'encoder.blocks.7.attn.qkv.bias', 'encoder.blocks.7.attn.proj.weight', 'encoder.blocks.7.attn.proj.bias', 'encoder.blocks.7.norm2.weight', 'encoder.blocks.7.norm2.bias', 'encoder.blocks.7.mlp.fc1.weight', 'encoder.blocks.7.mlp.fc1.bias', 'encoder.blocks.7.mlp.fc2.weight', 'encoder.blocks.7.mlp.fc2.bias', 'encoder.norm.weight', 'encoder.norm.bias', 'predictor.mask_token', 'predictor.predictor_embed.weight', 'predictor.predictor_embed.bias', 'predictor.time_embed.freqs', 'predictor.predictor_blocks.0.norm1.weight', 'predictor.predictor_blocks.0.norm1.bias', 'predictor.predictor_blocks.0.attn.qkv.weight', 'predictor.predictor_blocks.0.attn.qkv.bias', 'predictor.predictor_blocks.0.attn.proj.weight', 'predictor.predictor_blocks.0.attn.proj.bias', 'predictor.predictor_blocks.0.norm2.weight', 'predictor.predictor_blocks.0.norm2.bias', 'predictor.predictor_blocks.0.mlp.fc1.weight', 'predictor.predictor_blocks.0.mlp.fc1.bias', 'predictor.predictor_blocks.0.mlp.fc2.weight', 'predictor.predictor_blocks.0.mlp.fc2.bias', 'predictor.predictor_blocks.1.norm1.weight', 'predictor.predictor_blocks.1.norm1.bias', 'predictor.predictor_blocks.1.attn.qkv.weight', 'predictor.predictor_blocks.1.attn.qkv.bias', 'predictor.predictor_blocks.1.attn.proj.weight', 'predictor.predictor_blocks.1.attn.proj.bias', 'predictor.predictor_blocks.1.norm2.weight', 'predictor.predictor_blocks.1.norm2.bias', 'predictor.predictor_blocks.1.mlp.fc1.weight', 'predictor.predictor_blocks.1.mlp.fc1.bias', 'predictor.predictor_blocks.1.mlp.fc2.weight', 'predictor.predictor_blocks.1.mlp.fc2.bias', 'predictor.predictor_blocks.2.norm1.weight', 'predictor.predictor_blocks.2.norm1.bias', 'predictor.predictor_blocks.2.attn.qkv.weight', 'predictor.predictor_blocks.2.attn.qkv.bias', 'predictor.predictor_blocks.2.attn.proj.weight', 'predictor.predictor_blocks.2.attn.proj.bias', 'predictor.predictor_blocks.2.norm2.weight', 'predictor.predictor_blocks.2.norm2.bias', 'predictor.predictor_blocks.2.mlp.fc1.weight', 'predictor.predictor_blocks.2.mlp.fc1.bias', 'predictor.predictor_blocks.2.mlp.fc2.weight', 'predictor.predictor_blocks.2.mlp.fc2.bias', 'predictor.predictor_blocks.3.norm1.weight', 'predictor.predictor_blocks.3.norm1.bias', 'predictor.predictor_blocks.3.attn.qkv.weight', 'predictor.predictor_blocks.3.attn.qkv.bias', 'predictor.predictor_blocks.3.attn.proj.weight', 'predictor.predictor_blocks.3.attn.proj.bias', 'predictor.predictor_blocks.3.norm2.weight', 'predictor.predictor_blocks.3.norm2.bias', 'predictor.predictor_blocks.3.mlp.fc1.weight', 'predictor.predictor_blocks.3.mlp.fc1.bias', 'predictor.predictor_blocks.3.mlp.fc2.weight', 'predictor.predictor_blocks.3.mlp.fc2.bias', 'predictor.predictor_blocks.4.norm1.weight', 'predictor.predictor_blocks.4.norm1.bias', 'predictor.predictor_blocks.4.attn.qkv.weight', 'predictor.predictor_blocks.4.attn.qkv.bias', 'predictor.predictor_blocks.4.attn.proj.weight', 'predictor.predictor_blocks.4.attn.proj.bias', 'predictor.predictor_blocks.4.norm2.weight', 'predictor.predictor_blocks.4.norm2.bias', 'predictor.predictor_blocks.4.mlp.fc1.weight', 'predictor.predictor_blocks.4.mlp.fc1.bias', 'predictor.predictor_blocks.4.mlp.fc2.weight', 'predictor.predictor_blocks.4.mlp.fc2.bias', 'predictor.predictor_blocks.5.norm1.weight', 'predictor.predictor_blocks.5.norm1.bias', 'predictor.predictor_blocks.5.attn.qkv.weight', 'predictor.predictor_blocks.5.attn.qkv.bias', 'predictor.predictor_blocks.5.attn.proj.weight', 'predictor.predictor_blocks.5.attn.proj.bias', 'predictor.predictor_blocks.5.norm2.weight', 'predictor.predictor_blocks.5.norm2.bias', 'predictor.predictor_blocks.5.mlp.fc1.weight', 'predictor.predictor_blocks.5.mlp.fc1.bias', 'predictor.predictor_blocks.5.mlp.fc2.weight', 'predictor.predictor_blocks.5.mlp.fc2.bias', 'predictor.predictor_blocks.6.norm1.weight', 'predictor.predictor_blocks.6.norm1.bias', 'predictor.predictor_blocks.6.attn.qkv.weight', 'predictor.predictor_blocks.6.attn.qkv.bias', 'predictor.predictor_blocks.6.attn.proj.weight', 'predictor.predictor_blocks.6.attn.proj.bias', 'predictor.predictor_blocks.6.norm2.weight', 'predictor.predictor_blocks.6.norm2.bias', 'predictor.predictor_blocks.6.mlp.fc1.weight', 'predictor.predictor_blocks.6.mlp.fc1.bias', 'predictor.predictor_blocks.6.mlp.fc2.weight', 'predictor.predictor_blocks.6.mlp.fc2.bias', 'predictor.predictor_blocks.7.norm1.weight', 'predictor.predictor_blocks.7.norm1.bias', 'predictor.predictor_blocks.7.attn.qkv.weight', 'predictor.predictor_blocks.7.attn.qkv.bias', 'predictor.predictor_blocks.7.attn.proj.weight', 'predictor.predictor_blocks.7.attn.proj.bias', 'predictor.predictor_blocks.7.norm2.weight', 'predictor.predictor_blocks.7.norm2.bias', 'predictor.predictor_blocks.7.mlp.fc1.weight', 'predictor.predictor_blocks.7.mlp.fc1.bias', 'predictor.predictor_blocks.7.mlp.fc2.weight', 'predictor.predictor_blocks.7.mlp.fc2.bias', 'predictor.predictor_norm.weight', 'predictor.predictor_norm.bias', 'predictor.predictor_proj.weight', 'predictor.predictor_proj.bias']
Model = EEGPTClassifier(
  (chan_conv): Sequential(
    (0): Conv2dWithConstraint(23, 20, kernel_size=(1, 1), stride=(1, 1))
    (1): BatchNorm2d(20, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): GELU(approximate='none')
    (3): Conv2d(20, 20, kernel_size=(1, 55), stride=(1, 1), padding=same, groups=20)
    (4): BatchNorm2d(20, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): Dropout(p=0.8, inplace=False)
  )
  (target_encoder): EEGTransformer(
    (patch_embed): PatchEmbed(
      (proj): Conv2d(1, 512, kernel_size=(1, 64), stride=(1, 64))
    )
    (chan_embed): Embedding(62, 512)
    (blocks): ModuleList(
      (0-7): 8 x Block(
        (norm1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (attn): Attention(
          (qkv): Linear(in_features=512, out_features=1536, bias=True)
          (proj): Linear(in_features=512, out_features=512, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
        )
        (drop_path): Identity()
        (norm2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (mlp): MLP(
          (fc1): Linear(in_features=512, out_features=2048, bias=True)
          (act): GELU(approximate='none')
          (fc2): Linear(in_features=2048, out_features=512, bias=True)
          (drop): Dropout(p=0.0, inplace=False)
        )
      )
    )
    (norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
  )
  (reconstructor): EEGTransformerReconstructor(
    (reconstructor_embed): Linear(in_features=512, out_features=512, bias=True)
    (time_embed): RotaryEmbedding()
    (chan_embed): Embedding(62, 512)
    (reconstructor_blocks): ModuleList(
      (0-7): 8 x Block(
        (norm1): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (attn): Attention(
          (qkv): Linear(in_features=512, out_features=1536, bias=True)
          (proj): Linear(in_features=512, out_features=512, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
        )
        (drop_path): Identity()
        (norm2): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
        (mlp): MLP(
          (fc1): Linear(in_features=512, out_features=2048, bias=True)
          (act): GELU(approximate='none')
          (fc2): Linear(in_features=2048, out_features=512, bias=True)
          (drop): Dropout(p=0.0, inplace=False)
        )
      )
    )
    (reconstructor_norm): LayerNorm((512,), eps=1e-06, elementwise_affine=True)
    (reconstructor_proj): Linear(in_features=512, out_features=64, bias=True)
  )
  (norm): Identity()
  (fc_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  (head): Sequential(
    (0): Dropout(p=0.8, inplace=False)
    (1): LinearWithConstraint(in_features=30720, out_features=6, bias=True)
  )
)
number of params: 51022550
LR = 0.00050000
Batch size = 400
Update frequent = 1
Number of training examples = 65967
Number of training training per epoch = 164
Assigned values = [0.0006599743590836596, 0.0010153451678210146, 0.0015620694889554071, 0.002403183829162165, 0.003697205891018715, 0.005688009063105715, 0.008750783174008792, 0.013462743344628911, 0.02071191283789063, 0.03186448128906251, 0.049022278906250015, 0.07541889062500001, 0.11602906250000002, 0.17850625000000003, 0.274625, 0.42250000000000004, 0.65, 1.0]
Skip weight decay name marked in model: {'reconstructor.cls_token', 'target_encoder.summary_token', 'reconstructor.time_embed', 'reconstructor.chan_embed', 'reconstructor.pos_embed', 'target_encoder.chan_embed'}
Param groups = {
  "layer_17_decay": {
    "weight_decay": 0.05,
    "params": [
      "chan_conv.0.weight",
      "chan_conv.3.weight",
      "target_encoder.patch_embed.proj.weight",
      "target_encoder.chan_embed.weight",
      "target_encoder.blocks.0.attn.qkv.weight",
      "target_encoder.blocks.0.attn.proj.weight",
      "target_encoder.blocks.0.mlp.fc1.weight",
      "target_encoder.blocks.0.mlp.fc2.weight",
      "target_encoder.blocks.1.attn.qkv.weight",
      "target_encoder.blocks.1.attn.proj.weight",
      "target_encoder.blocks.1.mlp.fc1.weight",
      "target_encoder.blocks.1.mlp.fc2.weight",
      "target_encoder.blocks.2.attn.qkv.weight",
      "target_encoder.blocks.2.attn.proj.weight",
      "target_encoder.blocks.2.mlp.fc1.weight",
      "target_encoder.blocks.2.mlp.fc2.weight",
      "target_encoder.blocks.3.attn.qkv.weight",
      "target_encoder.blocks.3.attn.proj.weight",
      "target_encoder.blocks.3.mlp.fc1.weight",
      "target_encoder.blocks.3.mlp.fc2.weight",
      "target_encoder.blocks.4.attn.qkv.weight",
      "target_encoder.blocks.4.attn.proj.weight",
      "target_encoder.blocks.4.mlp.fc1.weight",
      "target_encoder.blocks.4.mlp.fc2.weight",
      "target_encoder.blocks.5.attn.qkv.weight",
      "target_encoder.blocks.5.attn.proj.weight",
      "target_encoder.blocks.5.mlp.fc1.weight",
      "target_encoder.blocks.5.mlp.fc2.weight",
      "target_encoder.blocks.6.attn.qkv.weight",
      "target_encoder.blocks.6.attn.proj.weight",
      "target_encoder.blocks.6.mlp.fc1.weight",
      "target_encoder.blocks.6.mlp.fc2.weight",
      "target_encoder.blocks.7.attn.qkv.weight",
      "target_encoder.blocks.7.attn.proj.weight",
      "target_encoder.blocks.7.mlp.fc1.weight",
      "target_encoder.blocks.7.mlp.fc2.weight",
      "reconstructor.mask_token",
      "reconstructor.reconstructor_embed.weight",
      "reconstructor.chan_embed.weight",
      "reconstructor.reconstructor_blocks.0.attn.qkv.weight",
      "reconstructor.reconstructor_blocks.0.attn.proj.weight",
      "reconstructor.reconstructor_blocks.0.mlp.fc1.weight",
      "reconstructor.reconstructor_blocks.0.mlp.fc2.weight",
      "reconstructor.reconstructor_blocks.1.attn.qkv.weight",
      "reconstructor.reconstructor_blocks.1.attn.proj.weight",
      "reconstructor.reconstructor_blocks.1.mlp.fc1.weight",
      "reconstructor.reconstructor_blocks.1.mlp.fc2.weight",
      "reconstructor.reconstructor_blocks.2.attn.qkv.weight",
      "reconstructor.reconstructor_blocks.2.attn.proj.weight",
      "reconstructor.reconstructor_blocks.2.mlp.fc1.weight",
      "reconstructor.reconstructor_blocks.2.mlp.fc2.weight",
      "reconstructor.reconstructor_blocks.3.attn.qkv.weight",
      "reconstructor.reconstructor_blocks.3.attn.proj.weight",
      "reconstructor.reconstructor_blocks.3.mlp.fc1.weight",
      "reconstructor.reconstructor_blocks.3.mlp.fc2.weight",
      "reconstructor.reconstructor_blocks.4.attn.qkv.weight",
      "reconstructor.reconstructor_blocks.4.attn.proj.weight",
      "reconstructor.reconstructor_blocks.4.mlp.fc1.weight",
      "reconstructor.reconstructor_blocks.4.mlp.fc2.weight",
      "reconstructor.reconstructor_blocks.5.attn.qkv.weight",
      "reconstructor.reconstructor_blocks.5.attn.proj.weight",
      "reconstructor.reconstructor_blocks.5.mlp.fc1.weight",
      "reconstructor.reconstructor_blocks.5.mlp.fc2.weight",
      "reconstructor.reconstructor_blocks.6.attn.qkv.weight",
      "reconstructor.reconstructor_blocks.6.attn.proj.weight",
      "reconstructor.reconstructor_blocks.6.mlp.fc1.weight",
      "reconstructor.reconstructor_blocks.6.mlp.fc2.weight",
      "reconstructor.reconstructor_blocks.7.attn.qkv.weight",
      "reconstructor.reconstructor_blocks.7.attn.proj.weight",
      "reconstructor.reconstructor_blocks.7.mlp.fc1.weight",
      "reconstructor.reconstructor_blocks.7.mlp.fc2.weight",
      "reconstructor.reconstructor_proj.weight",
      "head.1.weight"
    ],
    "lr_scale": 1.0
  },
  "layer_17_no_decay": {
    "weight_decay": 0.0,
    "params": [
      "chan_conv.0.bias",
      "chan_conv.1.weight",
      "chan_conv.1.bias",
      "chan_conv.3.bias",
      "chan_conv.4.weight",
      "chan_conv.4.bias",
      "target_encoder.summary_token",
      "target_encoder.patch_embed.proj.bias",
      "target_encoder.blocks.0.norm1.weight",
      "target_encoder.blocks.0.norm1.bias",
      "target_encoder.blocks.0.attn.qkv.bias",
      "target_encoder.blocks.0.attn.proj.bias",
      "target_encoder.blocks.0.norm2.weight",
      "target_encoder.blocks.0.norm2.bias",
      "target_encoder.blocks.0.mlp.fc1.bias",
      "target_encoder.blocks.0.mlp.fc2.bias",
      "target_encoder.blocks.1.norm1.weight",
      "target_encoder.blocks.1.norm1.bias",
      "target_encoder.blocks.1.attn.qkv.bias",
      "target_encoder.blocks.1.attn.proj.bias",
      "target_encoder.blocks.1.norm2.weight",
      "target_encoder.blocks.1.norm2.bias",
      "target_encoder.blocks.1.mlp.fc1.bias",
      "target_encoder.blocks.1.mlp.fc2.bias",
      "target_encoder.blocks.2.norm1.weight",
      "target_encoder.blocks.2.norm1.bias",
      "target_encoder.blocks.2.attn.qkv.bias",
      "target_encoder.blocks.2.attn.proj.bias",
      "target_encoder.blocks.2.norm2.weight",
      "target_encoder.blocks.2.norm2.bias",
      "target_encoder.blocks.2.mlp.fc1.bias",
      "target_encoder.blocks.2.mlp.fc2.bias",
      "target_encoder.blocks.3.norm1.weight",
      "target_encoder.blocks.3.norm1.bias",
      "target_encoder.blocks.3.attn.qkv.bias",
      "target_encoder.blocks.3.attn.proj.bias",
      "target_encoder.blocks.3.norm2.weight",
      "target_encoder.blocks.3.norm2.bias",
      "target_encoder.blocks.3.mlp.fc1.bias",
      "target_encoder.blocks.3.mlp.fc2.bias",
      "target_encoder.blocks.4.norm1.weight",
      "target_encoder.blocks.4.norm1.bias",
      "target_encoder.blocks.4.attn.qkv.bias",
      "target_encoder.blocks.4.attn.proj.bias",
      "target_encoder.blocks.4.norm2.weight",
      "target_encoder.blocks.4.norm2.bias",
      "target_encoder.blocks.4.mlp.fc1.bias",
      "target_encoder.blocks.4.mlp.fc2.bias",
      "target_encoder.blocks.5.norm1.weight",
      "target_encoder.blocks.5.norm1.bias",
      "target_encoder.blocks.5.attn.qkv.bias",
      "target_encoder.blocks.5.attn.proj.bias",
      "target_encoder.blocks.5.norm2.weight",
      "target_encoder.blocks.5.norm2.bias",
      "target_encoder.blocks.5.mlp.fc1.bias",
      "target_encoder.blocks.5.mlp.fc2.bias",
      "target_encoder.blocks.6.norm1.weight",
      "target_encoder.blocks.6.norm1.bias",
      "target_encoder.blocks.6.attn.qkv.bias",
      "target_encoder.blocks.6.attn.proj.bias",
      "target_encoder.blocks.6.norm2.weight",
      "target_encoder.blocks.6.norm2.bias",
      "target_encoder.blocks.6.mlp.fc1.bias",
      "target_encoder.blocks.6.mlp.fc2.bias",
      "target_encoder.blocks.7.norm1.weight",
      "target_encoder.blocks.7.norm1.bias",
      "target_encoder.blocks.7.attn.qkv.bias",
      "target_encoder.blocks.7.attn.proj.bias",
      "target_encoder.blocks.7.norm2.weight",
      "target_encoder.blocks.7.norm2.bias",
      "target_encoder.blocks.7.mlp.fc1.bias",
      "target_encoder.blocks.7.mlp.fc2.bias",
      "target_encoder.norm.weight",
      "target_encoder.norm.bias",
      "reconstructor.cls_token",
      "reconstructor.reconstructor_embed.bias",
      "reconstructor.reconstructor_blocks.0.norm1.weight",
      "reconstructor.reconstructor_blocks.0.norm1.bias",
      "reconstructor.reconstructor_blocks.0.attn.qkv.bias",
      "reconstructor.reconstructor_blocks.0.attn.proj.bias",
      "reconstructor.reconstructor_blocks.0.norm2.weight",
      "reconstructor.reconstructor_blocks.0.norm2.bias",
      "reconstructor.reconstructor_blocks.0.mlp.fc1.bias",
      "reconstructor.reconstructor_blocks.0.mlp.fc2.bias",
      "reconstructor.reconstructor_blocks.1.norm1.weight",
      "reconstructor.reconstructor_blocks.1.norm1.bias",
      "reconstructor.reconstructor_blocks.1.attn.qkv.bias",
      "reconstructor.reconstructor_blocks.1.attn.proj.bias",
      "reconstructor.reconstructor_blocks.1.norm2.weight",
      "reconstructor.reconstructor_blocks.1.norm2.bias",
      "reconstructor.reconstructor_blocks.1.mlp.fc1.bias",
      "reconstructor.reconstructor_blocks.1.mlp.fc2.bias",
      "reconstructor.reconstructor_blocks.2.norm1.weight",
      "reconstructor.reconstructor_blocks.2.norm1.bias",
      "reconstructor.reconstructor_blocks.2.attn.qkv.bias",
      "reconstructor.reconstructor_blocks.2.attn.proj.bias",
      "reconstructor.reconstructor_blocks.2.norm2.weight",
      "reconstructor.reconstructor_blocks.2.norm2.bias",
      "reconstructor.reconstructor_blocks.2.mlp.fc1.bias",
      "reconstructor.reconstructor_blocks.2.mlp.fc2.bias",
      "reconstructor.reconstructor_blocks.3.norm1.weight",
      "reconstructor.reconstructor_blocks.3.norm1.bias",
      "reconstructor.reconstructor_blocks.3.attn.qkv.bias",
      "reconstructor.reconstructor_blocks.3.attn.proj.bias",
      "reconstructor.reconstructor_blocks.3.norm2.weight",
      "reconstructor.reconstructor_blocks.3.norm2.bias",
      "reconstructor.reconstructor_blocks.3.mlp.fc1.bias",
      "reconstructor.reconstructor_blocks.3.mlp.fc2.bias",
      "reconstructor.reconstructor_blocks.4.norm1.weight",
      "reconstructor.reconstructor_blocks.4.norm1.bias",
      "reconstructor.reconstructor_blocks.4.attn.qkv.bias",
      "reconstructor.reconstructor_blocks.4.attn.proj.bias",
      "reconstructor.reconstructor_blocks.4.norm2.weight",
      "reconstructor.reconstructor_blocks.4.norm2.bias",
      "reconstructor.reconstructor_blocks.4.mlp.fc1.bias",
      "reconstructor.reconstructor_blocks.4.mlp.fc2.bias",
      "reconstructor.reconstructor_blocks.5.norm1.weight",
      "reconstructor.reconstructor_blocks.5.norm1.bias",
      "reconstructor.reconstructor_blocks.5.attn.qkv.bias",
      "reconstructor.reconstructor_blocks.5.attn.proj.bias",
      "reconstructor.reconstructor_blocks.5.norm2.weight",
      "reconstructor.reconstructor_blocks.5.norm2.bias",
      "reconstructor.reconstructor_blocks.5.mlp.fc1.bias",
      "reconstructor.reconstructor_blocks.5.mlp.fc2.bias",
      "reconstructor.reconstructor_blocks.6.norm1.weight",
      "reconstructor.reconstructor_blocks.6.norm1.bias",
      "reconstructor.reconstructor_blocks.6.attn.qkv.bias",
      "reconstructor.reconstructor_blocks.6.attn.proj.bias",
      "reconstructor.reconstructor_blocks.6.norm2.weight",
      "reconstructor.reconstructor_blocks.6.norm2.bias",
      "reconstructor.reconstructor_blocks.6.mlp.fc1.bias",
      "reconstructor.reconstructor_blocks.6.mlp.fc2.bias",
      "reconstructor.reconstructor_blocks.7.norm1.weight",
      "reconstructor.reconstructor_blocks.7.norm1.bias",
      "reconstructor.reconstructor_blocks.7.attn.qkv.bias",
      "reconstructor.reconstructor_blocks.7.attn.proj.bias",
      "reconstructor.reconstructor_blocks.7.norm2.weight",
      "reconstructor.reconstructor_blocks.7.norm2.bias",
      "reconstructor.reconstructor_blocks.7.mlp.fc1.bias",
      "reconstructor.reconstructor_blocks.7.mlp.fc2.bias",
      "reconstructor.reconstructor_norm.weight",
      "reconstructor.reconstructor_norm.bias",
      "reconstructor.reconstructor_proj.bias",
      "fc_norm.weight",
      "fc_norm.bias",
      "head.1.bias"
    ],
    "lr_scale": 1.0
  }
}
Optimizer config: {'lr': 0.0005, 'weight_decay': 0.0, 'eps': 1e-08}
Use step level LR scheduler!
Set warmup steps = 820
Set warmup steps = 0
Max WD = 0.0500000, Min WD = 0.0500000
criterion = LabelSmoothingCrossEntropy()
Auto resume checkpoint: 
Start training for 20 epochs
Warning: NaN or Inf found in input tensor.
Epoch: [0]  [  0/164]  eta: 0:34:52  lr: 0.000000  min_lr: 0.000000  loss: 3.2755 (3.2755)  class_acc: 0.1300 (0.1300)  loss_scale: 32768.0000 (32768.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: inf (inf)  time: 12.7605  data: 0.9792  max mem: 11240
Warning: NaN or Inf found in input tensor.
Warning: NaN or Inf found in input tensor.
Warning: NaN or Inf found in input tensor.
Epoch: [0]  [ 10/164]  eta: 0:04:29  lr: 0.000006  min_lr: 0.000006  loss: 2.9526 (2.8478)  class_acc: 0.1500 (0.1582)  loss_scale: 4096.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 129.2773 (inf)  time: 1.7518  data: 0.0891  max mem: 11436
Epoch: [0]  [ 20/164]  eta: 0:02:56  lr: 0.000012  min_lr: 0.000012  loss: 2.3027 (2.4439)  class_acc: 0.2500 (0.3190)  loss_scale: 4096.0000 (6241.5238)  weight_decay: 0.0500 (0.0500)  grad_norm: 76.0926 (inf)  time: 0.6526  data: 0.0001  max mem: 11436
Epoch: [0]  [ 30/164]  eta: 0:02:19  lr: 0.000018  min_lr: 0.000018  loss: 1.9727 (2.2687)  class_acc: 0.5950 (0.4135)  loss_scale: 4096.0000 (5549.4194)  weight_decay: 0.0500 (0.0500)  grad_norm: 42.6727 (inf)  time: 0.6539  data: 0.0001  max mem: 11436
Epoch: [0]  [ 40/164]  eta: 0:01:57  lr: 0.000024  min_lr: 0.000024  loss: 1.7489 (2.1414)  class_acc: 0.5650 (0.4332)  loss_scale: 4096.0000 (5194.9268)  weight_decay: 0.0500 (0.0500)  grad_norm: 31.1399 (inf)  time: 0.6523  data: 0.0002  max mem: 11436
Epoch: [0]  [ 50/164]  eta: 0:01:41  lr: 0.000031  min_lr: 0.000031  loss: 1.7260 (2.0691)  class_acc: 0.5350 (0.4603)  loss_scale: 4096.0000 (4979.4510)  weight_decay: 0.0500 (0.0500)  grad_norm: 27.3089 (inf)  time: 0.6527  data: 0.0002  max mem: 11436
Epoch: [0]  [ 60/164]  eta: 0:01:28  lr: 0.000037  min_lr: 0.000037  loss: 1.6977 (1.9973)  class_acc: 0.5850 (0.4775)  loss_scale: 4096.0000 (4834.6230)  weight_decay: 0.0500 (0.0500)  grad_norm: 26.8126 (inf)  time: 0.6547  data: 0.0002  max mem: 11436
Epoch: [0]  [ 70/164]  eta: 0:01:17  lr: 0.000043  min_lr: 0.000043  loss: 1.6564 (1.9518)  class_acc: 0.5750 (0.4903)  loss_scale: 4096.0000 (4730.5915)  weight_decay: 0.0500 (0.0500)  grad_norm: 21.8610 (inf)  time: 0.6544  data: 0.0004  max mem: 11436
Epoch: [0]  [ 80/164]  eta: 0:01:07  lr: 0.000049  min_lr: 0.000049  loss: 1.6975 (1.9191)  class_acc: 0.5550 (0.4999)  loss_scale: 4096.0000 (4652.2469)  weight_decay: 0.0500 (0.0500)  grad_norm: 23.5706 (inf)  time: 0.6549  data: 0.0003  max mem: 11436
Epoch: [0]  [ 90/164]  eta: 0:00:58  lr: 0.000055  min_lr: 0.000055  loss: 1.6778 (1.8853)  class_acc: 0.5750 (0.5093)  loss_scale: 4096.0000 (4591.1209)  weight_decay: 0.0500 (0.0500)  grad_norm: 28.4004 (inf)  time: 0.6568  data: 0.0003  max mem: 11436
Epoch: [0]  [100/164]  eta: 0:00:49  lr: 0.000061  min_lr: 0.000061  loss: 1.5574 (1.8497)  class_acc: 0.6200 (0.5200)  loss_scale: 4096.0000 (4542.0990)  weight_decay: 0.0500 (0.0500)  grad_norm: 27.9615 (inf)  time: 0.6578  data: 0.0003  max mem: 11436
Epoch: [0]  [110/164]  eta: 0:00:41  lr: 0.000067  min_lr: 0.000067  loss: 1.4115 (1.8089)  class_acc: 0.6250 (0.5313)  loss_scale: 4096.0000 (4501.9099)  weight_decay: 0.0500 (0.0500)  grad_norm: 27.9615 (inf)  time: 0.6569  data: 0.0002  max mem: 11436
Epoch: [0]  [120/164]  eta: 0:00:33  lr: 0.000073  min_lr: 0.000073  loss: 1.3764 (1.7748)  class_acc: 0.6550 (0.5403)  loss_scale: 4096.0000 (4468.3636)  weight_decay: 0.0500 (0.0500)  grad_norm: 26.4611 (inf)  time: 0.6566  data: 0.0002  max mem: 11436
Epoch: [0]  [130/164]  eta: 0:00:25  lr: 0.000079  min_lr: 0.000079  loss: 1.3196 (1.7363)  class_acc: 0.6550 (0.5511)  loss_scale: 4096.0000 (4439.9389)  weight_decay: 0.0500 (0.0500)  grad_norm: 22.9506 (inf)  time: 0.6572  data: 0.0002  max mem: 11436
Epoch: [0]  [140/164]  eta: 0:00:17  lr: 0.000085  min_lr: 0.000085  loss: 1.2411 (1.7012)  class_acc: 0.6700 (0.5604)  loss_scale: 4096.0000 (4415.5461)  weight_decay: 0.0500 (0.0500)  grad_norm: 22.9787 (inf)  time: 0.6553  data: 0.0002  max mem: 11436
Epoch: [0]  [150/164]  eta: 0:00:10  lr: 0.000092  min_lr: 0.000092  loss: 1.2297 (1.6701)  class_acc: 0.6700 (0.5674)  loss_scale: 4096.0000 (4394.3841)  weight_decay: 0.0500 (0.0500)  grad_norm: 23.1849 (inf)  time: 0.6559  data: 0.0002  max mem: 11436
Epoch: [0]  [160/164]  eta: 0:00:02  lr: 0.000098  min_lr: 0.000098  loss: 1.1827 (1.6431)  class_acc: 0.6700 (0.5736)  loss_scale: 4096.0000 (4375.8509)  weight_decay: 0.0500 (0.0500)  grad_norm: 21.9050 (inf)  time: 0.6580  data: 0.0001  max mem: 11436
Epoch: [0]  [163/164]  eta: 0:00:00  lr: 0.000100  min_lr: 0.000100  loss: 1.1753 (1.6346)  class_acc: 0.6850 (0.5760)  loss_scale: 4096.0000 (4370.7317)  weight_decay: 0.0500 (0.0500)  grad_norm: 21.7274 (inf)  time: 0.6578  data: 0.0001  max mem: 11436
Epoch: [0] Total time: 0:01:59 (0.7298 s / it)
Averaged stats: lr: 0.000100  min_lr: 0.000100  loss: 1.1753 (1.6403)  class_acc: 0.6850 (0.5755)  loss_scale: 4096.0000 (4370.7317)  weight_decay: 0.0500 (0.0500)  grad_norm: 21.7274 (inf)
Val:  [ 0/30]  eta: 0:01:10  loss: 1.4274 (1.4274)  n: 300.0000 (300.0000)  accuracy: 0.5667 (0.5667)  balanced_accuracy: 0.2911 (0.2911)  cohen_kappa: 0.3494 (0.3494)  f1_weighted: 0.5444 (0.5444)  time: 2.3432  data: 1.8416  max mem: 11436
Val:  [10/30]  eta: 0:00:09  loss: 1.4839 (1.4947)  n: 300.0000 (300.0000)  accuracy: 0.5467 (0.5542)  balanced_accuracy: 0.2841 (0.2852)  cohen_kappa: 0.3332 (0.3369)  f1_weighted: 0.5081 (0.5151)  time: 0.4546  data: 0.1680  max mem: 11436
Val:  [20/30]  eta: 0:00:03  loss: 1.5530 (1.5294)  n: 300.0000 (300.0000)  accuracy: 0.5433 (0.5452)  balanced_accuracy: 0.2841 (0.2888)  cohen_kappa: 0.3254 (0.3265)  f1_weighted: 0.5025 (0.5058)  time: 0.2637  data: 0.0004  max mem: 11436
Val:  [29/30]  eta: 0:00:00  loss: 1.5352 (1.5294)  n: 300.0000 (299.4333)  accuracy: 0.5400 (0.5439)  balanced_accuracy: 0.2821 (0.2867)  cohen_kappa: 0.3141 (0.3245)  f1_weighted: 0.4918 (0.5037)  time: 0.2659  data: 0.0001  max mem: 11436
Val: Total time: 0:00:10 (0.3385 s / it)
* loss 1.517
{'accuracy': 0.5439162863186018, 'balanced_accuracy': 0.2848183150059599, 'cohen_kappa': 0.3248342041017208, 'f1_weighted': 0.5040403556764513, 'loss': 1.516844234863917, 'precision': 0.3996835403602835, 'sensitivity': 0.2848183150059599, 'f1': 0.24811804693919362, 'specificity': 0.8927324960848511}
Accuracy of the network on the 17965 val EEG: 0.54%
Test:  [ 0/48]  eta: 0:01:06  loss: 1.5073 (1.5073)  n: 300.0000 (300.0000)  accuracy: 0.5633 (0.5633)  balanced_accuracy: 0.2719 (0.2719)  cohen_kappa: 0.2554 (0.2554)  f1_weighted: 0.5705 (0.5705)  time: 1.3915  data: 1.1345  max mem: 11436
Test:  [10/48]  eta: 0:00:13  loss: 1.5250 (1.5338)  n: 300.0000 (300.0000)  accuracy: 0.5633 (0.5567)  balanced_accuracy: 0.2679 (0.2693)  cohen_kappa: 0.2527 (0.2503)  f1_weighted: 0.5705 (0.5656)  time: 0.3677  data: 0.1033  max mem: 11436
Test:  [20/48]  eta: 0:00:08  loss: 1.5250 (1.5285)  n: 300.0000 (300.0000)  accuracy: 0.5533 (0.5540)  balanced_accuracy: 0.2697 (0.2746)  cohen_kappa: 0.2501 (0.2526)  f1_weighted: 0.5607 (0.5634)  time: 0.2623  data: 0.0002  max mem: 11436
Test:  [30/48]  eta: 0:00:05  loss: 1.5530 (1.5392)  n: 300.0000 (300.0000)  accuracy: 0.5433 (0.5503)  balanced_accuracy: 0.2697 (0.2733)  cohen_kappa: 0.2460 (0.2488)  f1_weighted: 0.5519 (0.5573)  time: 0.2597  data: 0.0002  max mem: 11436
Test:  [40/48]  eta: 0:00:02  loss: 1.5749 (1.5443)  n: 300.0000 (300.0000)  accuracy: 0.5367 (0.5487)  balanced_accuracy: 0.2682 (0.2721)  cohen_kappa: 0.2376 (0.2471)  f1_weighted: 0.5455 (0.5559)  time: 0.2598  data: 0.0002  max mem: 11436
Test:  [47/48]  eta: 0:00:00  loss: 1.5140 (1.5466)  n: 300.0000 (294.8542)  accuracy: 0.5433 (0.5512)  balanced_accuracy: 0.2725 (0.2727)  cohen_kappa: 0.2413 (0.2486)  f1_weighted: 0.5519 (0.5582)  time: 0.2512  data: 0.0001  max mem: 11436
Test: Total time: 0:00:13 (0.2827 s / it)
* loss 1.539
{'accuracy': 0.5511905603052356, 'balanced_accuracy': 0.2699217860805872, 'cohen_kappa': 0.2491370073082222, 'f1_weighted': 0.5580801040717349, 'loss': 1.5388155778249104, 'precision': 0.2417619603366302, 'sensitivity': 0.2699217860805872, 'f1': 0.2043470050360238, 'specificity': 0.8926770369202986}
Accuracy of the network on the 28305 test EEG: 0.55%
Max accuracy val: 0.54%, max accuracy test: 0.55%
Epoch: [1]  [  0/164]  eta: 0:03:53  lr: 0.000100  min_lr: 0.000100  loss: 1.2491 (1.2491)  class_acc: 0.6950 (0.6950)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 26.0134 (26.0134)  time: 1.4242  data: 0.8285  max mem: 11436
Epoch: [1]  [ 10/164]  eta: 0:01:52  lr: 0.000106  min_lr: 0.000106  loss: 1.1285 (1.1328)  class_acc: 0.6850 (0.6914)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 18.7046 (20.1149)  time: 0.7281  data: 0.0754  max mem: 11436
Epoch: [1]  [ 20/164]  eta: 0:01:40  lr: 0.000112  min_lr: 0.000112  loss: 1.0943 (1.1065)  class_acc: 0.7000 (0.7043)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 17.6486 (18.6302)  time: 0.6583  data: 0.0001  max mem: 11436
Epoch: [1]  [ 30/164]  eta: 0:01:31  lr: 0.000118  min_lr: 0.000118  loss: 1.0800 (1.0971)  class_acc: 0.7100 (0.7068)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 17.1004 (20.2465)  time: 0.6584  data: 0.0002  max mem: 11436
Epoch: [1]  [ 40/164]  eta: 0:01:23  lr: 0.000125  min_lr: 0.000125  loss: 1.0734 (1.0869)  class_acc: 0.7250 (0.7099)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 22.8104 (22.4158)  time: 0.6574  data: 0.0002  max mem: 11436
Epoch: [1]  [ 50/164]  eta: 0:01:16  lr: 0.000131  min_lr: 0.000131  loss: 1.0500 (1.0759)  class_acc: 0.7250 (0.7145)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 18.7498 (21.5925)  time: 0.6582  data: 0.0001  max mem: 11436
Epoch: [1]  [ 60/164]  eta: 0:01:09  lr: 0.000137  min_lr: 0.000137  loss: 1.0043 (1.0694)  class_acc: 0.7400 (0.7162)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 17.8203 (21.3562)  time: 0.6597  data: 0.0001  max mem: 11436
Epoch: [1]  [ 70/164]  eta: 0:01:02  lr: 0.000143  min_lr: 0.000143  loss: 0.9801 (1.0560)  class_acc: 0.7350 (0.7206)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 19.3506 (21.1855)  time: 0.6586  data: 0.0001  max mem: 11436
Epoch: [1]  [ 80/164]  eta: 0:00:56  lr: 0.000149  min_lr: 0.000149  loss: 0.9808 (1.0514)  class_acc: 0.7350 (0.7228)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 23.1136 (21.8678)  time: 0.6585  data: 0.0001  max mem: 11436
Epoch: [1]  [ 90/164]  eta: 0:00:49  lr: 0.000155  min_lr: 0.000155  loss: 1.0148 (1.0431)  class_acc: 0.7350 (0.7263)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 25.2913 (21.9942)  time: 0.6591  data: 0.0001  max mem: 11436
Epoch: [1]  [100/164]  eta: 0:00:42  lr: 0.000161  min_lr: 0.000161  loss: 0.9603 (1.0363)  class_acc: 0.7700 (0.7297)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 19.8521 (21.6662)  time: 0.6592  data: 0.0001  max mem: 11436
Epoch: [1]  [110/164]  eta: 0:00:35  lr: 0.000167  min_lr: 0.000167  loss: 0.9674 (1.0321)  class_acc: 0.7450 (0.7310)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 22.0291 (22.3710)  time: 0.6580  data: 0.0002  max mem: 11436
Epoch: [1]  [120/164]  eta: 0:00:29  lr: 0.000173  min_lr: 0.000173  loss: 0.9644 (1.0255)  class_acc: 0.7500 (0.7335)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 27.0512 (22.5515)  time: 0.6584  data: 0.0002  max mem: 11436
Epoch: [1]  [130/164]  eta: 0:00:22  lr: 0.000179  min_lr: 0.000179  loss: 0.9413 (1.0203)  class_acc: 0.7550 (0.7352)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 22.3703 (22.9862)  time: 0.6597  data: 0.0001  max mem: 11436
Epoch: [1]  [140/164]  eta: 0:00:15  lr: 0.000186  min_lr: 0.000186  loss: 0.9295 (1.0147)  class_acc: 0.7650 (0.7376)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 24.5734 (23.1852)  time: 0.6590  data: 0.0001  max mem: 11436
Epoch: [1]  [150/164]  eta: 0:00:09  lr: 0.000192  min_lr: 0.000192  loss: 0.9026 (1.0070)  class_acc: 0.7650 (0.7402)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 22.3116 (23.0506)  time: 0.6577  data: 0.0001  max mem: 11436
Epoch: [1]  [160/164]  eta: 0:00:02  lr: 0.000198  min_lr: 0.000198  loss: 0.9165 (1.0029)  class_acc: 0.7700 (0.7418)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 19.1485 (22.8700)  time: 0.6580  data: 0.0001  max mem: 11436
Epoch: [1]  [163/164]  eta: 0:00:00  lr: 0.000200  min_lr: 0.000200  loss: 0.9210 (1.0016)  class_acc: 0.7600 (0.7421)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 19.1485 (22.8492)  time: 0.6586  data: 0.0001  max mem: 11436
Epoch: [1] Total time: 0:01:48 (0.6642 s / it)
Averaged stats: lr: 0.000200  min_lr: 0.000200  loss: 0.9210 (1.0070)  class_acc: 0.7600 (0.7421)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 19.1485 (22.8492)
Val:  [ 0/30]  eta: 0:00:35  loss: 0.9288 (0.9288)  n: 300.0000 (300.0000)  accuracy: 0.6400 (0.6400)  balanced_accuracy: 0.3390 (0.3390)  cohen_kappa: 0.3957 (0.3957)  f1_weighted: 0.6117 (0.6117)  time: 1.1958  data: 0.9427  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [10/30]  eta: 0:00:06  loss: 1.0181 (1.0274)  n: 300.0000 (300.0000)  accuracy: 0.6233 (0.6191)  balanced_accuracy: 0.3286 (0.3315)  cohen_kappa: 0.3746 (0.3778)  f1_weighted: 0.5894 (0.5854)  time: 0.3466  data: 0.0859  max mem: 11436
Val:  [20/30]  eta: 0:00:03  loss: 1.0498 (1.0470)  n: 300.0000 (300.0000)  accuracy: 0.6167 (0.6173)  balanced_accuracy: 0.3313 (0.3407)  cohen_kappa: 0.3684 (0.3755)  f1_weighted: 0.5844 (0.5813)  time: 0.2623  data: 0.0002  max mem: 11436
Val:  [29/30]  eta: 0:00:00  loss: 1.0606 (1.0461)  n: 300.0000 (299.4333)  accuracy: 0.6133 (0.6168)  balanced_accuracy: 0.3386 (0.3444)  cohen_kappa: 0.3587 (0.3756)  f1_weighted: 0.5748 (0.5816)  time: 0.2617  data: 0.0001  max mem: 11436
Val: Total time: 0:00:08 (0.2971 s / it)
* loss 1.037
{'accuracy': 0.6168317933875097, 'balanced_accuracy': 0.34328812211856835, 'cohen_kappa': 0.37620128390481566, 'f1_weighted': 0.5823271360054431, 'loss': 1.036903444925944, 'precision': 0.4961821892018163, 'sensitivity': 0.34328812211856835, 'f1': 0.3580384310535885, 'specificity': 0.8940064967697534}
Accuracy of the network on the 17965 val EEG: 0.62%
Test:  [ 0/48]  eta: 0:01:05  loss: 0.9090 (0.9090)  n: 300.0000 (300.0000)  accuracy: 0.6733 (0.6733)  balanced_accuracy: 0.3147 (0.3147)  cohen_kappa: 0.3689 (0.3689)  f1_weighted: 0.6617 (0.6617)  time: 1.3550  data: 1.0958  max mem: 11436
Test:  [10/48]  eta: 0:00:13  loss: 0.9062 (0.9034)  n: 300.0000 (300.0000)  accuracy: 0.6767 (0.6748)  balanced_accuracy: 0.3052 (0.3061)  cohen_kappa: 0.3775 (0.3691)  f1_weighted: 0.6621 (0.6649)  time: 0.3608  data: 0.0998  max mem: 11436
Test:  [20/48]  eta: 0:00:08  loss: 0.8824 (0.9019)  n: 300.0000 (300.0000)  accuracy: 0.6700 (0.6717)  balanced_accuracy: 0.2966 (0.3055)  cohen_kappa: 0.3560 (0.3643)  f1_weighted: 0.6589 (0.6604)  time: 0.2626  data: 0.0002  max mem: 11436
Test:  [30/48]  eta: 0:00:05  loss: 0.9136 (0.9174)  n: 300.0000 (300.0000)  accuracy: 0.6567 (0.6655)  balanced_accuracy: 0.2940 (0.3032)  cohen_kappa: 0.3363 (0.3542)  f1_weighted: 0.6437 (0.6516)  time: 0.2642  data: 0.0002  max mem: 11436
Test:  [40/48]  eta: 0:00:02  loss: 0.9413 (0.9204)  n: 300.0000 (300.0000)  accuracy: 0.6467 (0.6623)  balanced_accuracy: 0.2912 (0.2998)  cohen_kappa: 0.3283 (0.3492)  f1_weighted: 0.6341 (0.6482)  time: 0.2648  data: 0.0002  max mem: 11436
Test:  [47/48]  eta: 0:00:00  loss: 0.9100 (0.9213)  n: 300.0000 (294.8542)  accuracy: 0.6533 (0.6643)  balanced_accuracy: 0.2912 (0.2992)  cohen_kappa: 0.3290 (0.3506)  f1_weighted: 0.6436 (0.6497)  time: 0.2535  data: 0.0001  max mem: 11436
Test: Total time: 0:00:13 (0.2839 s / it)
* loss 0.915
{'accuracy': 0.6643114534021055, 'balanced_accuracy': 0.29652075486286184, 'cohen_kappa': 0.35125729211888823, 'f1_weighted': 0.6497624692282722, 'loss': 0.9151911971469721, 'precision': 0.2888030437308038, 'sensitivity': 0.29652075486286184, 'f1': 0.25786117677182196, 'specificity': 0.9061173622590655}
Accuracy of the network on the 28305 test EEG: 0.66%
Max accuracy val: 0.62%, max accuracy test: 0.66%
Epoch: [2]  [  0/164]  eta: 0:04:01  lr: 0.000200  min_lr: 0.000200  loss: 0.8400 (0.8400)  class_acc: 0.7950 (0.7950)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 19.6891 (19.6891)  time: 1.4755  data: 0.8837  max mem: 11436
Epoch: [2]  [ 10/164]  eta: 0:01:52  lr: 0.000206  min_lr: 0.000206  loss: 0.8965 (0.9051)  class_acc: 0.7850 (0.7827)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 19.0242 (18.2043)  time: 0.7299  data: 0.0805  max mem: 11436
Epoch: [2]  [ 20/164]  eta: 0:01:40  lr: 0.000212  min_lr: 0.000212  loss: 0.9106 (0.9149)  class_acc: 0.7750 (0.7764)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 18.6865 (19.0989)  time: 0.6570  data: 0.0001  max mem: 11436
Epoch: [2]  [ 30/164]  eta: 0:01:31  lr: 0.000219  min_lr: 0.000219  loss: 0.9036 (0.9022)  class_acc: 0.7700 (0.7785)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 18.2067 (19.2546)  time: 0.6586  data: 0.0003  max mem: 11436
Epoch: [2]  [ 40/164]  eta: 0:01:24  lr: 0.000225  min_lr: 0.000225  loss: 0.8949 (0.9022)  class_acc: 0.7800 (0.7799)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 16.6574 (19.0949)  time: 0.6590  data: 0.0003  max mem: 11436
Epoch: [2]  [ 50/164]  eta: 0:01:16  lr: 0.000231  min_lr: 0.000231  loss: 0.8871 (0.9000)  class_acc: 0.7800 (0.7817)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 17.5589 (19.6735)  time: 0.6581  data: 0.0006  max mem: 11436
Epoch: [2]  [ 60/164]  eta: 0:01:09  lr: 0.000237  min_lr: 0.000237  loss: 0.9022 (0.9070)  class_acc: 0.7700 (0.7765)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 20.1401 (21.0667)  time: 0.6579  data: 0.0005  max mem: 11436
Epoch: [2]  [ 70/164]  eta: 0:01:02  lr: 0.000243  min_lr: 0.000243  loss: 0.9175 (0.9077)  class_acc: 0.7700 (0.7782)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 19.7549 (20.7879)  time: 0.6591  data: 0.0002  max mem: 11436
Epoch: [2]  [ 80/164]  eta: 0:00:56  lr: 0.000249  min_lr: 0.000249  loss: 0.8610 (0.9008)  class_acc: 0.7950 (0.7814)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 14.6428 (20.1943)  time: 0.6578  data: 0.0002  max mem: 11436
Epoch: [2]  [ 90/164]  eta: 0:00:49  lr: 0.000255  min_lr: 0.000255  loss: 0.8245 (0.8964)  class_acc: 0.8100 (0.7848)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 14.7640 (20.1130)  time: 0.6574  data: 0.0001  max mem: 11436
Epoch: [2]  [100/164]  eta: 0:00:42  lr: 0.000261  min_lr: 0.000261  loss: 0.8834 (0.9008)  class_acc: 0.7950 (0.7837)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 22.7965 (21.4223)  time: 0.6586  data: 0.0001  max mem: 11436
Epoch: [2]  [110/164]  eta: 0:00:35  lr: 0.000267  min_lr: 0.000267  loss: 0.8832 (0.8991)  class_acc: 0.7950 (0.7855)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 20.6587 (21.3910)  time: 0.6592  data: 0.0001  max mem: 11436
Epoch: [2]  [120/164]  eta: 0:00:29  lr: 0.000274  min_lr: 0.000274  loss: 0.8726 (0.8952)  class_acc: 0.7950 (0.7874)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 17.3054 (21.1470)  time: 0.6417  data: 0.0001  max mem: 11436
Epoch: [2]  [130/164]  eta: 0:00:22  lr: 0.000280  min_lr: 0.000280  loss: 0.8136 (0.8890)  class_acc: 0.8200 (0.7897)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 15.5664 (20.7718)  time: 0.6344  data: 0.0001  max mem: 11436
Epoch: [2]  [140/164]  eta: 0:00:15  lr: 0.000286  min_lr: 0.000286  loss: 0.8136 (0.8841)  class_acc: 0.8250 (0.7923)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 14.0421 (20.3728)  time: 0.6519  data: 0.0001  max mem: 11436
Epoch: [2]  [150/164]  eta: 0:00:09  lr: 0.000292  min_lr: 0.000292  loss: 0.8118 (0.8796)  class_acc: 0.8250 (0.7948)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 13.3156 (20.0656)  time: 0.6584  data: 0.0001  max mem: 11436
Epoch: [2]  [160/164]  eta: 0:00:02  lr: 0.000298  min_lr: 0.000298  loss: 0.8118 (0.8757)  class_acc: 0.8250 (0.7970)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 17.9964 (20.2519)  time: 0.6562  data: 0.0001  max mem: 11436
Epoch: [2]  [163/164]  eta: 0:00:00  lr: 0.000300  min_lr: 0.000300  loss: 0.8179 (0.8748)  class_acc: 0.8150 (0.7972)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 17.9964 (20.1474)  time: 0.6564  data: 0.0001  max mem: 11436
Epoch: [2] Total time: 0:01:48 (0.6610 s / it)
Averaged stats: lr: 0.000300  min_lr: 0.000300  loss: 0.8179 (0.8721)  class_acc: 0.8150 (0.7979)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 17.9964 (20.1474)
Val:  [ 0/30]  eta: 0:00:40  loss: 0.9763 (0.9763)  n: 300.0000 (300.0000)  accuracy: 0.6500 (0.6500)  balanced_accuracy: 0.4010 (0.4010)  cohen_kappa: 0.4179 (0.4179)  f1_weighted: 0.6180 (0.6180)  time: 1.3624  data: 1.1027  max mem: 11436
Val:  [10/30]  eta: 0:00:07  loss: 1.0890 (1.0819)  n: 300.0000 (300.0000)  accuracy: 0.6533 (0.6485)  balanced_accuracy: 0.4070 (0.4130)  cohen_kappa: 0.4367 (0.4367)  f1_weighted: 0.6180 (0.6144)  time: 0.3618  data: 0.1004  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [20/30]  eta: 0:00:03  loss: 1.0976 (1.1005)  n: 300.0000 (300.0000)  accuracy: 0.6400 (0.6406)  balanced_accuracy: 0.4161 (0.4167)  cohen_kappa: 0.4238 (0.4256)  f1_weighted: 0.6083 (0.6064)  time: 0.2622  data: 0.0001  max mem: 11436
Val:  [29/30]  eta: 0:00:00  loss: 1.0986 (1.1012)  n: 300.0000 (299.4333)  accuracy: 0.6300 (0.6375)  balanced_accuracy: 0.4071 (0.4153)  cohen_kappa: 0.4134 (0.4210)  f1_weighted: 0.5976 (0.6035)  time: 0.2612  data: 0.0001  max mem: 11436
Val: Total time: 0:00:09 (0.3015 s / it)
* loss 1.090
{'accuracy': 0.6375375709673828, 'balanced_accuracy': 0.41534453338591276, 'cohen_kappa': 0.42182847635272935, 'f1_weighted': 0.6037405224469726, 'loss': 1.0902524580558142, 'precision': 0.46601011886918187, 'sensitivity': 0.41534453338591276, 'f1': 0.37013719317947524, 'specificity': 0.9027828358468538}
Accuracy of the network on the 17965 val EEG: 0.64%
Test:  [ 0/48]  eta: 0:01:00  loss: 0.8289 (0.8289)  n: 300.0000 (300.0000)  accuracy: 0.7433 (0.7433)  balanced_accuracy: 0.3674 (0.3674)  cohen_kappa: 0.4739 (0.4739)  f1_weighted: 0.7348 (0.7348)  time: 1.2696  data: 1.0182  max mem: 11436
Test:  [10/48]  eta: 0:00:13  loss: 0.8031 (0.7954)  n: 300.0000 (300.0000)  accuracy: 0.7433 (0.7427)  balanced_accuracy: 0.3905 (0.3822)  cohen_kappa: 0.4774 (0.4843)  f1_weighted: 0.7387 (0.7408)  time: 0.3525  data: 0.0927  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [20/48]  eta: 0:00:08  loss: 0.7895 (0.7998)  n: 300.0000 (300.0000)  accuracy: 0.7433 (0.7443)  balanced_accuracy: 0.3905 (0.3886)  cohen_kappa: 0.4786 (0.4896)  f1_weighted: 0.7385 (0.7414)  time: 0.2617  data: 0.0002  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [30/48]  eta: 0:00:05  loss: 0.8080 (0.8147)  n: 300.0000 (300.0000)  accuracy: 0.7367 (0.7390)  balanced_accuracy: 0.3877 (0.3884)  cohen_kappa: 0.4756 (0.4813)  f1_weighted: 0.7312 (0.7344)  time: 0.2623  data: 0.0002  max mem: 11436
Test:  [40/48]  eta: 0:00:02  loss: 0.8389 (0.8184)  n: 300.0000 (300.0000)  accuracy: 0.7300 (0.7369)  balanced_accuracy: 0.3861 (0.3847)  cohen_kappa: 0.4666 (0.4767)  f1_weighted: 0.7241 (0.7318)  time: 0.2618  data: 0.0002  max mem: 11436
Test:  [47/48]  eta: 0:00:00  loss: 0.8219 (0.8194)  n: 300.0000 (294.8542)  accuracy: 0.7300 (0.7384)  balanced_accuracy: 0.3847 (0.3846)  cohen_kappa: 0.4700 (0.4774)  f1_weighted: 0.7241 (0.7329)  time: 0.2510  data: 0.0001  max mem: 11436
Test: Total time: 0:00:13 (0.2807 s / it)
* loss 0.811
{'accuracy': 0.7384300148378435, 'balanced_accuracy': 0.3834991757069432, 'cohen_kappa': 0.47803673838151606, 'f1_weighted': 0.7329312350108325, 'loss': 0.8110922997196516, 'precision': 0.48143863072364085, 'sensitivity': 0.3834991757069432, 'f1': 0.3838606852817967, 'specificity': 0.927313944973382}
Accuracy of the network on the 28305 test EEG: 0.74%
Max accuracy val: 0.64%, max accuracy test: 0.74%
Epoch: [3]  [  0/164]  eta: 0:04:13  lr: 0.000300  min_lr: 0.000300  loss: 0.8792 (0.8792)  class_acc: 0.7750 (0.7750)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 17.5541 (17.5541)  time: 1.5451  data: 0.9522  max mem: 11436
Epoch: [3]  [ 10/164]  eta: 0:01:53  lr: 0.000306  min_lr: 0.000306  loss: 0.7936 (0.7992)  class_acc: 0.8400 (0.8264)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 18.3344 (19.2123)  time: 0.7377  data: 0.0869  max mem: 11436
Epoch: [3]  [ 20/164]  eta: 0:01:40  lr: 0.000313  min_lr: 0.000313  loss: 0.7936 (0.7970)  class_acc: 0.8200 (0.8262)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 15.8655 (16.9747)  time: 0.6575  data: 0.0003  max mem: 11436
Epoch: [3]  [ 30/164]  eta: 0:01:31  lr: 0.000319  min_lr: 0.000319  loss: 0.7889 (0.7933)  class_acc: 0.8200 (0.8266)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 13.7549 (16.5659)  time: 0.6571  data: 0.0002  max mem: 11436
Epoch: [3]  [ 40/164]  eta: 0:01:24  lr: 0.000325  min_lr: 0.000325  loss: 0.7889 (0.7942)  class_acc: 0.8300 (0.8279)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 14.6910 (16.4934)  time: 0.6575  data: 0.0002  max mem: 11436
Epoch: [3]  [ 50/164]  eta: 0:01:16  lr: 0.000331  min_lr: 0.000331  loss: 0.7931 (0.7939)  class_acc: 0.8300 (0.8281)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 14.6051 (16.7632)  time: 0.6588  data: 0.0001  max mem: 11436
Epoch: [3]  [ 60/164]  eta: 0:01:09  lr: 0.000337  min_lr: 0.000337  loss: 0.8008 (0.7969)  class_acc: 0.8300 (0.8293)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 16.1463 (17.7654)  time: 0.6578  data: 0.0002  max mem: 11436
Epoch: [3]  [ 70/164]  eta: 0:01:03  lr: 0.000343  min_lr: 0.000343  loss: 0.7923 (0.7982)  class_acc: 0.8350 (0.8290)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 19.0517 (18.2215)  time: 0.6576  data: 0.0002  max mem: 11436
Epoch: [3]  [ 80/164]  eta: 0:00:56  lr: 0.000349  min_lr: 0.000349  loss: 0.7779 (0.7937)  class_acc: 0.8400 (0.8329)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 16.8205 (18.3993)  time: 0.6582  data: 0.0004  max mem: 11436
Epoch: [3]  [ 90/164]  eta: 0:00:49  lr: 0.000355  min_lr: 0.000355  loss: 0.7732 (0.7951)  class_acc: 0.8450 (0.8323)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 17.5829 (18.8221)  time: 0.6579  data: 0.0005  max mem: 11436
Epoch: [3]  [100/164]  eta: 0:00:42  lr: 0.000361  min_lr: 0.000361  loss: 0.8218 (0.8000)  class_acc: 0.8200 (0.8319)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 24.1479 (19.4827)  time: 0.6571  data: 0.0007  max mem: 11436
Epoch: [3]  [110/164]  eta: 0:00:35  lr: 0.000368  min_lr: 0.000368  loss: 0.8050 (0.7973)  class_acc: 0.8350 (0.8334)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 19.1460 (19.3283)  time: 0.6574  data: 0.0005  max mem: 11436
Epoch: [3]  [120/164]  eta: 0:00:29  lr: 0.000374  min_lr: 0.000374  loss: 0.7586 (0.7935)  class_acc: 0.8450 (0.8355)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 15.7984 (19.2412)  time: 0.6587  data: 0.0002  max mem: 11436
Epoch: [3]  [130/164]  eta: 0:00:22  lr: 0.000380  min_lr: 0.000380  loss: 0.7654 (0.7939)  class_acc: 0.8450 (0.8351)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 20.6039 (19.8565)  time: 0.6574  data: 0.0002  max mem: 11436
Epoch: [3]  [140/164]  eta: 0:00:15  lr: 0.000386  min_lr: 0.000386  loss: 0.7787 (0.7949)  class_acc: 0.8350 (0.8355)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 23.5572 (19.8837)  time: 0.6569  data: 0.0002  max mem: 11436
Epoch: [3]  [150/164]  eta: 0:00:09  lr: 0.000392  min_lr: 0.000392  loss: 0.8022 (0.7964)  class_acc: 0.8350 (0.8357)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 19.8735 (20.0786)  time: 0.6579  data: 0.0002  max mem: 11436
Epoch: [3]  [160/164]  eta: 0:00:02  lr: 0.000398  min_lr: 0.000398  loss: 0.7879 (0.7934)  class_acc: 0.8500 (0.8377)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 18.0029 (19.8324)  time: 0.6584  data: 0.0001  max mem: 11436
Epoch: [3]  [163/164]  eta: 0:00:00  lr: 0.000400  min_lr: 0.000400  loss: 0.7576 (0.7920)  class_acc: 0.8600 (0.8385)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 16.4709 (19.6807)  time: 0.6572  data: 0.0001  max mem: 11436
Epoch: [3] Total time: 0:01:48 (0.6640 s / it)
Averaged stats: lr: 0.000400  min_lr: 0.000400  loss: 0.7576 (0.7912)  class_acc: 0.8600 (0.8404)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 16.4709 (19.6807)
Val:  [ 0/30]  eta: 0:00:44  loss: 1.0776 (1.0776)  n: 300.0000 (300.0000)  accuracy: 0.6467 (0.6467)  balanced_accuracy: 0.3467 (0.3467)  cohen_kappa: 0.3620 (0.3620)  f1_weighted: 0.5919 (0.5919)  time: 1.4785  data: 1.2219  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [10/30]  eta: 0:00:07  loss: 1.1873 (1.1819)  n: 300.0000 (300.0000)  accuracy: 0.6000 (0.5991)  balanced_accuracy: 0.3170 (0.3133)  cohen_kappa: 0.3270 (0.3085)  f1_weighted: 0.5453 (0.5364)  time: 0.3714  data: 0.1113  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [20/30]  eta: 0:00:03  loss: 1.1886 (1.1907)  n: 300.0000 (300.0000)  accuracy: 0.5933 (0.5973)  balanced_accuracy: 0.3170 (0.3190)  cohen_kappa: 0.2995 (0.3034)  f1_weighted: 0.5305 (0.5349)  time: 0.2608  data: 0.0001  max mem: 11436
Val:  [29/30]  eta: 0:00:00  loss: 1.2166 (1.1875)  n: 300.0000 (299.4333)  accuracy: 0.5933 (0.5963)  balanced_accuracy: 0.3186 (0.3258)  cohen_kappa: 0.2995 (0.3015)  f1_weighted: 0.5288 (0.5329)  time: 0.2600  data: 0.0001  max mem: 11436
Val: Total time: 0:00:09 (0.3041 s / it)
* loss 1.172
{'accuracy': 0.5963486585773127, 'balanced_accuracy': 0.32764090017353925, 'cohen_kappa': 0.3025532113161745, 'f1_weighted': 0.5333273723278945, 'loss': 1.1722553412119547, 'precision': 0.4424585847027463, 'sensitivity': 0.32764090017353925, 'f1': 0.3225780155907167, 'specificity': 0.8795215193982795}
Accuracy of the network on the 17965 val EEG: 0.60%
Test:  [ 0/48]  eta: 0:01:13  loss: 0.7063 (0.7063)  n: 300.0000 (300.0000)  accuracy: 0.7800 (0.7800)  balanced_accuracy: 0.3441 (0.3441)  cohen_kappa: 0.4862 (0.4862)  f1_weighted: 0.7493 (0.7493)  time: 1.5355  data: 1.2818  max mem: 11436
Test:  [10/48]  eta: 0:00:14  loss: 0.6764 (0.6594)  n: 300.0000 (300.0000)  accuracy: 0.7900 (0.7933)  balanced_accuracy: 0.4270 (0.4395)  cohen_kappa: 0.5364 (0.5369)  f1_weighted: 0.7679 (0.7698)  time: 0.3772  data: 0.1167  max mem: 11436
Test:  [20/48]  eta: 0:00:09  loss: 0.6616 (0.6699)  n: 300.0000 (300.0000)  accuracy: 0.7900 (0.7906)  balanced_accuracy: 0.4270 (0.4343)  cohen_kappa: 0.5364 (0.5326)  f1_weighted: 0.7679 (0.7657)  time: 0.2621  data: 0.0002  max mem: 11436
Test:  [30/48]  eta: 0:00:05  loss: 0.6925 (0.6863)  n: 300.0000 (300.0000)  accuracy: 0.7767 (0.7852)  balanced_accuracy: 0.4468 (0.4437)  cohen_kappa: 0.5106 (0.5244)  f1_weighted: 0.7447 (0.7585)  time: 0.2634  data: 0.0002  max mem: 11436
Test:  [40/48]  eta: 0:00:02  loss: 0.7334 (0.6917)  n: 300.0000 (300.0000)  accuracy: 0.7767 (0.7850)  balanced_accuracy: 0.4459 (0.4455)  cohen_kappa: 0.5033 (0.5238)  f1_weighted: 0.7447 (0.7574)  time: 0.2623  data: 0.0002  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [47/48]  eta: 0:00:00  loss: 0.7098 (0.6910)  n: 300.0000 (294.8542)  accuracy: 0.7867 (0.7862)  balanced_accuracy: 0.4401 (0.4449)  cohen_kappa: 0.5157 (0.5245)  f1_weighted: 0.7568 (0.7589)  time: 0.2508  data: 0.0002  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test: Total time: 0:00:13 (0.2863 s / it)
* loss 0.682
{'accuracy': 0.7861937398431428, 'balanced_accuracy': 0.4447957914810563, 'cohen_kappa': 0.5249650583985366, 'f1_weighted': 0.759429518947511, 'loss': 0.6817657283196846, 'precision': 0.5115928861035298, 'sensitivity': 0.4447957914810563, 'f1': 0.4642736398201071, 'specificity': 0.9239918393962548}
Accuracy of the network on the 28305 test EEG: 0.79%
Max accuracy val: 0.64%, max accuracy test: 0.74%
Epoch: [4]  [  0/164]  eta: 0:04:43  lr: 0.000400  min_lr: 0.000400  loss: 0.6618 (0.6618)  class_acc: 0.8800 (0.8800)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.2591 (10.2591)  time: 1.7299  data: 1.0737  max mem: 11436
Epoch: [4]  [ 10/164]  eta: 0:01:56  lr: 0.000407  min_lr: 0.000407  loss: 0.7315 (0.7270)  class_acc: 0.8650 (0.8714)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 15.1657 (15.1741)  time: 0.7551  data: 0.0977  max mem: 11436
Epoch: [4]  [ 20/164]  eta: 0:01:42  lr: 0.000413  min_lr: 0.000413  loss: 0.7315 (0.7271)  class_acc: 0.8650 (0.8712)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 15.4643 (16.0967)  time: 0.6575  data: 0.0001  max mem: 11436
Epoch: [4]  [ 30/164]  eta: 0:01:32  lr: 0.000419  min_lr: 0.000419  loss: 0.7449 (0.7393)  class_acc: 0.8650 (0.8671)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 18.4225 (17.3353)  time: 0.6580  data: 0.0001  max mem: 11436
Epoch: [4]  [ 40/164]  eta: 0:01:24  lr: 0.000425  min_lr: 0.000425  loss: 0.7226 (0.7394)  class_acc: 0.8650 (0.8676)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 17.2274 (18.0452)  time: 0.6574  data: 0.0001  max mem: 11436
Epoch: [4]  [ 50/164]  eta: 0:01:17  lr: 0.000431  min_lr: 0.000431  loss: 0.7268 (0.7402)  class_acc: 0.8650 (0.8679)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 16.5822 (17.9234)  time: 0.6579  data: 0.0001  max mem: 11436
Epoch: [4]  [ 60/164]  eta: 0:01:10  lr: 0.000437  min_lr: 0.000437  loss: 0.7379 (0.7400)  class_acc: 0.8650 (0.8688)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 16.9606 (18.1055)  time: 0.6590  data: 0.0001  max mem: 11436
Epoch: [4]  [ 70/164]  eta: 0:01:03  lr: 0.000443  min_lr: 0.000443  loss: 0.7463 (0.7459)  class_acc: 0.8700 (0.8668)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 19.7070 (18.3678)  time: 0.6576  data: 0.0001  max mem: 11436
Epoch: [4]  [ 80/164]  eta: 0:00:56  lr: 0.000449  min_lr: 0.000449  loss: 0.7451 (0.7431)  class_acc: 0.8700 (0.8675)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 16.6438 (18.3334)  time: 0.6585  data: 0.0003  max mem: 11436
Epoch: [4]  [ 90/164]  eta: 0:00:49  lr: 0.000455  min_lr: 0.000455  loss: 0.7135 (0.7389)  class_acc: 0.8700 (0.8689)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 14.0386 (17.7407)  time: 0.6600  data: 0.0003  max mem: 11436
Epoch: [4]  [100/164]  eta: 0:00:42  lr: 0.000462  min_lr: 0.000462  loss: 0.7184 (0.7368)  class_acc: 0.8650 (0.8697)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 13.4146 (17.7514)  time: 0.6600  data: 0.0001  max mem: 11436
Epoch: [4]  [110/164]  eta: 0:00:36  lr: 0.000468  min_lr: 0.000468  loss: 0.7165 (0.7347)  class_acc: 0.8650 (0.8705)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 15.8418 (17.5444)  time: 0.6596  data: 0.0002  max mem: 11436
Epoch: [4]  [120/164]  eta: 0:00:29  lr: 0.000474  min_lr: 0.000474  loss: 0.7212 (0.7354)  class_acc: 0.8650 (0.8693)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 15.8418 (17.4971)  time: 0.6603  data: 0.0002  max mem: 11436
Epoch: [4]  [130/164]  eta: 0:00:22  lr: 0.000480  min_lr: 0.000480  loss: 0.7388 (0.7353)  class_acc: 0.8650 (0.8700)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 16.3951 (17.5738)  time: 0.6608  data: 0.0002  max mem: 11436
Epoch: [4]  [140/164]  eta: 0:00:15  lr: 0.000486  min_lr: 0.000486  loss: 0.7110 (0.7333)  class_acc: 0.8800 (0.8712)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 17.1134 (17.5930)  time: 0.6587  data: 0.0002  max mem: 11436
Epoch: [4]  [150/164]  eta: 0:00:09  lr: 0.000492  min_lr: 0.000492  loss: 0.6958 (0.7314)  class_acc: 0.8800 (0.8716)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 15.2249 (17.8107)  time: 0.6596  data: 0.0002  max mem: 11436
Epoch: [4]  [160/164]  eta: 0:00:02  lr: 0.000498  min_lr: 0.000498  loss: 0.6958 (0.7292)  class_acc: 0.8800 (0.8726)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 12.1229 (17.6783)  time: 0.6611  data: 0.0001  max mem: 11436
Epoch: [4]  [163/164]  eta: 0:00:00  lr: 0.000500  min_lr: 0.000500  loss: 0.6958 (0.7291)  class_acc: 0.8800 (0.8723)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 11.9134 (17.5720)  time: 0.6604  data: 0.0001  max mem: 11436
Epoch: [4] Total time: 0:01:49 (0.6668 s / it)
Averaged stats: lr: 0.000500  min_lr: 0.000500  loss: 0.6958 (0.7283)  class_acc: 0.8800 (0.8730)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 11.9134 (17.5720)
Val:  [ 0/30]  eta: 0:00:48  loss: 0.9826 (0.9826)  n: 300.0000 (300.0000)  accuracy: 0.6633 (0.6633)  balanced_accuracy: 0.3565 (0.3565)  cohen_kappa: 0.4311 (0.4311)  f1_weighted: 0.6269 (0.6269)  time: 1.6073  data: 1.3480  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [10/30]  eta: 0:00:07  loss: 1.0642 (1.0591)  n: 300.0000 (300.0000)  accuracy: 0.6500 (0.6545)  balanced_accuracy: 0.3996 (0.4184)  cohen_kappa: 0.4338 (0.4366)  f1_weighted: 0.6103 (0.6154)  time: 0.3875  data: 0.1227  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [20/30]  eta: 0:00:03  loss: 1.0789 (1.0725)  n: 300.0000 (300.0000)  accuracy: 0.6467 (0.6565)  balanced_accuracy: 0.4157 (0.4187)  cohen_kappa: 0.4402 (0.4410)  f1_weighted: 0.6103 (0.6175)  time: 0.2668  data: 0.0001  max mem: 11436
Val:  [29/30]  eta: 0:00:00  loss: 1.0606 (1.0692)  n: 300.0000 (299.4333)  accuracy: 0.6500 (0.6549)  balanced_accuracy: 0.4123 (0.4156)  cohen_kappa: 0.4402 (0.4384)  f1_weighted: 0.6137 (0.6154)  time: 0.2672  data: 0.0001  max mem: 11436
Val: Total time: 0:00:09 (0.3149 s / it)
* loss 1.050
{'accuracy': 0.6549037070021151, 'balanced_accuracy': 0.4132389545754112, 'cohen_kappa': 0.4389856134309028, 'f1_weighted': 0.615502333844144, 'loss': 1.050374980767568, 'precision': 0.4786495394673003, 'sensitivity': 0.4132389545754112, 'f1': 0.39101999574357715, 'specificity': 0.9050186640795778}
Accuracy of the network on the 17965 val EEG: 0.65%
Test:  [ 0/48]  eta: 0:01:16  loss: 0.7495 (0.7495)  n: 300.0000 (300.0000)  accuracy: 0.8000 (0.8000)  balanced_accuracy: 0.5390 (0.5390)  cohen_kappa: 0.5696 (0.5696)  f1_weighted: 0.7828 (0.7828)  time: 1.5992  data: 1.3420  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [10/48]  eta: 0:00:14  loss: 0.7495 (0.7407)  n: 300.0000 (300.0000)  accuracy: 0.8000 (0.8088)  balanced_accuracy: 0.5402 (0.5393)  cohen_kappa: 0.5838 (0.5897)  f1_weighted: 0.7828 (0.7933)  time: 0.3880  data: 0.1225  max mem: 11436
Test:  [20/48]  eta: 0:00:09  loss: 0.7482 (0.7524)  n: 300.0000 (300.0000)  accuracy: 0.8033 (0.8030)  balanced_accuracy: 0.5403 (0.5280)  cohen_kappa: 0.5838 (0.5831)  f1_weighted: 0.7886 (0.7872)  time: 0.2672  data: 0.0004  max mem: 11436
Test:  [30/48]  eta: 0:00:05  loss: 0.7584 (0.7680)  n: 300.0000 (300.0000)  accuracy: 0.8000 (0.7982)  balanced_accuracy: 0.5459 (0.5307)  cohen_kappa: 0.5715 (0.5766)  f1_weighted: 0.7773 (0.7817)  time: 0.2679  data: 0.0002  max mem: 11436
Test:  [40/48]  eta: 0:00:02  loss: 0.7940 (0.7741)  n: 300.0000 (300.0000)  accuracy: 0.8000 (0.7988)  balanced_accuracy: 0.5459 (0.5328)  cohen_kappa: 0.5736 (0.5786)  f1_weighted: 0.7773 (0.7823)  time: 0.2685  data: 0.0001  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [47/48]  eta: 0:00:00  loss: 0.7768 (0.7749)  n: 300.0000 (294.8542)  accuracy: 0.8033 (0.7996)  balanced_accuracy: 0.5212 (0.5316)  cohen_kappa: 0.5755 (0.5796)  f1_weighted: 0.7825 (0.7832)  time: 0.2573  data: 0.0001  max mem: 11436
Test: Total time: 0:00:14 (0.2932 s / it)
* loss 0.764
{'accuracy': 0.7996184554511411, 'balanced_accuracy': 0.5339734810331324, 'cohen_kappa': 0.5794045974207042, 'f1_weighted': 0.7835509534528357, 'loss': 0.763502890865008, 'precision': 0.6304360290500665, 'sensitivity': 0.5339734810331324, 'f1': 0.5357462084241125, 'specificity': 0.9386753037996732}
Accuracy of the network on the 28305 test EEG: 0.80%
Max accuracy val: 0.65%, max accuracy test: 0.80%
Epoch: [5]  [  0/164]  eta: 0:04:24  lr: 0.000500  min_lr: 0.000500  loss: 0.7053 (0.7053)  class_acc: 0.8750 (0.8750)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 8.0517 (8.0517)  time: 1.6127  data: 1.0106  max mem: 11436
Epoch: [5]  [ 10/164]  eta: 0:01:54  lr: 0.000500  min_lr: 0.000500  loss: 0.6976 (0.6941)  class_acc: 0.8850 (0.8841)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 11.9494 (12.0443)  time: 0.7455  data: 0.0920  max mem: 11436
Epoch: [5]  [ 20/164]  eta: 0:01:41  lr: 0.000500  min_lr: 0.000500  loss: 0.6585 (0.6684)  class_acc: 0.9050 (0.8990)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.8131 (11.4112)  time: 0.6591  data: 0.0001  max mem: 11436
Epoch: [5]  [ 30/164]  eta: 0:01:32  lr: 0.000500  min_lr: 0.000500  loss: 0.6578 (0.6795)  class_acc: 0.9050 (0.8952)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.5767 (12.8220)  time: 0.6599  data: 0.0001  max mem: 11436
Epoch: [5]  [ 40/164]  eta: 0:01:24  lr: 0.000500  min_lr: 0.000500  loss: 0.7184 (0.6900)  class_acc: 0.8800 (0.8916)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 16.6906 (15.0861)  time: 0.6584  data: 0.0001  max mem: 11436
Epoch: [5]  [ 50/164]  eta: 0:01:17  lr: 0.000499  min_lr: 0.000499  loss: 0.7178 (0.6955)  class_acc: 0.8800 (0.8902)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 19.5661 (15.9117)  time: 0.6585  data: 0.0001  max mem: 11436
Epoch: [5]  [ 60/164]  eta: 0:01:10  lr: 0.000499  min_lr: 0.000499  loss: 0.7031 (0.6939)  class_acc: 0.8900 (0.8914)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 17.2435 (16.0900)  time: 0.6601  data: 0.0002  max mem: 11436
Epoch: [5]  [ 70/164]  eta: 0:01:03  lr: 0.000499  min_lr: 0.000499  loss: 0.7031 (0.6942)  class_acc: 0.8950 (0.8909)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 14.1395 (15.7726)  time: 0.6590  data: 0.0001  max mem: 11436
Epoch: [5]  [ 80/164]  eta: 0:00:56  lr: 0.000499  min_lr: 0.000499  loss: 0.6696 (0.6905)  class_acc: 0.9000 (0.8928)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.7143 (15.0675)  time: 0.6578  data: 0.0001  max mem: 11436
Epoch: [5]  [ 90/164]  eta: 0:00:49  lr: 0.000498  min_lr: 0.000498  loss: 0.6584 (0.6866)  class_acc: 0.9100 (0.8954)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.1378 (14.8860)  time: 0.6581  data: 0.0001  max mem: 11436
Epoch: [5]  [100/164]  eta: 0:00:42  lr: 0.000498  min_lr: 0.000498  loss: 0.6443 (0.6825)  class_acc: 0.9150 (0.8976)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.9991 (14.4396)  time: 0.6594  data: 0.0001  max mem: 11436
Epoch: [5]  [110/164]  eta: 0:00:36  lr: 0.000498  min_lr: 0.000498  loss: 0.6453 (0.6797)  class_acc: 0.9150 (0.8987)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.2812 (14.1146)  time: 0.6586  data: 0.0001  max mem: 11436
Epoch: [5]  [120/164]  eta: 0:00:29  lr: 0.000497  min_lr: 0.000497  loss: 0.6453 (0.6774)  class_acc: 0.9150 (0.9000)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.4913 (13.8744)  time: 0.6588  data: 0.0001  max mem: 11436
Epoch: [5]  [130/164]  eta: 0:00:22  lr: 0.000497  min_lr: 0.000497  loss: 0.6798 (0.6789)  class_acc: 0.9050 (0.8990)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 12.0943 (13.8912)  time: 0.6597  data: 0.0002  max mem: 11436
Epoch: [5]  [140/164]  eta: 0:00:15  lr: 0.000496  min_lr: 0.000496  loss: 0.6676 (0.6785)  class_acc: 0.9000 (0.8991)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 12.3367 (13.8300)  time: 0.6584  data: 0.0001  max mem: 11436
Epoch: [5]  [150/164]  eta: 0:00:09  lr: 0.000495  min_lr: 0.000495  loss: 0.6591 (0.6774)  class_acc: 0.9000 (0.8993)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 14.0847 (13.9590)  time: 0.6582  data: 0.0001  max mem: 11436
Epoch: [5]  [160/164]  eta: 0:00:02  lr: 0.000495  min_lr: 0.000495  loss: 0.6654 (0.6772)  class_acc: 0.9000 (0.8993)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 14.0847 (14.0418)  time: 0.6587  data: 0.0001  max mem: 11436
Epoch: [5]  [163/164]  eta: 0:00:00  lr: 0.000495  min_lr: 0.000495  loss: 0.6654 (0.6768)  class_acc: 0.9000 (0.8992)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 14.8087 (14.0715)  time: 0.6582  data: 0.0001  max mem: 11436
Epoch: [5] Total time: 0:01:49 (0.6657 s / it)
Averaged stats: lr: 0.000495  min_lr: 0.000495  loss: 0.6654 (0.6781)  class_acc: 0.9000 (0.8987)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 14.8087 (14.0715)
Val:  [ 0/30]  eta: 0:00:42  loss: 1.1236 (1.1236)  n: 300.0000 (300.0000)  accuracy: 0.6433 (0.6433)  balanced_accuracy: 0.3710 (0.3710)  cohen_kappa: 0.4074 (0.4074)  f1_weighted: 0.5935 (0.5935)  time: 1.4165  data: 1.1567  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [10/30]  eta: 0:00:07  loss: 1.2028 (1.2176)  n: 300.0000 (300.0000)  accuracy: 0.6533 (0.6485)  balanced_accuracy: 0.4434 (0.4726)  cohen_kappa: 0.4484 (0.4380)  f1_weighted: 0.6060 (0.6016)  time: 0.3694  data: 0.1053  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [20/30]  eta: 0:00:03  loss: 1.2475 (1.2283)  n: 300.0000 (300.0000)  accuracy: 0.6433 (0.6452)  balanced_accuracy: 0.4573 (0.4619)  cohen_kappa: 0.4416 (0.4349)  f1_weighted: 0.5984 (0.6004)  time: 0.2648  data: 0.0001  max mem: 11436
Val:  [29/30]  eta: 0:00:00  loss: 1.2222 (1.2250)  n: 300.0000 (299.4333)  accuracy: 0.6333 (0.6427)  balanced_accuracy: 0.4496 (0.4580)  cohen_kappa: 0.4218 (0.4311)  f1_weighted: 0.5934 (0.5974)  time: 0.2648  data: 0.0001  max mem: 11436
Val: Total time: 0:00:09 (0.3065 s / it)
* loss 1.196
{'accuracy': 0.642658354669932, 'balanced_accuracy': 0.4608595064855643, 'cohen_kappa': 0.43161631127069033, 'f1_weighted': 0.5969897997931133, 'loss': 1.1962549269199372, 'precision': 0.4836134556574439, 'sensitivity': 0.4608595064855643, 'f1': 0.39663558700030815, 'specificity': 0.9056518170061798}
Accuracy of the network on the 17965 val EEG: 0.64%
Test:  [ 0/48]  eta: 0:01:01  loss: 0.7312 (0.7312)  n: 300.0000 (300.0000)  accuracy: 0.7833 (0.7833)  balanced_accuracy: 0.5265 (0.5265)  cohen_kappa: 0.5401 (0.5401)  f1_weighted: 0.7716 (0.7716)  time: 1.2817  data: 1.0246  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [10/48]  eta: 0:00:13  loss: 0.7379 (0.7201)  n: 300.0000 (300.0000)  accuracy: 0.8033 (0.8036)  balanced_accuracy: 0.5528 (0.5421)  cohen_kappa: 0.5712 (0.5795)  f1_weighted: 0.7901 (0.7910)  time: 0.3576  data: 0.0933  max mem: 11436
Test:  [20/48]  eta: 0:00:08  loss: 0.7379 (0.7302)  n: 300.0000 (300.0000)  accuracy: 0.8033 (0.7978)  balanced_accuracy: 0.5315 (0.5269)  cohen_kappa: 0.5712 (0.5714)  f1_weighted: 0.7864 (0.7841)  time: 0.2651  data: 0.0002  max mem: 11436
Test:  [30/48]  eta: 0:00:05  loss: 0.7518 (0.7476)  n: 300.0000 (300.0000)  accuracy: 0.7900 (0.7939)  balanced_accuracy: 0.5329 (0.5290)  cohen_kappa: 0.5628 (0.5680)  f1_weighted: 0.7708 (0.7799)  time: 0.2653  data: 0.0002  max mem: 11436
Test:  [40/48]  eta: 0:00:02  loss: 0.7833 (0.7548)  n: 300.0000 (300.0000)  accuracy: 0.7833 (0.7935)  balanced_accuracy: 0.5347 (0.5301)  cohen_kappa: 0.5661 (0.5681)  f1_weighted: 0.7672 (0.7796)  time: 0.2653  data: 0.0002  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [47/48]  eta: 0:00:00  loss: 0.7317 (0.7541)  n: 300.0000 (294.8542)  accuracy: 0.7967 (0.7950)  balanced_accuracy: 0.5281 (0.5304)  cohen_kappa: 0.5717 (0.5697)  f1_weighted: 0.7903 (0.7811)  time: 0.2548  data: 0.0001  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test: Total time: 0:00:13 (0.2843 s / it)
* loss 0.743
{'accuracy': 0.7949551331873101, 'balanced_accuracy': 0.5334816978863016, 'cohen_kappa': 0.5695325198471766, 'f1_weighted': 0.7814375943766999, 'loss': 0.7425313200801611, 'precision': 0.6153928400470859, 'sensitivity': 0.5334816978863016, 'f1': 0.5402292078711334, 'specificity': 0.937174228068911}
Accuracy of the network on the 28305 test EEG: 0.79%
Max accuracy val: 0.65%, max accuracy test: 0.80%
Epoch: [6]  [  0/164]  eta: 0:04:17  lr: 0.000495  min_lr: 0.000495  loss: 0.5926 (0.5926)  class_acc: 0.9500 (0.9500)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.8375 (10.8375)  time: 1.5716  data: 0.9560  max mem: 11436
Epoch: [6]  [ 10/164]  eta: 0:01:53  lr: 0.000494  min_lr: 0.000494  loss: 0.6564 (0.6435)  class_acc: 0.9150 (0.9155)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.6757 (10.9679)  time: 0.7395  data: 0.0874  max mem: 11436
Epoch: [6]  [ 20/164]  eta: 0:01:40  lr: 0.000493  min_lr: 0.000493  loss: 0.6289 (0.6385)  class_acc: 0.9200 (0.9167)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.0846 (11.5737)  time: 0.6572  data: 0.0003  max mem: 11436
Epoch: [6]  [ 30/164]  eta: 0:01:32  lr: 0.000492  min_lr: 0.000492  loss: 0.6226 (0.6341)  class_acc: 0.9300 (0.9187)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.1035 (10.9709)  time: 0.6582  data: 0.0001  max mem: 11436
Epoch: [6]  [ 40/164]  eta: 0:01:24  lr: 0.000492  min_lr: 0.000492  loss: 0.6226 (0.6334)  class_acc: 0.9250 (0.9201)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 8.8543 (10.6432)  time: 0.6561  data: 0.0001  max mem: 11436
Epoch: [6]  [ 50/164]  eta: 0:01:16  lr: 0.000491  min_lr: 0.000491  loss: 0.6445 (0.6381)  class_acc: 0.9150 (0.9180)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.8404 (11.1441)  time: 0.6571  data: 0.0001  max mem: 11436
Epoch: [6]  [ 60/164]  eta: 0:01:09  lr: 0.000490  min_lr: 0.000490  loss: 0.6445 (0.6410)  class_acc: 0.9150 (0.9165)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 11.6316 (11.1954)  time: 0.6603  data: 0.0001  max mem: 11436
Epoch: [6]  [ 70/164]  eta: 0:01:03  lr: 0.000489  min_lr: 0.000489  loss: 0.6410 (0.6414)  class_acc: 0.9150 (0.9159)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.5238 (11.2130)  time: 0.6598  data: 0.0001  max mem: 11436
Epoch: [6]  [ 80/164]  eta: 0:00:56  lr: 0.000488  min_lr: 0.000488  loss: 0.6436 (0.6425)  class_acc: 0.9150 (0.9157)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 11.2365 (11.5666)  time: 0.6588  data: 0.0001  max mem: 11436
Epoch: [6]  [ 90/164]  eta: 0:00:49  lr: 0.000487  min_lr: 0.000487  loss: 0.6439 (0.6443)  class_acc: 0.9150 (0.9156)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 12.8588 (11.7683)  time: 0.6585  data: 0.0003  max mem: 11436
Epoch: [6]  [100/164]  eta: 0:00:42  lr: 0.000486  min_lr: 0.000486  loss: 0.6438 (0.6424)  class_acc: 0.9150 (0.9160)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.6093 (11.6064)  time: 0.6594  data: 0.0003  max mem: 11436
Epoch: [6]  [110/164]  eta: 0:00:35  lr: 0.000485  min_lr: 0.000485  loss: 0.6361 (0.6426)  class_acc: 0.9100 (0.9159)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.5029 (11.7402)  time: 0.6594  data: 0.0001  max mem: 11436
Epoch: [6]  [120/164]  eta: 0:00:29  lr: 0.000484  min_lr: 0.000484  loss: 0.6491 (0.6427)  class_acc: 0.9100 (0.9152)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.5567 (11.7435)  time: 0.6589  data: 0.0001  max mem: 11436
Epoch: [6]  [130/164]  eta: 0:00:22  lr: 0.000483  min_lr: 0.000483  loss: 0.6301 (0.6426)  class_acc: 0.9100 (0.9148)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.7319 (11.6993)  time: 0.6593  data: 0.0001  max mem: 11436
Epoch: [6]  [140/164]  eta: 0:00:15  lr: 0.000481  min_lr: 0.000481  loss: 0.6319 (0.6449)  class_acc: 0.9100 (0.9144)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 11.6315 (12.0321)  time: 0.6597  data: 0.0001  max mem: 11436
Epoch: [6]  [150/164]  eta: 0:00:09  lr: 0.000480  min_lr: 0.000480  loss: 0.6415 (0.6456)  class_acc: 0.9150 (0.9137)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 11.6315 (12.0571)  time: 0.6570  data: 0.0001  max mem: 11436
Epoch: [6]  [160/164]  eta: 0:00:02  lr: 0.000479  min_lr: 0.000479  loss: 0.6285 (0.6438)  class_acc: 0.9250 (0.9144)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.7751 (11.8368)  time: 0.6562  data: 0.0001  max mem: 11436
Epoch: [6]  [163/164]  eta: 0:00:00  lr: 0.000479  min_lr: 0.000479  loss: 0.6285 (0.6436)  class_acc: 0.9250 (0.9144)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.3927 (11.8080)  time: 0.6583  data: 0.0001  max mem: 11436
Epoch: [6] Total time: 0:01:49 (0.6649 s / it)
Averaged stats: lr: 0.000479  min_lr: 0.000479  loss: 0.6285 (0.6418)  class_acc: 0.9250 (0.9159)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.3927 (11.8080)
Val:  [ 0/30]  eta: 0:00:38  loss: 1.2434 (1.2434)  n: 300.0000 (300.0000)  accuracy: 0.6433 (0.6433)  balanced_accuracy: 0.5047 (0.5047)  cohen_kappa: 0.3773 (0.3773)  f1_weighted: 0.5848 (0.5848)  time: 1.2759  data: 1.0191  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [10/30]  eta: 0:00:07  loss: 1.2919 (1.3001)  n: 300.0000 (300.0000)  accuracy: 0.6333 (0.6279)  balanced_accuracy: 0.4713 (0.4720)  cohen_kappa: 0.3773 (0.3747)  f1_weighted: 0.5795 (0.5642)  time: 0.3568  data: 0.0928  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [20/30]  eta: 0:00:03  loss: 1.3379 (1.3243)  n: 300.0000 (300.0000)  accuracy: 0.6200 (0.6257)  balanced_accuracy: 0.4290 (0.4385)  cohen_kappa: 0.3636 (0.3719)  f1_weighted: 0.5642 (0.5621)  time: 0.2651  data: 0.0002  max mem: 11436
Val:  [29/30]  eta: 0:00:00  loss: 1.3526 (1.3315)  n: 300.0000 (299.4333)  accuracy: 0.6167 (0.6217)  balanced_accuracy: 0.4079 (0.4230)  cohen_kappa: 0.3590 (0.3655)  f1_weighted: 0.5501 (0.5581)  time: 0.2642  data: 0.0001  max mem: 11436
Val: Total time: 0:00:09 (0.3014 s / it)
* loss 1.297
{'accuracy': 0.6217299343203829, 'balanced_accuracy': 0.41597022810999656, 'cohen_kappa': 0.36601712513277107, 'f1_weighted': 0.5581373027407691, 'loss': 1.2974520901838937, 'precision': 0.501140412728104, 'sensitivity': 0.41597022810999656, 'f1': 0.3670847498982603, 'specificity': 0.8919604655156457}
Accuracy of the network on the 17965 val EEG: 0.62%
Test:  [ 0/48]  eta: 0:01:07  loss: 0.7484 (0.7484)  n: 300.0000 (300.0000)  accuracy: 0.7900 (0.7900)  balanced_accuracy: 0.5297 (0.5297)  cohen_kappa: 0.5139 (0.5139)  f1_weighted: 0.7660 (0.7660)  time: 1.4129  data: 1.1574  max mem: 11436
Test:  [10/48]  eta: 0:00:13  loss: 0.7484 (0.7248)  n: 300.0000 (300.0000)  accuracy: 0.7900 (0.7955)  balanced_accuracy: 0.5013 (0.4948)  cohen_kappa: 0.5139 (0.5215)  f1_weighted: 0.7641 (0.7695)  time: 0.3674  data: 0.1054  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [20/48]  eta: 0:00:08  loss: 0.7508 (0.7408)  n: 300.0000 (300.0000)  accuracy: 0.7867 (0.7889)  balanced_accuracy: 0.4912 (0.4814)  cohen_kappa: 0.5055 (0.5105)  f1_weighted: 0.7568 (0.7623)  time: 0.2638  data: 0.0002  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [30/48]  eta: 0:00:05  loss: 0.7785 (0.7597)  n: 300.0000 (300.0000)  accuracy: 0.7667 (0.7842)  balanced_accuracy: 0.4912 (0.4854)  cohen_kappa: 0.4848 (0.5049)  f1_weighted: 0.7382 (0.7568)  time: 0.2650  data: 0.0002  max mem: 11436
Test:  [40/48]  eta: 0:00:02  loss: 0.8106 (0.7657)  n: 300.0000 (300.0000)  accuracy: 0.7733 (0.7847)  balanced_accuracy: 0.4961 (0.4874)  cohen_kappa: 0.4845 (0.5060)  f1_weighted: 0.7378 (0.7570)  time: 0.2643  data: 0.0002  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [47/48]  eta: 0:00:00  loss: 0.7641 (0.7636)  n: 300.0000 (294.8542)  accuracy: 0.7833 (0.7863)  balanced_accuracy: 0.4961 (0.4886)  cohen_kappa: 0.4906 (0.5083)  f1_weighted: 0.7567 (0.7589)  time: 0.2533  data: 0.0001  max mem: 11436
Test: Total time: 0:00:13 (0.2858 s / it)
* loss 0.752
{'accuracy': 0.7863350526390165, 'balanced_accuracy': 0.49234593558369544, 'cohen_kappa': 0.5089157730913018, 'f1_weighted': 0.7594890102652088, 'loss': 0.7515145397434632, 'precision': 0.600831164645472, 'sensitivity': 0.49234593558369544, 'f1': 0.5071727585576628, 'specificity': 0.9177902190943334}
Accuracy of the network on the 28305 test EEG: 0.79%
Max accuracy val: 0.65%, max accuracy test: 0.80%
Epoch: [7]  [  0/164]  eta: 0:04:38  lr: 0.000478  min_lr: 0.000478  loss: 0.6131 (0.6131)  class_acc: 0.9100 (0.9100)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 18.1845 (18.1845)  time: 1.7008  data: 1.0482  max mem: 11436
Epoch: [7]  [ 10/164]  eta: 0:01:55  lr: 0.000477  min_lr: 0.000477  loss: 0.6135 (0.6227)  class_acc: 0.9250 (0.9218)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 11.2694 (12.8410)  time: 0.7469  data: 0.0959  max mem: 11436
Epoch: [7]  [ 20/164]  eta: 0:01:41  lr: 0.000476  min_lr: 0.000476  loss: 0.6209 (0.6266)  class_acc: 0.9250 (0.9183)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.2883 (13.0184)  time: 0.6547  data: 0.0010  max mem: 11436
Epoch: [7]  [ 30/164]  eta: 0:01:32  lr: 0.000474  min_lr: 0.000474  loss: 0.6238 (0.6284)  class_acc: 0.9150 (0.9192)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 11.2026 (12.6797)  time: 0.6588  data: 0.0010  max mem: 11436
Epoch: [7]  [ 40/164]  eta: 0:01:24  lr: 0.000473  min_lr: 0.000473  loss: 0.6049 (0.6277)  class_acc: 0.9250 (0.9195)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.5197 (12.1192)  time: 0.6595  data: 0.0006  max mem: 11436
Epoch: [7]  [ 50/164]  eta: 0:01:17  lr: 0.000471  min_lr: 0.000471  loss: 0.6093 (0.6259)  class_acc: 0.9300 (0.9221)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.0594 (11.8923)  time: 0.6584  data: 0.0003  max mem: 11436
Epoch: [7]  [ 60/164]  eta: 0:01:10  lr: 0.000470  min_lr: 0.000470  loss: 0.6039 (0.6216)  class_acc: 0.9300 (0.9236)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.7639 (11.6879)  time: 0.6581  data: 0.0001  max mem: 11436
Epoch: [7]  [ 70/164]  eta: 0:01:03  lr: 0.000468  min_lr: 0.000468  loss: 0.6039 (0.6205)  class_acc: 0.9300 (0.9249)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.5543 (11.7448)  time: 0.6588  data: 0.0001  max mem: 11436
Epoch: [7]  [ 80/164]  eta: 0:00:56  lr: 0.000467  min_lr: 0.000467  loss: 0.6212 (0.6237)  class_acc: 0.9300 (0.9242)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 12.7401 (12.5519)  time: 0.6584  data: 0.0001  max mem: 11436
Epoch: [7]  [ 90/164]  eta: 0:00:49  lr: 0.000465  min_lr: 0.000465  loss: 0.6212 (0.6231)  class_acc: 0.9250 (0.9251)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.5562 (12.3688)  time: 0.6580  data: 0.0001  max mem: 11436
Epoch: [7]  [100/164]  eta: 0:00:42  lr: 0.000464  min_lr: 0.000464  loss: 0.6198 (0.6241)  class_acc: 0.9250 (0.9250)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.5108 (12.4094)  time: 0.6590  data: 0.0001  max mem: 11436
Epoch: [7]  [110/164]  eta: 0:00:36  lr: 0.000462  min_lr: 0.000462  loss: 0.6181 (0.6230)  class_acc: 0.9300 (0.9259)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.2330 (12.2558)  time: 0.6592  data: 0.0001  max mem: 11436
Epoch: [7]  [120/164]  eta: 0:00:29  lr: 0.000460  min_lr: 0.000460  loss: 0.6082 (0.6230)  class_acc: 0.9350 (0.9257)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.6873 (12.1357)  time: 0.6583  data: 0.0001  max mem: 11436
Epoch: [7]  [130/164]  eta: 0:00:22  lr: 0.000459  min_lr: 0.000459  loss: 0.6078 (0.6223)  class_acc: 0.9300 (0.9262)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.5127 (11.9524)  time: 0.6588  data: 0.0001  max mem: 11436
Epoch: [7]  [140/164]  eta: 0:00:15  lr: 0.000457  min_lr: 0.000457  loss: 0.6167 (0.6223)  class_acc: 0.9250 (0.9262)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 11.9642 (11.9712)  time: 0.6590  data: 0.0003  max mem: 11436
Epoch: [7]  [150/164]  eta: 0:00:09  lr: 0.000455  min_lr: 0.000455  loss: 0.6178 (0.6222)  class_acc: 0.9200 (0.9260)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.1638 (11.7801)  time: 0.6569  data: 0.0003  max mem: 11436
Epoch: [7]  [160/164]  eta: 0:00:02  lr: 0.000453  min_lr: 0.000453  loss: 0.6109 (0.6213)  class_acc: 0.9250 (0.9265)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.7462 (11.8144)  time: 0.6565  data: 0.0001  max mem: 11436
Epoch: [7]  [163/164]  eta: 0:00:00  lr: 0.000453  min_lr: 0.000453  loss: 0.6166 (0.6218)  class_acc: 0.9200 (0.9260)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.5464 (11.9523)  time: 0.6562  data: 0.0001  max mem: 11436
Epoch: [7] Total time: 0:01:49 (0.6652 s / it)
Averaged stats: lr: 0.000453  min_lr: 0.000453  loss: 0.6166 (0.6226)  class_acc: 0.9200 (0.9246)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.5464 (11.9523)
Val:  [ 0/30]  eta: 0:00:42  loss: 1.2111 (1.2111)  n: 300.0000 (300.0000)  accuracy: 0.6200 (0.6200)  balanced_accuracy: 0.4909 (0.4909)  cohen_kappa: 0.3252 (0.3252)  f1_weighted: 0.5532 (0.5532)  time: 1.4114  data: 1.1495  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [10/30]  eta: 0:00:07  loss: 1.2639 (1.2873)  n: 300.0000 (300.0000)  accuracy: 0.6000 (0.5958)  balanced_accuracy: 0.3652 (0.3904)  cohen_kappa: 0.3252 (0.3160)  f1_weighted: 0.5503 (0.5294)  time: 0.3679  data: 0.1047  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [20/30]  eta: 0:00:03  loss: 1.2906 (1.2944)  n: 300.0000 (300.0000)  accuracy: 0.5933 (0.5949)  balanced_accuracy: 0.3652 (0.3747)  cohen_kappa: 0.3084 (0.3155)  f1_weighted: 0.5321 (0.5296)  time: 0.2643  data: 0.0001  max mem: 11436
Val:  [29/30]  eta: 0:00:00  loss: 1.3073 (1.2932)  n: 300.0000 (299.4333)  accuracy: 0.5933 (0.5941)  balanced_accuracy: 0.3914 (0.3867)  cohen_kappa: 0.3084 (0.3143)  f1_weighted: 0.5228 (0.5281)  time: 0.2637  data: 0.0001  max mem: 11436
Val: Total time: 0:00:09 (0.3052 s / it)
* loss 1.266
{'accuracy': 0.5941222308805522, 'balanced_accuracy': 0.3835460988660229, 'cohen_kappa': 0.3151898469507023, 'f1_weighted': 0.5283834280636406, 'loss': 1.2656021217505138, 'precision': 0.46632333673945775, 'sensitivity': 0.3835460988660229, 'f1': 0.34283190602889685, 'specificity': 0.8838035845781134}
Accuracy of the network on the 17965 val EEG: 0.59%
Test:  [ 0/48]  eta: 0:01:07  loss: 0.6763 (0.6763)  n: 300.0000 (300.0000)  accuracy: 0.8067 (0.8067)  balanced_accuracy: 0.5095 (0.5095)  cohen_kappa: 0.5422 (0.5422)  f1_weighted: 0.7841 (0.7841)  time: 1.4063  data: 1.1532  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [10/48]  eta: 0:00:13  loss: 0.6763 (0.6650)  n: 300.0000 (300.0000)  accuracy: 0.8167 (0.8133)  balanced_accuracy: 0.5095 (0.5013)  cohen_kappa: 0.5500 (0.5568)  f1_weighted: 0.7944 (0.7883)  time: 0.3665  data: 0.1050  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [20/48]  eta: 0:00:08  loss: 0.6817 (0.6864)  n: 300.0000 (300.0000)  accuracy: 0.8167 (0.8084)  balanced_accuracy: 0.4891 (0.4806)  cohen_kappa: 0.5395 (0.5465)  f1_weighted: 0.7827 (0.7809)  time: 0.2636  data: 0.0002  max mem: 11436
Test:  [30/48]  eta: 0:00:05  loss: 0.7414 (0.7064)  n: 300.0000 (300.0000)  accuracy: 0.8000 (0.8038)  balanced_accuracy: 0.4638 (0.4838)  cohen_kappa: 0.5297 (0.5418)  f1_weighted: 0.7779 (0.7758)  time: 0.2643  data: 0.0002  max mem: 11436
Test:  [40/48]  eta: 0:00:02  loss: 0.7390 (0.7096)  n: 300.0000 (300.0000)  accuracy: 0.7933 (0.8036)  balanced_accuracy: 0.5031 (0.4885)  cohen_kappa: 0.5192 (0.5415)  f1_weighted: 0.7634 (0.7753)  time: 0.2642  data: 0.0002  max mem: 11436
Test:  [47/48]  eta: 0:00:00  loss: 0.7065 (0.7072)  n: 300.0000 (294.8542)  accuracy: 0.8067 (0.8048)  balanced_accuracy: 0.5031 (0.4874)  cohen_kappa: 0.5240 (0.5425)  f1_weighted: 0.7790 (0.7767)  time: 0.2536  data: 0.0001  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test: Total time: 0:00:13 (0.2854 s / it)
* loss 0.695
{'accuracy': 0.8048470288984667, 'balanced_accuracy': 0.4876332608406575, 'cohen_kappa': 0.5428954339575074, 'f1_weighted': 0.7774827342106596, 'loss': 0.6949373632669449, 'precision': 0.6551217499657759, 'sensitivity': 0.4876332608406575, 'f1': 0.5324210604926374, 'specificity': 0.920648045362524}
Accuracy of the network on the 28305 test EEG: 0.80%
Max accuracy val: 0.65%, max accuracy test: 0.80%
Epoch: [8]  [  0/164]  eta: 0:04:28  lr: 0.000452  min_lr: 0.000452  loss: 0.6204 (0.6204)  class_acc: 0.9250 (0.9250)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 11.0445 (11.0445)  time: 1.6384  data: 1.0062  max mem: 11436
Epoch: [8]  [ 10/164]  eta: 0:01:56  lr: 0.000450  min_lr: 0.000450  loss: 0.6290 (0.6502)  class_acc: 0.9250 (0.9191)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 14.5472 (16.9655)  time: 0.7561  data: 0.0916  max mem: 11436
Epoch: [8]  [ 20/164]  eta: 0:01:42  lr: 0.000449  min_lr: 0.000449  loss: 0.6260 (0.6353)  class_acc: 0.9350 (0.9200)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 12.1830 (14.4453)  time: 0.6629  data: 0.0001  max mem: 11436
Epoch: [8]  [ 30/164]  eta: 0:01:32  lr: 0.000447  min_lr: 0.000447  loss: 0.6029 (0.6274)  class_acc: 0.9350 (0.9226)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.5348 (13.2134)  time: 0.6585  data: 0.0003  max mem: 11436
Epoch: [8]  [ 40/164]  eta: 0:01:24  lr: 0.000445  min_lr: 0.000445  loss: 0.6122 (0.6260)  class_acc: 0.9300 (0.9217)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.8782 (12.8181)  time: 0.6586  data: 0.0004  max mem: 11436
Epoch: [8]  [ 50/164]  eta: 0:01:17  lr: 0.000443  min_lr: 0.000443  loss: 0.6022 (0.6187)  class_acc: 0.9300 (0.9252)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.3567 (11.9792)  time: 0.6572  data: 0.0002  max mem: 11436
Epoch: [8]  [ 60/164]  eta: 0:01:10  lr: 0.000441  min_lr: 0.000441  loss: 0.5907 (0.6171)  class_acc: 0.9350 (0.9261)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.3567 (11.6234)  time: 0.6578  data: 0.0001  max mem: 11436
Epoch: [8]  [ 70/164]  eta: 0:01:03  lr: 0.000438  min_lr: 0.000438  loss: 0.6026 (0.6152)  class_acc: 0.9300 (0.9270)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 8.9549 (11.2351)  time: 0.6594  data: 0.0001  max mem: 11436
Epoch: [8]  [ 80/164]  eta: 0:00:56  lr: 0.000436  min_lr: 0.000436  loss: 0.5896 (0.6127)  class_acc: 0.9400 (0.9286)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.5206 (10.8445)  time: 0.6580  data: 0.0001  max mem: 11436
Epoch: [8]  [ 90/164]  eta: 0:00:49  lr: 0.000434  min_lr: 0.000434  loss: 0.5809 (0.6103)  class_acc: 0.9450 (0.9297)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.8535 (10.6108)  time: 0.6576  data: 0.0001  max mem: 11436
Epoch: [8]  [100/164]  eta: 0:00:42  lr: 0.000432  min_lr: 0.000432  loss: 0.5842 (0.6089)  class_acc: 0.9400 (0.9304)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.0490 (10.5573)  time: 0.6593  data: 0.0001  max mem: 11436
Epoch: [8]  [110/164]  eta: 0:00:36  lr: 0.000430  min_lr: 0.000430  loss: 0.5879 (0.6085)  class_acc: 0.9400 (0.9306)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.4594 (10.5098)  time: 0.6601  data: 0.0001  max mem: 11436
Epoch: [8]  [120/164]  eta: 0:00:29  lr: 0.000428  min_lr: 0.000428  loss: 0.6020 (0.6084)  class_acc: 0.9250 (0.9305)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.8226 (10.6932)  time: 0.6591  data: 0.0002  max mem: 11436
Epoch: [8]  [130/164]  eta: 0:00:22  lr: 0.000425  min_lr: 0.000425  loss: 0.6053 (0.6086)  class_acc: 0.9250 (0.9305)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.8840 (10.9163)  time: 0.6585  data: 0.0002  max mem: 11436
Epoch: [8]  [140/164]  eta: 0:00:15  lr: 0.000423  min_lr: 0.000423  loss: 0.6212 (0.6092)  class_acc: 0.9350 (0.9302)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 11.0138 (10.9890)  time: 0.6592  data: 0.0001  max mem: 11436
Epoch: [8]  [150/164]  eta: 0:00:09  lr: 0.000421  min_lr: 0.000421  loss: 0.5888 (0.6082)  class_acc: 0.9350 (0.9305)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.0765 (10.9127)  time: 0.6579  data: 0.0001  max mem: 11436
Epoch: [8]  [160/164]  eta: 0:00:02  lr: 0.000418  min_lr: 0.000418  loss: 0.5861 (0.6081)  class_acc: 0.9350 (0.9310)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.0137 (10.9863)  time: 0.6578  data: 0.0001  max mem: 11436
Epoch: [8]  [163/164]  eta: 0:00:00  lr: 0.000418  min_lr: 0.000418  loss: 0.5908 (0.6079)  class_acc: 0.9300 (0.9310)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.8395 (10.9689)  time: 0.6579  data: 0.0001  max mem: 11436
Epoch: [8] Total time: 0:01:49 (0.6659 s / it)
Averaged stats: lr: 0.000418  min_lr: 0.000418  loss: 0.5908 (0.6059)  class_acc: 0.9300 (0.9319)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.8395 (10.9689)
Val:  [ 0/30]  eta: 0:00:39  loss: 1.2703 (1.2703)  n: 300.0000 (300.0000)  accuracy: 0.6167 (0.6167)  balanced_accuracy: 0.5152 (0.5152)  cohen_kappa: 0.3356 (0.3356)  f1_weighted: 0.5449 (0.5449)  time: 1.3218  data: 1.0652  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [10/30]  eta: 0:00:07  loss: 1.3139 (1.3352)  n: 300.0000 (300.0000)  accuracy: 0.5967 (0.5945)  balanced_accuracy: 0.4822 (0.4786)  cohen_kappa: 0.3495 (0.3385)  f1_weighted: 0.5326 (0.5288)  time: 0.3606  data: 0.0970  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [20/30]  eta: 0:00:03  loss: 1.3536 (1.3465)  n: 300.0000 (300.0000)  accuracy: 0.5933 (0.5940)  balanced_accuracy: 0.4483 (0.4533)  cohen_kappa: 0.3487 (0.3406)  f1_weighted: 0.5229 (0.5302)  time: 0.2647  data: 0.0001  max mem: 11436
Val:  [29/30]  eta: 0:00:00  loss: 1.3653 (1.3491)  n: 300.0000 (299.4333)  accuracy: 0.5867 (0.5925)  balanced_accuracy: 0.4304 (0.4533)  cohen_kappa: 0.3368 (0.3372)  f1_weighted: 0.5194 (0.5285)  time: 0.2647  data: 0.0001  max mem: 11436
Val: Total time: 0:00:09 (0.3032 s / it)
* loss 1.323
{'accuracy': 0.5924524101079818, 'balanced_accuracy': 0.46304377955888637, 'cohen_kappa': 0.3380958159251064, 'f1_weighted': 0.5283937769897477, 'loss': 1.3229657451311747, 'precision': 0.5447440696515898, 'sensitivity': 0.46304377955888637, 'f1': 0.3706714345221598, 'specificity': 0.8896739540670078}
Accuracy of the network on the 17965 val EEG: 0.59%
Test:  [ 0/48]  eta: 0:01:02  loss: 0.6932 (0.6932)  n: 300.0000 (300.0000)  accuracy: 0.8033 (0.8033)  balanced_accuracy: 0.5340 (0.5340)  cohen_kappa: 0.5515 (0.5515)  f1_weighted: 0.7876 (0.7876)  time: 1.3120  data: 1.0573  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [10/48]  eta: 0:00:13  loss: 0.6891 (0.6856)  n: 300.0000 (300.0000)  accuracy: 0.8033 (0.8100)  balanced_accuracy: 0.5340 (0.5309)  cohen_kappa: 0.5686 (0.5647)  f1_weighted: 0.7876 (0.7912)  time: 0.3583  data: 0.0963  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [20/48]  eta: 0:00:08  loss: 0.6891 (0.7016)  n: 300.0000 (300.0000)  accuracy: 0.8000 (0.8021)  balanced_accuracy: 0.5243 (0.5183)  cohen_kappa: 0.5411 (0.5495)  f1_weighted: 0.7803 (0.7827)  time: 0.2637  data: 0.0002  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [30/48]  eta: 0:00:05  loss: 0.7326 (0.7177)  n: 300.0000 (300.0000)  accuracy: 0.7800 (0.7965)  balanced_accuracy: 0.5132 (0.5178)  cohen_kappa: 0.5202 (0.5425)  f1_weighted: 0.7663 (0.7766)  time: 0.2642  data: 0.0002  max mem: 11436
Test:  [40/48]  eta: 0:00:02  loss: 0.7289 (0.7189)  n: 300.0000 (300.0000)  accuracy: 0.7933 (0.7978)  balanced_accuracy: 0.5245 (0.5205)  cohen_kappa: 0.5365 (0.5455)  f1_weighted: 0.7665 (0.7782)  time: 0.2644  data: 0.0001  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [47/48]  eta: 0:00:00  loss: 0.6845 (0.7177)  n: 300.0000 (294.8542)  accuracy: 0.8033 (0.7990)  balanced_accuracy: 0.5245 (0.5200)  cohen_kappa: 0.5437 (0.5466)  f1_weighted: 0.7824 (0.7793)  time: 0.2540  data: 0.0001  max mem: 11436
Test: Total time: 0:00:13 (0.2835 s / it)
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
* loss 0.710
{'accuracy': 0.7989825478697096, 'balanced_accuracy': 0.5243853414903767, 'cohen_kappa': 0.5466943149092135, 'f1_weighted': 0.7793950007692911, 'loss': 0.7102397655447324, 'precision': 0.5865525972109835, 'sensitivity': 0.5243853414903767, 'f1': 0.5202244289610424, 'specificity': 0.9257143765597818}
Accuracy of the network on the 28305 test EEG: 0.80%
Max accuracy val: 0.65%, max accuracy test: 0.80%
Epoch: [9]  [  0/164]  eta: 0:04:12  lr: 0.000417  min_lr: 0.000417  loss: 0.5771 (0.5771)  class_acc: 0.9550 (0.9550)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.3392 (9.3392)  time: 1.5373  data: 0.9358  max mem: 11436
Epoch: [9]  [ 10/164]  eta: 0:01:53  lr: 0.000415  min_lr: 0.000415  loss: 0.5915 (0.5835)  class_acc: 0.9450 (0.9436)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.9530 (10.0927)  time: 0.7357  data: 0.0852  max mem: 11436
Epoch: [9]  [ 20/164]  eta: 0:01:40  lr: 0.000413  min_lr: 0.000413  loss: 0.5915 (0.5881)  class_acc: 0.9350 (0.9410)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.5947 (9.9414)  time: 0.6575  data: 0.0001  max mem: 11436
Epoch: [9]  [ 30/164]  eta: 0:01:31  lr: 0.000410  min_lr: 0.000410  loss: 0.5904 (0.5903)  class_acc: 0.9450 (0.9397)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.2944 (9.7688)  time: 0.6591  data: 0.0001  max mem: 11436
Epoch: [9]  [ 40/164]  eta: 0:01:24  lr: 0.000408  min_lr: 0.000408  loss: 0.5822 (0.5899)  class_acc: 0.9400 (0.9401)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.3823 (9.3495)  time: 0.6587  data: 0.0002  max mem: 11436
Epoch: [9]  [ 50/164]  eta: 0:01:16  lr: 0.000405  min_lr: 0.000405  loss: 0.5662 (0.5851)  class_acc: 0.9500 (0.9423)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.0690 (8.9219)  time: 0.6585  data: 0.0002  max mem: 11436
Epoch: [9]  [ 60/164]  eta: 0:01:09  lr: 0.000403  min_lr: 0.000403  loss: 0.5760 (0.5854)  class_acc: 0.9500 (0.9425)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.2829 (8.9186)  time: 0.6592  data: 0.0002  max mem: 11436
Epoch: [9]  [ 70/164]  eta: 0:01:03  lr: 0.000400  min_lr: 0.000400  loss: 0.5831 (0.5849)  class_acc: 0.9450 (0.9428)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.1256 (8.6271)  time: 0.6598  data: 0.0002  max mem: 11436
Epoch: [9]  [ 80/164]  eta: 0:00:56  lr: 0.000398  min_lr: 0.000398  loss: 0.5770 (0.5848)  class_acc: 0.9350 (0.9420)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.5400 (8.9998)  time: 0.6583  data: 0.0001  max mem: 11436
Epoch: [9]  [ 90/164]  eta: 0:00:49  lr: 0.000395  min_lr: 0.000395  loss: 0.5884 (0.5856)  class_acc: 0.9350 (0.9423)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 11.4119 (9.4223)  time: 0.6585  data: 0.0001  max mem: 11436
Epoch: [9]  [100/164]  eta: 0:00:42  lr: 0.000392  min_lr: 0.000392  loss: 0.5884 (0.5847)  class_acc: 0.9450 (0.9427)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 9.6712 (9.4526)  time: 0.6599  data: 0.0001  max mem: 11436
Epoch: [9]  [110/164]  eta: 0:00:35  lr: 0.000390  min_lr: 0.000390  loss: 0.5871 (0.5847)  class_acc: 0.9400 (0.9431)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.6917 (9.2425)  time: 0.6585  data: 0.0001  max mem: 11436
Epoch: [9]  [120/164]  eta: 0:00:29  lr: 0.000387  min_lr: 0.000387  loss: 0.5857 (0.5840)  class_acc: 0.9450 (0.9435)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.0328 (9.1526)  time: 0.6581  data: 0.0001  max mem: 11436
Epoch: [9]  [130/164]  eta: 0:00:22  lr: 0.000385  min_lr: 0.000385  loss: 0.5722 (0.5834)  class_acc: 0.9450 (0.9440)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.8842 (9.1565)  time: 0.6588  data: 0.0001  max mem: 11436
Epoch: [9]  [140/164]  eta: 0:00:15  lr: 0.000382  min_lr: 0.000382  loss: 0.5719 (0.5827)  class_acc: 0.9450 (0.9442)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.0289 (9.0025)  time: 0.6589  data: 0.0001  max mem: 11436
Epoch: [9]  [150/164]  eta: 0:00:09  lr: 0.000379  min_lr: 0.000379  loss: 0.5762 (0.5820)  class_acc: 0.9450 (0.9442)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.1303 (9.0214)  time: 0.6580  data: 0.0001  max mem: 11436
Epoch: [9]  [160/164]  eta: 0:00:02  lr: 0.000376  min_lr: 0.000376  loss: 0.5762 (0.5817)  class_acc: 0.9450 (0.9442)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 8.4877 (8.9464)  time: 0.6578  data: 0.0001  max mem: 11436
Epoch: [9]  [163/164]  eta: 0:00:00  lr: 0.000376  min_lr: 0.000376  loss: 0.5764 (0.5818)  class_acc: 0.9450 (0.9442)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 8.4877 (8.9701)  time: 0.6576  data: 0.0001  max mem: 11436
Epoch: [9] Total time: 0:01:49 (0.6647 s / it)
Averaged stats: lr: 0.000376  min_lr: 0.000376  loss: 0.5764 (0.5826)  class_acc: 0.9450 (0.9436)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 8.4877 (8.9701)
Val:  [ 0/30]  eta: 0:00:39  loss: 1.0996 (1.0996)  n: 300.0000 (300.0000)  accuracy: 0.6833 (0.6833)  balanced_accuracy: 0.5601 (0.5601)  cohen_kappa: 0.4612 (0.4612)  f1_weighted: 0.6422 (0.6422)  time: 1.3299  data: 1.0753  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [10/30]  eta: 0:00:07  loss: 1.1177 (1.1382)  n: 300.0000 (300.0000)  accuracy: 0.6733 (0.6767)  balanced_accuracy: 0.5230 (0.5113)  cohen_kappa: 0.4761 (0.4726)  f1_weighted: 0.6294 (0.6338)  time: 0.3604  data: 0.0979  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [20/30]  eta: 0:00:03  loss: 1.1590 (1.1512)  n: 300.0000 (300.0000)  accuracy: 0.6667 (0.6706)  balanced_accuracy: 0.4746 (0.4928)  cohen_kappa: 0.4709 (0.4651)  f1_weighted: 0.6253 (0.6277)  time: 0.2645  data: 0.0002  max mem: 11436
Val:  [29/30]  eta: 0:00:00  loss: 1.1631 (1.1496)  n: 300.0000 (299.4333)  accuracy: 0.6667 (0.6694)  balanced_accuracy: 0.4746 (0.4928)  cohen_kappa: 0.4606 (0.4624)  f1_weighted: 0.6253 (0.6265)  time: 0.2651  data: 0.0001  max mem: 11436
Val: Total time: 0:00:09 (0.3039 s / it)
* loss 1.117
{'accuracy': 0.6693754870310586, 'balanced_accuracy': 0.4913427153911141, 'cohen_kappa': 0.46304727315584737, 'f1_weighted': 0.6259114686618087, 'loss': 1.116753285129865, 'precision': 0.5314791173161236, 'sensitivity': 0.4913427153911141, 'f1': 0.45063989210479716, 'specificity': 0.9078584168473482}
Accuracy of the network on the 17965 val EEG: 0.67%
Test:  [ 0/48]  eta: 0:01:12  loss: 0.7146 (0.7146)  n: 300.0000 (300.0000)  accuracy: 0.7933 (0.7933)  balanced_accuracy: 0.5507 (0.5507)  cohen_kappa: 0.5488 (0.5488)  f1_weighted: 0.7810 (0.7810)  time: 1.5091  data: 1.2570  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [10/48]  eta: 0:00:14  loss: 0.7075 (0.7119)  n: 300.0000 (300.0000)  accuracy: 0.8000 (0.8030)  balanced_accuracy: 0.5382 (0.5296)  cohen_kappa: 0.5675 (0.5693)  f1_weighted: 0.7852 (0.7882)  time: 0.3761  data: 0.1144  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [20/48]  eta: 0:00:09  loss: 0.7144 (0.7283)  n: 300.0000 (300.0000)  accuracy: 0.7967 (0.7948)  balanced_accuracy: 0.5228 (0.5101)  cohen_kappa: 0.5464 (0.5550)  f1_weighted: 0.7776 (0.7792)  time: 0.2637  data: 0.0002  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [30/48]  eta: 0:00:05  loss: 0.7759 (0.7461)  n: 300.0000 (300.0000)  accuracy: 0.7867 (0.7909)  balanced_accuracy: 0.5227 (0.5117)  cohen_kappa: 0.5296 (0.5509)  f1_weighted: 0.7638 (0.7745)  time: 0.2648  data: 0.0002  max mem: 11436
Test:  [40/48]  eta: 0:00:02  loss: 0.7674 (0.7497)  n: 300.0000 (300.0000)  accuracy: 0.7867 (0.7915)  balanced_accuracy: 0.5238 (0.5154)  cohen_kappa: 0.5414 (0.5528)  f1_weighted: 0.7636 (0.7754)  time: 0.2642  data: 0.0002  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [47/48]  eta: 0:00:00  loss: 0.7369 (0.7496)  n: 300.0000 (294.8542)  accuracy: 0.7967 (0.7927)  balanced_accuracy: 0.5238 (0.5166)  cohen_kappa: 0.5629 (0.5543)  f1_weighted: 0.7779 (0.7771)  time: 0.2532  data: 0.0001  max mem: 11436
Test: Total time: 0:00:13 (0.2876 s / it)
* loss 0.742
{'accuracy': 0.7926941284533314, 'balanced_accuracy': 0.519430834718654, 'cohen_kappa': 0.5545885256026981, 'f1_weighted': 0.7775486412052843, 'loss': 0.7423334314177433, 'precision': 0.5947981831054543, 'sensitivity': 0.519430834718654, 'f1': 0.5267127863769242, 'specificity': 0.93259227314865}
Accuracy of the network on the 28305 test EEG: 0.79%
Max accuracy val: 0.67%, max accuracy test: 0.79%
Epoch: [10]  [  0/164]  eta: 0:04:21  lr: 0.000375  min_lr: 0.000375  loss: 0.5808 (0.5808)  class_acc: 0.9600 (0.9600)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.6992 (4.6992)  time: 1.5926  data: 0.9968  max mem: 11436
Epoch: [10]  [ 10/164]  eta: 0:01:54  lr: 0.000372  min_lr: 0.000372  loss: 0.5808 (0.5824)  class_acc: 0.9450 (0.9432)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.5907 (6.4078)  time: 0.7404  data: 0.0910  max mem: 11436
Epoch: [10]  [ 20/164]  eta: 0:01:41  lr: 0.000370  min_lr: 0.000370  loss: 0.5591 (0.5760)  class_acc: 0.9450 (0.9460)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.3096 (6.5650)  time: 0.6574  data: 0.0003  max mem: 11436
Epoch: [10]  [ 30/164]  eta: 0:01:32  lr: 0.000367  min_lr: 0.000367  loss: 0.5677 (0.5751)  class_acc: 0.9500 (0.9458)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.2359 (7.5117)  time: 0.6588  data: 0.0003  max mem: 11436
Epoch: [10]  [ 40/164]  eta: 0:01:24  lr: 0.000364  min_lr: 0.000364  loss: 0.5711 (0.5757)  class_acc: 0.9450 (0.9445)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 8.6747 (8.0269)  time: 0.6582  data: 0.0003  max mem: 11436
Epoch: [10]  [ 50/164]  eta: 0:01:17  lr: 0.000361  min_lr: 0.000361  loss: 0.5831 (0.5781)  class_acc: 0.9450 (0.9436)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 8.5858 (8.3340)  time: 0.6577  data: 0.0001  max mem: 11436
Epoch: [10]  [ 60/164]  eta: 0:01:10  lr: 0.000358  min_lr: 0.000358  loss: 0.5812 (0.5789)  class_acc: 0.9400 (0.9431)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 8.5858 (8.5345)  time: 0.6578  data: 0.0001  max mem: 11436
Epoch: [10]  [ 70/164]  eta: 0:01:03  lr: 0.000355  min_lr: 0.000355  loss: 0.5599 (0.5764)  class_acc: 0.9500 (0.9446)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.8789 (8.2770)  time: 0.6591  data: 0.0003  max mem: 11436
Epoch: [10]  [ 80/164]  eta: 0:00:56  lr: 0.000353  min_lr: 0.000353  loss: 0.5469 (0.5738)  class_acc: 0.9550 (0.9459)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.6823 (8.0558)  time: 0.6577  data: 0.0003  max mem: 11436
Epoch: [10]  [ 90/164]  eta: 0:00:49  lr: 0.000350  min_lr: 0.000350  loss: 0.5471 (0.5731)  class_acc: 0.9500 (0.9456)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.6103 (7.9858)  time: 0.6571  data: 0.0003  max mem: 11436
Epoch: [10]  [100/164]  eta: 0:00:42  lr: 0.000347  min_lr: 0.000347  loss: 0.5682 (0.5737)  class_acc: 0.9450 (0.9452)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.1219 (8.0078)  time: 0.6587  data: 0.0003  max mem: 11436
Epoch: [10]  [110/164]  eta: 0:00:35  lr: 0.000344  min_lr: 0.000344  loss: 0.5606 (0.5726)  class_acc: 0.9500 (0.9459)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.7044 (8.1234)  time: 0.6598  data: 0.0002  max mem: 11436
Epoch: [10]  [120/164]  eta: 0:00:29  lr: 0.000341  min_lr: 0.000341  loss: 0.5630 (0.5731)  class_acc: 0.9500 (0.9458)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.6550 (8.1120)  time: 0.6591  data: 0.0001  max mem: 11436
Epoch: [10]  [130/164]  eta: 0:00:22  lr: 0.000338  min_lr: 0.000338  loss: 0.5774 (0.5748)  class_acc: 0.9450 (0.9456)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 8.9741 (8.3944)  time: 0.6583  data: 0.0003  max mem: 11436
Epoch: [10]  [140/164]  eta: 0:00:15  lr: 0.000335  min_lr: 0.000335  loss: 0.5835 (0.5753)  class_acc: 0.9400 (0.9453)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 10.2701 (8.5436)  time: 0.6592  data: 0.0003  max mem: 11436
Epoch: [10]  [150/164]  eta: 0:00:09  lr: 0.000332  min_lr: 0.000332  loss: 0.5722 (0.5749)  class_acc: 0.9400 (0.9455)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 8.9631 (8.5866)  time: 0.6577  data: 0.0001  max mem: 11436
Epoch: [10]  [160/164]  eta: 0:00:02  lr: 0.000329  min_lr: 0.000329  loss: 0.5605 (0.5743)  class_acc: 0.9500 (0.9457)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 8.1449 (8.6183)  time: 0.6570  data: 0.0001  max mem: 11436
Epoch: [10]  [163/164]  eta: 0:00:00  lr: 0.000328  min_lr: 0.000328  loss: 0.5641 (0.5745)  class_acc: 0.9450 (0.9456)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 8.7561 (8.6469)  time: 0.6572  data: 0.0001  max mem: 11436
Epoch: [10] Total time: 0:01:49 (0.6648 s / it)
Averaged stats: lr: 0.000328  min_lr: 0.000328  loss: 0.5641 (0.5711)  class_acc: 0.9450 (0.9481)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 8.7561 (8.6469)
Val:  [ 0/30]  eta: 0:00:38  loss: 1.0462 (1.0462)  n: 300.0000 (300.0000)  accuracy: 0.6800 (0.6800)  balanced_accuracy: 0.5571 (0.5571)  cohen_kappa: 0.4632 (0.4632)  f1_weighted: 0.6365 (0.6365)  time: 1.2798  data: 1.0227  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [10/30]  eta: 0:00:07  loss: 1.0957 (1.1239)  n: 300.0000 (300.0000)  accuracy: 0.6767 (0.6764)  balanced_accuracy: 0.5639 (0.5426)  cohen_kappa: 0.4755 (0.4803)  f1_weighted: 0.6365 (0.6351)  time: 0.3550  data: 0.0931  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [20/30]  eta: 0:00:03  loss: 1.1402 (1.1419)  n: 300.0000 (300.0000)  accuracy: 0.6733 (0.6719)  balanced_accuracy: 0.5281 (0.5235)  cohen_kappa: 0.4755 (0.4739)  f1_weighted: 0.6284 (0.6303)  time: 0.2637  data: 0.0001  max mem: 11436
Val:  [29/30]  eta: 0:00:00  loss: 1.1402 (1.1370)  n: 300.0000 (299.4333)  accuracy: 0.6667 (0.6722)  balanced_accuracy: 0.5350 (0.5286)  cohen_kappa: 0.4759 (0.4741)  f1_weighted: 0.6284 (0.6303)  time: 0.2635  data: 0.0001  max mem: 11436
Val: Total time: 0:00:09 (0.3009 s / it)
* loss 1.105
{'accuracy': 0.6721585216520094, 'balanced_accuracy': 0.5257253077835692, 'cohen_kappa': 0.47473705367604857, 'f1_weighted': 0.6299217775096463, 'loss': 1.1053066889444987, 'precision': 0.539820174325152, 'sensitivity': 0.5257253077835692, 'f1': 0.46406590653884594, 'specificity': 0.911103991653429}
Accuracy of the network on the 17965 val EEG: 0.67%
Test:  [ 0/48]  eta: 0:01:07  loss: 0.7028 (0.7028)  n: 300.0000 (300.0000)  accuracy: 0.7867 (0.7867)  balanced_accuracy: 0.5766 (0.5766)  cohen_kappa: 0.5337 (0.5337)  f1_weighted: 0.7769 (0.7769)  time: 1.4046  data: 1.1491  max mem: 11436
Test:  [10/48]  eta: 0:00:14  loss: 0.6990 (0.6949)  n: 300.0000 (300.0000)  accuracy: 0.7967 (0.8006)  balanced_accuracy: 0.5468 (0.5557)  cohen_kappa: 0.5737 (0.5696)  f1_weighted: 0.7908 (0.7910)  time: 0.3689  data: 0.1046  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [20/48]  eta: 0:00:08  loss: 0.7059 (0.7097)  n: 300.0000 (300.0000)  accuracy: 0.7933 (0.7943)  balanced_accuracy: 0.5340 (0.5401)  cohen_kappa: 0.5691 (0.5591)  f1_weighted: 0.7851 (0.7848)  time: 0.2657  data: 0.0002  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [30/48]  eta: 0:00:05  loss: 0.7438 (0.7263)  n: 300.0000 (300.0000)  accuracy: 0.7800 (0.7911)  balanced_accuracy: 0.5313 (0.5410)  cohen_kappa: 0.5494 (0.5566)  f1_weighted: 0.7734 (0.7811)  time: 0.2654  data: 0.0002  max mem: 11436
Test:  [40/48]  eta: 0:00:02  loss: 0.7568 (0.7314)  n: 300.0000 (300.0000)  accuracy: 0.7867 (0.7915)  balanced_accuracy: 0.5393 (0.5405)  cohen_kappa: 0.5616 (0.5576)  f1_weighted: 0.7734 (0.7816)  time: 0.2643  data: 0.0001  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [47/48]  eta: 0:00:00  loss: 0.6953 (0.7310)  n: 300.0000 (294.8542)  accuracy: 0.7933 (0.7930)  balanced_accuracy: 0.5493 (0.5424)  cohen_kappa: 0.5622 (0.5594)  f1_weighted: 0.7848 (0.7830)  time: 0.2535  data: 0.0001  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test: Total time: 0:00:13 (0.2862 s / it)
* loss 0.726
{'accuracy': 0.7929767540450788, 'balanced_accuracy': 0.5456339085596162, 'cohen_kappa': 0.559731849820815, 'f1_weighted': 0.783331935222331, 'loss': 0.7264139546702305, 'precision': 0.6005902565866427, 'sensitivity': 0.5456339085596162, 'f1': 0.5490218332059371, 'specificity': 0.9336200015322952}
Accuracy of the network on the 28305 test EEG: 0.79%
Max accuracy val: 0.67%, max accuracy test: 0.79%
Epoch: [11]  [  0/164]  eta: 0:04:09  lr: 0.000328  min_lr: 0.000328  loss: 0.5810 (0.5810)  class_acc: 0.9500 (0.9500)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.9483 (4.9483)  time: 1.5222  data: 0.9274  max mem: 11436
Epoch: [11]  [ 10/164]  eta: 0:01:53  lr: 0.000325  min_lr: 0.000325  loss: 0.5390 (0.5501)  class_acc: 0.9550 (0.9555)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.6059 (7.1830)  time: 0.7342  data: 0.0845  max mem: 11436
Epoch: [11]  [ 20/164]  eta: 0:01:40  lr: 0.000322  min_lr: 0.000322  loss: 0.5390 (0.5513)  class_acc: 0.9550 (0.9557)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.3462 (7.3350)  time: 0.6564  data: 0.0002  max mem: 11436
Epoch: [11]  [ 30/164]  eta: 0:01:31  lr: 0.000318  min_lr: 0.000318  loss: 0.5438 (0.5482)  class_acc: 0.9550 (0.9574)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.9218 (6.9025)  time: 0.6571  data: 0.0001  max mem: 11436
Epoch: [11]  [ 40/164]  eta: 0:01:24  lr: 0.000315  min_lr: 0.000315  loss: 0.5371 (0.5463)  class_acc: 0.9550 (0.9584)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.5100 (6.7470)  time: 0.6574  data: 0.0001  max mem: 11436
Epoch: [11]  [ 50/164]  eta: 0:01:16  lr: 0.000312  min_lr: 0.000312  loss: 0.5388 (0.5468)  class_acc: 0.9600 (0.9591)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.1360 (7.0271)  time: 0.6577  data: 0.0001  max mem: 11436
Epoch: [11]  [ 60/164]  eta: 0:01:09  lr: 0.000309  min_lr: 0.000309  loss: 0.5548 (0.5500)  class_acc: 0.9550 (0.9577)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.8695 (7.1457)  time: 0.6579  data: 0.0001  max mem: 11436
Epoch: [11]  [ 70/164]  eta: 0:01:02  lr: 0.000306  min_lr: 0.000306  loss: 0.5666 (0.5523)  class_acc: 0.9500 (0.9568)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.1317 (7.2500)  time: 0.6581  data: 0.0001  max mem: 11436
Epoch: [11]  [ 80/164]  eta: 0:00:56  lr: 0.000303  min_lr: 0.000303  loss: 0.5582 (0.5525)  class_acc: 0.9500 (0.9563)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.1317 (7.2311)  time: 0.6577  data: 0.0001  max mem: 11436
Epoch: [11]  [ 90/164]  eta: 0:00:49  lr: 0.000300  min_lr: 0.000300  loss: 0.5516 (0.5522)  class_acc: 0.9500 (0.9563)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.8741 (7.3041)  time: 0.6587  data: 0.0001  max mem: 11436
Epoch: [11]  [100/164]  eta: 0:00:42  lr: 0.000297  min_lr: 0.000297  loss: 0.5522 (0.5531)  class_acc: 0.9550 (0.9554)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.6966 (7.1824)  time: 0.6594  data: 0.0001  max mem: 11436
Epoch: [11]  [110/164]  eta: 0:00:35  lr: 0.000294  min_lr: 0.000294  loss: 0.5543 (0.5542)  class_acc: 0.9500 (0.9547)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.5021 (7.3287)  time: 0.6584  data: 0.0001  max mem: 11436
Epoch: [11]  [120/164]  eta: 0:00:29  lr: 0.000290  min_lr: 0.000290  loss: 0.5586 (0.5550)  class_acc: 0.9500 (0.9540)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.8880 (7.3305)  time: 0.6577  data: 0.0001  max mem: 11436
Epoch: [11]  [130/164]  eta: 0:00:22  lr: 0.000287  min_lr: 0.000287  loss: 0.5495 (0.5547)  class_acc: 0.9600 (0.9543)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.8880 (7.3038)  time: 0.6590  data: 0.0001  max mem: 11436
Epoch: [11]  [140/164]  eta: 0:00:15  lr: 0.000284  min_lr: 0.000284  loss: 0.5431 (0.5550)  class_acc: 0.9600 (0.9545)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.4645 (7.2543)  time: 0.6598  data: 0.0001  max mem: 11436
Epoch: [11]  [150/164]  eta: 0:00:09  lr: 0.000281  min_lr: 0.000281  loss: 0.5478 (0.5546)  class_acc: 0.9550 (0.9544)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.4645 (7.2258)  time: 0.6576  data: 0.0001  max mem: 11436
Epoch: [11]  [160/164]  eta: 0:00:02  lr: 0.000278  min_lr: 0.000278  loss: 0.5421 (0.5536)  class_acc: 0.9600 (0.9549)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.0520 (7.1598)  time: 0.6575  data: 0.0001  max mem: 11436
Epoch: [11]  [163/164]  eta: 0:00:00  lr: 0.000277  min_lr: 0.000277  loss: 0.5368 (0.5534)  class_acc: 0.9600 (0.9550)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.0520 (7.1417)  time: 0.6569  data: 0.0001  max mem: 11436
Epoch: [11] Total time: 0:01:48 (0.6645 s / it)
Averaged stats: lr: 0.000277  min_lr: 0.000277  loss: 0.5368 (0.5542)  class_acc: 0.9600 (0.9545)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.0520 (7.1417)
Val:  [ 0/30]  eta: 0:00:44  loss: 1.0908 (1.0908)  n: 300.0000 (300.0000)  accuracy: 0.6833 (0.6833)  balanced_accuracy: 0.3675 (0.3675)  cohen_kappa: 0.4428 (0.4428)  f1_weighted: 0.6351 (0.6351)  time: 1.4992  data: 1.2430  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [10/30]  eta: 0:00:07  loss: 1.1261 (1.1580)  n: 300.0000 (300.0000)  accuracy: 0.6867 (0.6879)  balanced_accuracy: 0.4803 (0.4668)  cohen_kappa: 0.4894 (0.4754)  f1_weighted: 0.6450 (0.6395)  time: 0.3751  data: 0.1131  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [20/30]  eta: 0:00:03  loss: 1.1757 (1.1704)  n: 300.0000 (300.0000)  accuracy: 0.6867 (0.6841)  balanced_accuracy: 0.4713 (0.4656)  cohen_kappa: 0.4751 (0.4708)  f1_weighted: 0.6407 (0.6353)  time: 0.2638  data: 0.0001  max mem: 11436
Val:  [29/30]  eta: 0:00:00  loss: 1.1716 (1.1679)  n: 300.0000 (299.4333)  accuracy: 0.6767 (0.6812)  balanced_accuracy: 0.4713 (0.4669)  cohen_kappa: 0.4520 (0.4661)  f1_weighted: 0.6306 (0.6331)  time: 0.2632  data: 0.0001  max mem: 11436
Val: Total time: 0:00:09 (0.3079 s / it)
* loss 1.132
{'accuracy': 0.6811755538238896, 'balanced_accuracy': 0.46758657006443194, 'cohen_kappa': 0.46683690984020365, 'f1_weighted': 0.6329713323480699, 'loss': 1.131844707330068, 'precision': 0.5891050116470743, 'sensitivity': 0.46758657006443194, 'f1': 0.46568571594141295, 'specificity': 0.9061879022899872}
Accuracy of the network on the 17965 val EEG: 0.68%
Test:  [ 0/48]  eta: 0:01:09  loss: 0.7195 (0.7195)  n: 300.0000 (300.0000)  accuracy: 0.7900 (0.7900)  balanced_accuracy: 0.5443 (0.5443)  cohen_kappa: 0.5305 (0.5305)  f1_weighted: 0.7699 (0.7699)  time: 1.4409  data: 1.1826  max mem: 11436
Test:  [10/48]  eta: 0:00:14  loss: 0.6894 (0.6977)  n: 300.0000 (300.0000)  accuracy: 0.8033 (0.8085)  balanced_accuracy: 0.5443 (0.5291)  cohen_kappa: 0.5699 (0.5724)  f1_weighted: 0.7849 (0.7888)  time: 0.3720  data: 0.1077  max mem: 11436
Test:  [20/48]  eta: 0:00:09  loss: 0.6946 (0.7168)  n: 300.0000 (300.0000)  accuracy: 0.8000 (0.8025)  balanced_accuracy: 0.5028 (0.5127)  cohen_kappa: 0.5624 (0.5619)  f1_weighted: 0.7843 (0.7823)  time: 0.2660  data: 0.0002  max mem: 11436
Test:  [30/48]  eta: 0:00:05  loss: 0.7544 (0.7371)  n: 300.0000 (300.0000)  accuracy: 0.7900 (0.7968)  balanced_accuracy: 0.5073 (0.5133)  cohen_kappa: 0.5354 (0.5543)  f1_weighted: 0.7679 (0.7760)  time: 0.2663  data: 0.0002  max mem: 11436
Test:  [40/48]  eta: 0:00:02  loss: 0.7581 (0.7447)  n: 300.0000 (300.0000)  accuracy: 0.7900 (0.7961)  balanced_accuracy: 0.5277 (0.5150)  cohen_kappa: 0.5452 (0.5534)  f1_weighted: 0.7624 (0.7755)  time: 0.2651  data: 0.0001  max mem: 11436
Test:  [47/48]  eta: 0:00:00  loss: 0.7434 (0.7447)  n: 300.0000 (294.8542)  accuracy: 0.7967 (0.7962)  balanced_accuracy: 0.5277 (0.5141)  cohen_kappa: 0.5499 (0.5521)  f1_weighted: 0.7763 (0.7758)  time: 0.2540  data: 0.0001  max mem: 11436
Test: Total time: 0:00:13 (0.2877 s / it)
* loss 0.736
{'accuracy': 0.7961562919522363, 'balanced_accuracy': 0.5162948491968892, 'cohen_kappa': 0.5521563249029926, 'f1_weighted': 0.7765040940080797, 'loss': 0.7360719818000993, 'precision': 0.6256639412287581, 'sensitivity': 0.5162948491968892, 'f1': 0.5396920758732034, 'specificity': 0.9285868205070774}
Accuracy of the network on the 28305 test EEG: 0.80%
Max accuracy val: 0.68%, max accuracy test: 0.80%
Epoch: [12]  [  0/164]  eta: 0:04:05  lr: 0.000277  min_lr: 0.000277  loss: 0.5325 (0.5325)  class_acc: 0.9700 (0.9700)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.0031 (7.0031)  time: 1.4992  data: 0.8990  max mem: 11436
Epoch: [12]  [ 10/164]  eta: 0:01:52  lr: 0.000273  min_lr: 0.000273  loss: 0.5380 (0.5493)  class_acc: 0.9550 (0.9541)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.8650 (6.1227)  time: 0.7325  data: 0.0818  max mem: 11436
Epoch: [12]  [ 20/164]  eta: 0:01:40  lr: 0.000270  min_lr: 0.000270  loss: 0.5462 (0.5479)  class_acc: 0.9550 (0.9564)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.9662 (6.8706)  time: 0.6573  data: 0.0001  max mem: 11436
Epoch: [12]  [ 30/164]  eta: 0:01:31  lr: 0.000267  min_lr: 0.000267  loss: 0.5403 (0.5440)  class_acc: 0.9600 (0.9597)  loss_scale: 4096.0000 (4096.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.6779 (7.1617)  time: 0.6588  data: 0.0001  max mem: 11436
Epoch: [12]  [ 40/164]  eta: 0:01:24  lr: 0.000264  min_lr: 0.000264  loss: 0.5493 (0.5484)  class_acc: 0.9550 (0.9573)  loss_scale: 4096.0000 (4695.4146)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.5425 (7.6951)  time: 0.6587  data: 0.0002  max mem: 11436
Epoch: [12]  [ 50/164]  eta: 0:01:16  lr: 0.000261  min_lr: 0.000261  loss: 0.5512 (0.5479)  class_acc: 0.9550 (0.9575)  loss_scale: 8192.0000 (5381.0196)  weight_decay: 0.0500 (0.0500)  grad_norm: 8.1632 (7.7748)  time: 0.6582  data: 0.0001  max mem: 11436
Epoch: [12]  [ 60/164]  eta: 0:01:09  lr: 0.000258  min_lr: 0.000258  loss: 0.5361 (0.5476)  class_acc: 0.9650 (0.9570)  loss_scale: 8192.0000 (5841.8361)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.8156 (7.5647)  time: 0.6583  data: 0.0005  max mem: 11436
Epoch: [12]  [ 70/164]  eta: 0:01:02  lr: 0.000254  min_lr: 0.000254  loss: 0.5224 (0.5458)  class_acc: 0.9650 (0.9578)  loss_scale: 8192.0000 (6172.8451)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.7944 (7.2788)  time: 0.6593  data: 0.0005  max mem: 11436
Epoch: [12]  [ 80/164]  eta: 0:00:56  lr: 0.000251  min_lr: 0.000251  loss: 0.5225 (0.5446)  class_acc: 0.9650 (0.9581)  loss_scale: 8192.0000 (6422.1235)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.7312 (7.1228)  time: 0.6589  data: 0.0001  max mem: 11436
Epoch: [12]  [ 90/164]  eta: 0:00:49  lr: 0.000248  min_lr: 0.000248  loss: 0.5334 (0.5446)  class_acc: 0.9600 (0.9581)  loss_scale: 8192.0000 (6616.6154)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.0298 (7.1185)  time: 0.6586  data: 0.0001  max mem: 11436
Epoch: [12]  [100/164]  eta: 0:00:42  lr: 0.000245  min_lr: 0.000245  loss: 0.5383 (0.5447)  class_acc: 0.9600 (0.9580)  loss_scale: 8192.0000 (6772.5941)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.1070 (7.0625)  time: 0.6587  data: 0.0001  max mem: 11436
Epoch: [12]  [110/164]  eta: 0:00:35  lr: 0.000242  min_lr: 0.000242  loss: 0.5447 (0.5459)  class_acc: 0.9550 (0.9572)  loss_scale: 8192.0000 (6900.4685)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.9563 (6.9603)  time: 0.6588  data: 0.0001  max mem: 11436
Epoch: [12]  [120/164]  eta: 0:00:29  lr: 0.000238  min_lr: 0.000238  loss: 0.5397 (0.5455)  class_acc: 0.9550 (0.9572)  loss_scale: 8192.0000 (7007.2066)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.4855 (6.8377)  time: 0.6588  data: 0.0002  max mem: 11436
Epoch: [12]  [130/164]  eta: 0:00:22  lr: 0.000235  min_lr: 0.000235  loss: 0.5440 (0.5459)  class_acc: 0.9550 (0.9572)  loss_scale: 8192.0000 (7097.6489)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.3272 (6.7491)  time: 0.6591  data: 0.0002  max mem: 11436
Epoch: [12]  [140/164]  eta: 0:00:15  lr: 0.000232  min_lr: 0.000232  loss: 0.5424 (0.5453)  class_acc: 0.9600 (0.9574)  loss_scale: 8192.0000 (7175.2624)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.4733 (6.7180)  time: 0.6595  data: 0.0001  max mem: 11436
Epoch: [12]  [150/164]  eta: 0:00:09  lr: 0.000229  min_lr: 0.000229  loss: 0.5331 (0.5443)  class_acc: 0.9600 (0.9575)  loss_scale: 8192.0000 (7242.5960)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.1766 (6.6321)  time: 0.6579  data: 0.0004  max mem: 11436
Epoch: [12]  [160/164]  eta: 0:00:02  lr: 0.000226  min_lr: 0.000226  loss: 0.5353 (0.5449)  class_acc: 0.9600 (0.9579)  loss_scale: 8192.0000 (7301.5652)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.5782 (6.6717)  time: 0.6578  data: 0.0003  max mem: 11436
Epoch: [12]  [163/164]  eta: 0:00:00  lr: 0.000225  min_lr: 0.000225  loss: 0.5375 (0.5446)  class_acc: 0.9600 (0.9582)  loss_scale: 8192.0000 (7317.8537)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.2943 (6.6512)  time: 0.6578  data: 0.0001  max mem: 11436
Epoch: [12] Total time: 0:01:48 (0.6645 s / it)
Averaged stats: lr: 0.000225  min_lr: 0.000225  loss: 0.5375 (0.5438)  class_acc: 0.9600 (0.9596)  loss_scale: 8192.0000 (7317.8537)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.2943 (6.6512)
Val:  [ 0/30]  eta: 0:00:38  loss: 1.0590 (1.0590)  n: 300.0000 (300.0000)  accuracy: 0.6900 (0.6900)  balanced_accuracy: 0.5525 (0.5525)  cohen_kappa: 0.4591 (0.4591)  f1_weighted: 0.6446 (0.6446)  time: 1.2770  data: 1.0175  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [10/30]  eta: 0:00:07  loss: 1.0968 (1.1265)  n: 300.0000 (300.0000)  accuracy: 0.6900 (0.6870)  balanced_accuracy: 0.5370 (0.5161)  cohen_kappa: 0.4670 (0.4771)  f1_weighted: 0.6445 (0.6366)  time: 0.3565  data: 0.0927  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [20/30]  eta: 0:00:03  loss: 1.1293 (1.1429)  n: 300.0000 (300.0000)  accuracy: 0.6867 (0.6851)  balanced_accuracy: 0.4941 (0.4951)  cohen_kappa: 0.4670 (0.4758)  f1_weighted: 0.6380 (0.6348)  time: 0.2639  data: 0.0001  max mem: 11436
Val:  [29/30]  eta: 0:00:00  loss: 1.1579 (1.1396)  n: 300.0000 (299.4333)  accuracy: 0.6800 (0.6828)  balanced_accuracy: 0.4893 (0.4962)  cohen_kappa: 0.4646 (0.4721)  f1_weighted: 0.6282 (0.6330)  time: 0.2632  data: 0.0001  max mem: 11436
Val: Total time: 0:00:09 (0.3006 s / it)
* loss 1.106
{'accuracy': 0.68284537459646, 'balanced_accuracy': 0.48565037828493934, 'cohen_kappa': 0.47281217574197076, 'f1_weighted': 0.6328786539552888, 'loss': 1.1062585145235062, 'precision': 0.5761206130636919, 'sensitivity': 0.48565037828493934, 'f1': 0.47066192370188037, 'specificity': 0.9073360938958214}
Accuracy of the network on the 17965 val EEG: 0.68%
Test:  [ 0/48]  eta: 0:01:23  loss: 0.7182 (0.7182)  n: 300.0000 (300.0000)  accuracy: 0.7933 (0.7933)  balanced_accuracy: 0.5064 (0.5064)  cohen_kappa: 0.5348 (0.5348)  f1_weighted: 0.7693 (0.7693)  time: 1.7334  data: 1.4800  max mem: 11436
Test:  [10/48]  eta: 0:00:15  loss: 0.6901 (0.6958)  n: 300.0000 (300.0000)  accuracy: 0.8000 (0.8094)  balanced_accuracy: 0.5110 (0.5095)  cohen_kappa: 0.5592 (0.5737)  f1_weighted: 0.7800 (0.7887)  time: 0.3970  data: 0.1347  max mem: 11436
Test:  [20/48]  eta: 0:00:09  loss: 0.6901 (0.7136)  n: 300.0000 (300.0000)  accuracy: 0.8033 (0.8048)  balanced_accuracy: 0.5019 (0.5006)  cohen_kappa: 0.5582 (0.5662)  f1_weighted: 0.7800 (0.7839)  time: 0.2642  data: 0.0002  max mem: 11436
Test:  [30/48]  eta: 0:00:05  loss: 0.7721 (0.7352)  n: 300.0000 (300.0000)  accuracy: 0.7833 (0.7989)  balanced_accuracy: 0.5015 (0.5017)  cohen_kappa: 0.5334 (0.5586)  f1_weighted: 0.7655 (0.7778)  time: 0.2657  data: 0.0004  max mem: 11436
Test:  [40/48]  eta: 0:00:02  loss: 0.7576 (0.7406)  n: 300.0000 (300.0000)  accuracy: 0.7900 (0.7999)  balanced_accuracy: 0.5212 (0.5059)  cohen_kappa: 0.5559 (0.5613)  f1_weighted: 0.7670 (0.7788)  time: 0.2657  data: 0.0003  max mem: 11436
Test:  [47/48]  eta: 0:00:00  loss: 0.7322 (0.7392)  n: 300.0000 (294.8542)  accuracy: 0.8000 (0.8010)  balanced_accuracy: 0.5260 (0.5072)  cohen_kappa: 0.5585 (0.5623)  f1_weighted: 0.7744 (0.7799)  time: 0.2542  data: 0.0001  max mem: 11436
Test: Total time: 0:00:14 (0.2930 s / it)
* loss 0.733
{'accuracy': 0.8010315834098778, 'balanced_accuracy': 0.5084376203974951, 'cohen_kappa': 0.5622536788871635, 'f1_weighted': 0.7803693230866273, 'loss': 0.7330087429533402, 'precision': 0.6136869992102504, 'sensitivity': 0.5084376203974951, 'f1': 0.5307991504607547, 'specificity': 0.9310521389340769}
Accuracy of the network on the 28305 test EEG: 0.80%
Max accuracy val: 0.68%, max accuracy test: 0.80%
Epoch: [13]  [  0/164]  eta: 0:04:05  lr: 0.000224  min_lr: 0.000224  loss: 0.5645 (0.5645)  class_acc: 0.9500 (0.9500)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 8.6703 (8.6703)  time: 1.4987  data: 0.9035  max mem: 11436
Epoch: [13]  [ 10/164]  eta: 0:01:53  lr: 0.000221  min_lr: 0.000221  loss: 0.5308 (0.5305)  class_acc: 0.9700 (0.9664)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.4513 (7.2660)  time: 0.7340  data: 0.0826  max mem: 11436
Epoch: [13]  [ 20/164]  eta: 0:01:40  lr: 0.000218  min_lr: 0.000218  loss: 0.5308 (0.5314)  class_acc: 0.9650 (0.9643)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.7778 (6.7581)  time: 0.6587  data: 0.0005  max mem: 11436
Epoch: [13]  [ 30/164]  eta: 0:01:31  lr: 0.000215  min_lr: 0.000215  loss: 0.5272 (0.5307)  class_acc: 0.9650 (0.9648)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.0132 (6.3112)  time: 0.6595  data: 0.0003  max mem: 11436
Epoch: [13]  [ 40/164]  eta: 0:01:24  lr: 0.000212  min_lr: 0.000212  loss: 0.5283 (0.5336)  class_acc: 0.9650 (0.9632)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.2366 (6.1810)  time: 0.6585  data: 0.0003  max mem: 11436
Epoch: [13]  [ 50/164]  eta: 0:01:16  lr: 0.000209  min_lr: 0.000209  loss: 0.5396 (0.5349)  class_acc: 0.9600 (0.9622)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.1921 (6.0952)  time: 0.6579  data: 0.0003  max mem: 11436
Epoch: [13]  [ 60/164]  eta: 0:01:09  lr: 0.000206  min_lr: 0.000206  loss: 0.5355 (0.5367)  class_acc: 0.9600 (0.9618)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.0526 (6.4464)  time: 0.6588  data: 0.0003  max mem: 11436
Epoch: [13]  [ 70/164]  eta: 0:01:03  lr: 0.000202  min_lr: 0.000202  loss: 0.5458 (0.5379)  class_acc: 0.9600 (0.9623)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 7.2896 (6.6026)  time: 0.6601  data: 0.0003  max mem: 11436
Epoch: [13]  [ 80/164]  eta: 0:00:56  lr: 0.000199  min_lr: 0.000199  loss: 0.5297 (0.5367)  class_acc: 0.9700 (0.9626)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.9157 (6.4904)  time: 0.6587  data: 0.0001  max mem: 11436
Epoch: [13]  [ 90/164]  eta: 0:00:49  lr: 0.000196  min_lr: 0.000196  loss: 0.5291 (0.5366)  class_acc: 0.9650 (0.9625)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.5014 (6.4264)  time: 0.6583  data: 0.0001  max mem: 11436
Epoch: [13]  [100/164]  eta: 0:00:42  lr: 0.000193  min_lr: 0.000193  loss: 0.5291 (0.5352)  class_acc: 0.9650 (0.9631)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.2948 (6.3167)  time: 0.6593  data: 0.0001  max mem: 11436
Epoch: [13]  [110/164]  eta: 0:00:35  lr: 0.000190  min_lr: 0.000190  loss: 0.5188 (0.5349)  class_acc: 0.9650 (0.9631)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.3593 (6.3203)  time: 0.6594  data: 0.0001  max mem: 11436
Epoch: [13]  [120/164]  eta: 0:00:29  lr: 0.000187  min_lr: 0.000187  loss: 0.5294 (0.5353)  class_acc: 0.9600 (0.9629)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.1193 (6.3188)  time: 0.6589  data: 0.0003  max mem: 11436
Epoch: [13]  [130/164]  eta: 0:00:22  lr: 0.000184  min_lr: 0.000184  loss: 0.5396 (0.5361)  class_acc: 0.9650 (0.9628)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.1767 (6.3423)  time: 0.6592  data: 0.0008  max mem: 11436
Epoch: [13]  [140/164]  eta: 0:00:15  lr: 0.000181  min_lr: 0.000181  loss: 0.5445 (0.5372)  class_acc: 0.9600 (0.9621)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.1064 (6.3922)  time: 0.6598  data: 0.0006  max mem: 11436
Epoch: [13]  [150/164]  eta: 0:00:09  lr: 0.000178  min_lr: 0.000178  loss: 0.5372 (0.5370)  class_acc: 0.9600 (0.9624)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.8644 (6.3647)  time: 0.6581  data: 0.0001  max mem: 11436
Epoch: [13]  [160/164]  eta: 0:00:02  lr: 0.000175  min_lr: 0.000175  loss: 0.5190 (0.5357)  class_acc: 0.9700 (0.9630)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.9877 (6.3326)  time: 0.6585  data: 0.0001  max mem: 11436
Epoch: [13]  [163/164]  eta: 0:00:00  lr: 0.000174  min_lr: 0.000174  loss: 0.5128 (0.5353)  class_acc: 0.9700 (0.9631)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.9877 (6.3396)  time: 0.6583  data: 0.0001  max mem: 11436
Epoch: [13] Total time: 0:01:49 (0.6647 s / it)
Averaged stats: lr: 0.000174  min_lr: 0.000174  loss: 0.5128 (0.5357)  class_acc: 0.9700 (0.9630)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.9877 (6.3396)
Val:  [ 0/30]  eta: 0:00:39  loss: 1.0790 (1.0790)  n: 300.0000 (300.0000)  accuracy: 0.6700 (0.6700)  balanced_accuracy: 0.5481 (0.5481)  cohen_kappa: 0.4400 (0.4400)  f1_weighted: 0.6326 (0.6326)  time: 1.3066  data: 1.0528  max mem: 11436
Val:  [10/30]  eta: 0:00:07  loss: 1.1086 (1.1250)  n: 300.0000 (300.0000)  accuracy: 0.6800 (0.6891)  balanced_accuracy: 0.5270 (0.5011)  cohen_kappa: 0.4845 (0.4904)  f1_weighted: 0.6338 (0.6439)  time: 0.3582  data: 0.0959  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [20/30]  eta: 0:00:03  loss: 1.1410 (1.1412)  n: 300.0000 (300.0000)  accuracy: 0.6800 (0.6867)  balanced_accuracy: 0.4961 (0.4979)  cohen_kappa: 0.4817 (0.4895)  f1_weighted: 0.6338 (0.6412)  time: 0.2643  data: 0.0001  max mem: 11436
Val:  [29/30]  eta: 0:00:00  loss: 1.1534 (1.1389)  n: 300.0000 (299.4333)  accuracy: 0.6767 (0.6838)  balanced_accuracy: 0.4809 (0.4937)  cohen_kappa: 0.4712 (0.4852)  f1_weighted: 0.6336 (0.6384)  time: 0.2642  data: 0.0001  max mem: 11436
Val: Total time: 0:00:09 (0.3020 s / it)
* loss 1.108
{'accuracy': 0.6838472670600022, 'balanced_accuracy': 0.4848963648840406, 'cohen_kappa': 0.4857323842258249, 'f1_weighted': 0.6388263316622778, 'loss': 1.1080059667428335, 'precision': 0.5581590124481359, 'sensitivity': 0.4848963648840406, 'f1': 0.4691548917688007, 'specificity': 0.9110796790581012}
Accuracy of the network on the 17965 val EEG: 0.68%
Test:  [ 0/48]  eta: 0:01:06  loss: 0.7395 (0.7395)  n: 300.0000 (300.0000)  accuracy: 0.7900 (0.7900)  balanced_accuracy: 0.5236 (0.5236)  cohen_kappa: 0.5466 (0.5466)  f1_weighted: 0.7805 (0.7805)  time: 1.3783  data: 1.1235  max mem: 11436
Test:  [10/48]  eta: 0:00:13  loss: 0.7395 (0.7353)  n: 300.0000 (300.0000)  accuracy: 0.7900 (0.7939)  balanced_accuracy: 0.5236 (0.5213)  cohen_kappa: 0.5493 (0.5573)  f1_weighted: 0.7805 (0.7839)  time: 0.3643  data: 0.1023  max mem: 11436
Test:  [20/48]  eta: 0:00:08  loss: 0.7440 (0.7548)  n: 300.0000 (300.0000)  accuracy: 0.7900 (0.7875)  balanced_accuracy: 0.5076 (0.5108)  cohen_kappa: 0.5493 (0.5473)  f1_weighted: 0.7805 (0.7776)  time: 0.2642  data: 0.0002  max mem: 11436
Test:  [30/48]  eta: 0:00:05  loss: 0.7782 (0.7704)  n: 300.0000 (300.0000)  accuracy: 0.7800 (0.7842)  balanced_accuracy: 0.5022 (0.5141)  cohen_kappa: 0.5285 (0.5445)  f1_weighted: 0.7633 (0.7733)  time: 0.2655  data: 0.0002  max mem: 11436
Test:  [40/48]  eta: 0:00:02  loss: 0.7893 (0.7736)  n: 300.0000 (300.0000)  accuracy: 0.7800 (0.7852)  balanced_accuracy: 0.5218 (0.5165)  cohen_kappa: 0.5390 (0.5470)  f1_weighted: 0.7669 (0.7742)  time: 0.2651  data: 0.0001  max mem: 11436
Test:  [47/48]  eta: 0:00:00  loss: 0.7723 (0.7740)  n: 300.0000 (294.8542)  accuracy: 0.7933 (0.7870)  balanced_accuracy: 0.5218 (0.5180)  cohen_kappa: 0.5595 (0.5494)  f1_weighted: 0.7844 (0.7760)  time: 0.2542  data: 0.0001  max mem: 11436
Test: Total time: 0:00:13 (0.2855 s / it)
* loss 0.768
{'accuracy': 0.7870416166183848, 'balanced_accuracy': 0.5205291809506934, 'cohen_kappa': 0.5496513655235233, 'f1_weighted': 0.776345973696278, 'loss': 0.7682389008502165, 'precision': 0.615465310087959, 'sensitivity': 0.5205291809506934, 'f1': 0.5405398820026149, 'specificity': 0.9327369282945114}
Accuracy of the network on the 28305 test EEG: 0.79%
Max accuracy val: 0.68%, max accuracy test: 0.79%
Epoch: [14]  [  0/164]  eta: 0:04:09  lr: 0.000173  min_lr: 0.000173  loss: 0.5530 (0.5530)  class_acc: 0.9650 (0.9650)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.3043 (5.3043)  time: 1.5237  data: 0.9313  max mem: 11436
Epoch: [14]  [ 10/164]  eta: 0:01:53  lr: 0.000170  min_lr: 0.000170  loss: 0.5460 (0.5405)  class_acc: 0.9600 (0.9632)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.8444 (6.4771)  time: 0.7352  data: 0.0848  max mem: 11436
Epoch: [14]  [ 20/164]  eta: 0:01:40  lr: 0.000167  min_lr: 0.000167  loss: 0.5274 (0.5370)  class_acc: 0.9600 (0.9657)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.8444 (6.3181)  time: 0.6578  data: 0.0001  max mem: 11436
Epoch: [14]  [ 30/164]  eta: 0:01:31  lr: 0.000164  min_lr: 0.000164  loss: 0.5197 (0.5307)  class_acc: 0.9700 (0.9682)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.0275 (5.8676)  time: 0.6594  data: 0.0001  max mem: 11436
Epoch: [14]  [ 40/164]  eta: 0:01:24  lr: 0.000161  min_lr: 0.000161  loss: 0.5176 (0.5315)  class_acc: 0.9700 (0.9672)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.0418 (5.7422)  time: 0.6596  data: 0.0002  max mem: 11436
Epoch: [14]  [ 50/164]  eta: 0:01:17  lr: 0.000158  min_lr: 0.000158  loss: 0.5176 (0.5294)  class_acc: 0.9650 (0.9676)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.0418 (5.6155)  time: 0.6593  data: 0.0003  max mem: 11436
Epoch: [14]  [ 60/164]  eta: 0:01:09  lr: 0.000155  min_lr: 0.000155  loss: 0.5194 (0.5298)  class_acc: 0.9650 (0.9666)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.8242 (5.5376)  time: 0.6592  data: 0.0001  max mem: 11436
Epoch: [14]  [ 70/164]  eta: 0:01:03  lr: 0.000153  min_lr: 0.000153  loss: 0.5182 (0.5295)  class_acc: 0.9650 (0.9668)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.9485 (5.5026)  time: 0.6591  data: 0.0001  max mem: 11436
Epoch: [14]  [ 80/164]  eta: 0:00:56  lr: 0.000150  min_lr: 0.000150  loss: 0.5221 (0.5303)  class_acc: 0.9650 (0.9660)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.7236 (5.4461)  time: 0.6577  data: 0.0002  max mem: 11436
Epoch: [14]  [ 90/164]  eta: 0:00:49  lr: 0.000147  min_lr: 0.000147  loss: 0.5203 (0.5279)  class_acc: 0.9650 (0.9670)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.5788 (5.3226)  time: 0.6569  data: 0.0002  max mem: 11436
Epoch: [14]  [100/164]  eta: 0:00:42  lr: 0.000144  min_lr: 0.000144  loss: 0.5129 (0.5277)  class_acc: 0.9750 (0.9675)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.3229 (5.2578)  time: 0.6574  data: 0.0002  max mem: 11436
Epoch: [14]  [110/164]  eta: 0:00:35  lr: 0.000141  min_lr: 0.000141  loss: 0.5169 (0.5277)  class_acc: 0.9700 (0.9674)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.8092 (5.2328)  time: 0.6579  data: 0.0001  max mem: 11436
Epoch: [14]  [120/164]  eta: 0:00:29  lr: 0.000138  min_lr: 0.000138  loss: 0.5267 (0.5278)  class_acc: 0.9650 (0.9670)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.6268 (5.2188)  time: 0.6580  data: 0.0001  max mem: 11436
Epoch: [14]  [130/164]  eta: 0:00:22  lr: 0.000135  min_lr: 0.000135  loss: 0.5172 (0.5271)  class_acc: 0.9700 (0.9671)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.5253 (5.1711)  time: 0.6584  data: 0.0003  max mem: 11436
Epoch: [14]  [140/164]  eta: 0:00:15  lr: 0.000132  min_lr: 0.000132  loss: 0.5087 (0.5264)  class_acc: 0.9700 (0.9672)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.3621 (5.1290)  time: 0.6585  data: 0.0003  max mem: 11436
Epoch: [14]  [150/164]  eta: 0:00:09  lr: 0.000130  min_lr: 0.000130  loss: 0.5217 (0.5272)  class_acc: 0.9650 (0.9669)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.8505 (5.1839)  time: 0.6576  data: 0.0001  max mem: 11436
Epoch: [14]  [160/164]  eta: 0:00:02  lr: 0.000127  min_lr: 0.000127  loss: 0.5273 (0.5264)  class_acc: 0.9700 (0.9673)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.1380 (5.2067)  time: 0.6580  data: 0.0001  max mem: 11436
Epoch: [14]  [163/164]  eta: 0:00:00  lr: 0.000126  min_lr: 0.000126  loss: 0.5232 (0.5264)  class_acc: 0.9700 (0.9673)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.0888 (5.2131)  time: 0.6577  data: 0.0001  max mem: 11436
Epoch: [14] Total time: 0:01:48 (0.6644 s / it)
Averaged stats: lr: 0.000126  min_lr: 0.000126  loss: 0.5232 (0.5255)  class_acc: 0.9700 (0.9672)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.0888 (5.2131)
Val:  [ 0/30]  eta: 0:00:40  loss: 1.0835 (1.0835)  n: 300.0000 (300.0000)  accuracy: 0.6700 (0.6700)  balanced_accuracy: 0.5405 (0.5405)  cohen_kappa: 0.4388 (0.4388)  f1_weighted: 0.6294 (0.6294)  time: 1.3450  data: 1.0863  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [10/30]  eta: 0:00:07  loss: 1.1218 (1.1432)  n: 300.0000 (300.0000)  accuracy: 0.6667 (0.6667)  balanced_accuracy: 0.5405 (0.5264)  cohen_kappa: 0.4530 (0.4580)  f1_weighted: 0.6294 (0.6248)  time: 0.3621  data: 0.0989  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [20/30]  eta: 0:00:03  loss: 1.1624 (1.1558)  n: 300.0000 (300.0000)  accuracy: 0.6567 (0.6603)  balanced_accuracy: 0.5082 (0.5140)  cohen_kappa: 0.4390 (0.4506)  f1_weighted: 0.6113 (0.6178)  time: 0.2643  data: 0.0001  max mem: 11436
Val:  [29/30]  eta: 0:00:00  loss: 1.1624 (1.1541)  n: 300.0000 (299.4333)  accuracy: 0.6500 (0.6587)  balanced_accuracy: 0.5153 (0.5197)  cohen_kappa: 0.4396 (0.4474)  f1_weighted: 0.6093 (0.6162)  time: 0.2637  data: 0.0001  max mem: 11436
Val: Total time: 0:00:09 (0.3041 s / it)
* loss 1.127
{'accuracy': 0.658688634086608, 'balanced_accuracy': 0.5126626367029447, 'cohen_kappa': 0.4482872470257019, 'f1_weighted': 0.6159108894046148, 'loss': 1.1271504431962966, 'precision': 0.519697374069197, 'sensitivity': 0.5126626367029447, 'f1': 0.4576731923028537, 'specificity': 0.905671586956308}
Accuracy of the network on the 17965 val EEG: 0.66%
Test:  [ 0/48]  eta: 0:01:22  loss: 0.7065 (0.7065)  n: 300.0000 (300.0000)  accuracy: 0.8067 (0.8067)  balanced_accuracy: 0.6123 (0.6123)  cohen_kappa: 0.5900 (0.5900)  f1_weighted: 0.8045 (0.8045)  time: 1.7217  data: 1.4624  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [10/48]  eta: 0:00:15  loss: 0.7143 (0.7131)  n: 300.0000 (300.0000)  accuracy: 0.7933 (0.7973)  balanced_accuracy: 0.5599 (0.5468)  cohen_kappa: 0.5546 (0.5676)  f1_weighted: 0.7870 (0.7917)  time: 0.3952  data: 0.1331  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [20/48]  eta: 0:00:09  loss: 0.7332 (0.7306)  n: 300.0000 (300.0000)  accuracy: 0.7900 (0.7906)  balanced_accuracy: 0.5590 (0.5372)  cohen_kappa: 0.5478 (0.5560)  f1_weighted: 0.7831 (0.7846)  time: 0.2634  data: 0.0002  max mem: 11436
Test:  [30/48]  eta: 0:00:05  loss: 0.7746 (0.7482)  n: 300.0000 (300.0000)  accuracy: 0.7700 (0.7858)  balanced_accuracy: 0.5296 (0.5370)  cohen_kappa: 0.5362 (0.5514)  f1_weighted: 0.7686 (0.7797)  time: 0.2642  data: 0.0002  max mem: 11436
Test:  [40/48]  eta: 0:00:02  loss: 0.7552 (0.7519)  n: 300.0000 (300.0000)  accuracy: 0.7700 (0.7863)  balanced_accuracy: 0.5304 (0.5355)  cohen_kappa: 0.5393 (0.5530)  f1_weighted: 0.7686 (0.7802)  time: 0.2648  data: 0.0001  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [47/48]  eta: 0:00:00  loss: 0.7533 (0.7514)  n: 300.0000 (294.8542)  accuracy: 0.7833 (0.7878)  balanced_accuracy: 0.5309 (0.5349)  cohen_kappa: 0.5478 (0.5548)  f1_weighted: 0.7782 (0.7816)  time: 0.2538  data: 0.0001  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test: Total time: 0:00:14 (0.2922 s / it)
* loss 0.745
{'accuracy': 0.78781883699569, 'balanced_accuracy': 0.5377795138585588, 'cohen_kappa': 0.5549346647667253, 'f1_weighted': 0.7817610680698645, 'loss': 0.7445075015227, 'precision': 0.5894668409824826, 'sensitivity': 0.5377795138585588, 'f1': 0.5451454416502617, 'specificity': 0.935117408182649}
Accuracy of the network on the 28305 test EEG: 0.79%
Max accuracy val: 0.68%, max accuracy test: 0.79%
Epoch: [15]  [  0/164]  eta: 0:04:36  lr: 0.000126  min_lr: 0.000126  loss: 0.5371 (0.5371)  class_acc: 0.9650 (0.9650)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.8133 (4.8133)  time: 1.6889  data: 1.0054  max mem: 11436
Epoch: [15]  [ 10/164]  eta: 0:01:55  lr: 0.000123  min_lr: 0.000123  loss: 0.5178 (0.5204)  class_acc: 0.9650 (0.9673)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.2046 (5.4816)  time: 0.7503  data: 0.0920  max mem: 11436
Epoch: [15]  [ 20/164]  eta: 0:01:41  lr: 0.000120  min_lr: 0.000120  loss: 0.5091 (0.5222)  class_acc: 0.9750 (0.9681)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.2046 (5.3641)  time: 0.6577  data: 0.0006  max mem: 11436
Epoch: [15]  [ 30/164]  eta: 0:01:32  lr: 0.000118  min_lr: 0.000118  loss: 0.5108 (0.5206)  class_acc: 0.9750 (0.9689)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.6699 (5.1457)  time: 0.6592  data: 0.0003  max mem: 11436
Epoch: [15]  [ 40/164]  eta: 0:01:24  lr: 0.000115  min_lr: 0.000115  loss: 0.5123 (0.5197)  class_acc: 0.9750 (0.9709)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.3344 (4.9350)  time: 0.6588  data: 0.0001  max mem: 11436
Epoch: [15]  [ 50/164]  eta: 0:01:17  lr: 0.000112  min_lr: 0.000112  loss: 0.5116 (0.5185)  class_acc: 0.9750 (0.9707)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.3076 (4.8121)  time: 0.6591  data: 0.0002  max mem: 11436
Epoch: [15]  [ 60/164]  eta: 0:01:10  lr: 0.000110  min_lr: 0.000110  loss: 0.5088 (0.5171)  class_acc: 0.9700 (0.9708)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.4915 (4.8067)  time: 0.6596  data: 0.0002  max mem: 11436
Epoch: [15]  [ 70/164]  eta: 0:01:03  lr: 0.000107  min_lr: 0.000107  loss: 0.5227 (0.5198)  class_acc: 0.9650 (0.9697)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.4987 (4.7681)  time: 0.6597  data: 0.0001  max mem: 11436
Epoch: [15]  [ 80/164]  eta: 0:00:56  lr: 0.000104  min_lr: 0.000104  loss: 0.5187 (0.5186)  class_acc: 0.9700 (0.9702)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.4215 (4.7514)  time: 0.6589  data: 0.0003  max mem: 11436
Epoch: [15]  [ 90/164]  eta: 0:00:49  lr: 0.000102  min_lr: 0.000102  loss: 0.5096 (0.5176)  class_acc: 0.9750 (0.9706)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.4325 (4.7556)  time: 0.6593  data: 0.0005  max mem: 11436
Epoch: [15]  [100/164]  eta: 0:00:42  lr: 0.000099  min_lr: 0.000099  loss: 0.5112 (0.5179)  class_acc: 0.9700 (0.9705)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.8310 (4.8378)  time: 0.6601  data: 0.0004  max mem: 11436
Epoch: [15]  [110/164]  eta: 0:00:36  lr: 0.000097  min_lr: 0.000097  loss: 0.5112 (0.5173)  class_acc: 0.9700 (0.9708)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.0421 (4.8620)  time: 0.6589  data: 0.0003  max mem: 11436
Epoch: [15]  [120/164]  eta: 0:00:29  lr: 0.000094  min_lr: 0.000094  loss: 0.5152 (0.5185)  class_acc: 0.9700 (0.9699)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 5.2069 (4.9018)  time: 0.6587  data: 0.0001  max mem: 11436
Epoch: [15]  [130/164]  eta: 0:00:22  lr: 0.000092  min_lr: 0.000092  loss: 0.5152 (0.5180)  class_acc: 0.9650 (0.9702)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.9360 (4.9182)  time: 0.6599  data: 0.0001  max mem: 11436
Epoch: [15]  [140/164]  eta: 0:00:15  lr: 0.000089  min_lr: 0.000089  loss: 0.5177 (0.5191)  class_acc: 0.9650 (0.9695)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.5699 (4.9018)  time: 0.6611  data: 0.0003  max mem: 11436
Epoch: [15]  [150/164]  eta: 0:00:09  lr: 0.000087  min_lr: 0.000087  loss: 0.5177 (0.5179)  class_acc: 0.9700 (0.9701)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.2229 (4.8688)  time: 0.6593  data: 0.0004  max mem: 11436
Epoch: [15]  [160/164]  eta: 0:00:02  lr: 0.000085  min_lr: 0.000085  loss: 0.5048 (0.5176)  class_acc: 0.9750 (0.9703)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.2229 (4.8478)  time: 0.6583  data: 0.0003  max mem: 11436
Epoch: [15]  [163/164]  eta: 0:00:00  lr: 0.000084  min_lr: 0.000084  loss: 0.5068 (0.5178)  class_acc: 0.9700 (0.9703)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.2229 (4.8441)  time: 0.6596  data: 0.0001  max mem: 11436
Epoch: [15] Total time: 0:01:49 (0.6663 s / it)
Averaged stats: lr: 0.000084  min_lr: 0.000084  loss: 0.5068 (0.5179)  class_acc: 0.9700 (0.9704)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.2229 (4.8441)
Val:  [ 0/30]  eta: 0:00:42  loss: 1.0792 (1.0792)  n: 300.0000 (300.0000)  accuracy: 0.6867 (0.6867)  balanced_accuracy: 0.5545 (0.5545)  cohen_kappa: 0.4657 (0.4657)  f1_weighted: 0.6512 (0.6512)  time: 1.4011  data: 1.1452  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [10/30]  eta: 0:00:07  loss: 1.1218 (1.1317)  n: 300.0000 (300.0000)  accuracy: 0.6867 (0.6879)  balanced_accuracy: 0.5253 (0.5247)  cohen_kappa: 0.4911 (0.4879)  f1_weighted: 0.6491 (0.6459)  time: 0.3663  data: 0.1043  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [20/30]  eta: 0:00:03  loss: 1.1399 (1.1459)  n: 300.0000 (300.0000)  accuracy: 0.6833 (0.6830)  balanced_accuracy: 0.5176 (0.5177)  cohen_kappa: 0.4781 (0.4825)  f1_weighted: 0.6432 (0.6409)  time: 0.2643  data: 0.0001  max mem: 11436
Val:  [29/30]  eta: 0:00:00  loss: 1.1585 (1.1439)  n: 300.0000 (299.4333)  accuracy: 0.6667 (0.6802)  balanced_accuracy: 0.5176 (0.5150)  cohen_kappa: 0.4627 (0.4776)  f1_weighted: 0.6293 (0.6384)  time: 0.2643  data: 0.0001  max mem: 11436
Val: Total time: 0:00:09 (0.3049 s / it)
* loss 1.113
{'accuracy': 0.6801736613603473, 'balanced_accuracy': 0.5118307816185196, 'cohen_kappa': 0.478563132668659, 'f1_weighted': 0.6381088441522608, 'loss': 1.1131932586431503, 'precision': 0.5483991013700076, 'sensitivity': 0.5118307816185196, 'f1': 0.4851295701990967, 'specificity': 0.909437771545296}
Accuracy of the network on the 17965 val EEG: 0.68%
Test:  [ 0/48]  eta: 0:01:07  loss: 0.7192 (0.7192)  n: 300.0000 (300.0000)  accuracy: 0.7967 (0.7967)  balanced_accuracy: 0.5291 (0.5291)  cohen_kappa: 0.5601 (0.5601)  f1_weighted: 0.7880 (0.7880)  time: 1.4078  data: 1.1518  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [10/48]  eta: 0:00:13  loss: 0.7154 (0.7175)  n: 300.0000 (300.0000)  accuracy: 0.8000 (0.7997)  balanced_accuracy: 0.5319 (0.5333)  cohen_kappa: 0.5649 (0.5675)  f1_weighted: 0.7875 (0.7891)  time: 0.3672  data: 0.1048  max mem: 11436
Test:  [20/48]  eta: 0:00:08  loss: 0.7154 (0.7372)  n: 300.0000 (300.0000)  accuracy: 0.7967 (0.7919)  balanced_accuracy: 0.5236 (0.5197)  cohen_kappa: 0.5550 (0.5545)  f1_weighted: 0.7838 (0.7812)  time: 0.2639  data: 0.0002  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [30/48]  eta: 0:00:05  loss: 0.7720 (0.7559)  n: 300.0000 (300.0000)  accuracy: 0.7800 (0.7886)  balanced_accuracy: 0.5313 (0.5241)  cohen_kappa: 0.5372 (0.5531)  f1_weighted: 0.7773 (0.7778)  time: 0.2648  data: 0.0002  max mem: 11436
Test:  [40/48]  eta: 0:00:02  loss: 0.7636 (0.7594)  n: 300.0000 (300.0000)  accuracy: 0.7800 (0.7898)  balanced_accuracy: 0.5325 (0.5256)  cohen_kappa: 0.5501 (0.5561)  f1_weighted: 0.7746 (0.7789)  time: 0.2645  data: 0.0001  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [47/48]  eta: 0:00:00  loss: 0.7634 (0.7582)  n: 300.0000 (294.8542)  accuracy: 0.7933 (0.7909)  balanced_accuracy: 0.5316 (0.5258)  cohen_kappa: 0.5562 (0.5571)  f1_weighted: 0.7764 (0.7800)  time: 0.2538  data: 0.0001  max mem: 11436
Test: Total time: 0:00:13 (0.2858 s / it)
* loss 0.752
{'accuracy': 0.7909277185049106, 'balanced_accuracy': 0.5298151398779846, 'cohen_kappa': 0.5572677183583559, 'f1_weighted': 0.7802620351244199, 'loss': 0.7517814909418424, 'precision': 0.5848780097445232, 'sensitivity': 0.5298151398779846, 'f1': 0.5350964776013084, 'specificity': 0.9342003280183064}
Accuracy of the network on the 28305 test EEG: 0.79%
Max accuracy val: 0.68%, max accuracy test: 0.79%
Epoch: [16]  [  0/164]  eta: 0:04:35  lr: 0.000084  min_lr: 0.000084  loss: 0.5125 (0.5125)  class_acc: 0.9700 (0.9700)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 6.3102 (6.3102)  time: 1.6820  data: 1.0156  max mem: 11436
Epoch: [16]  [ 10/164]  eta: 0:01:55  lr: 0.000081  min_lr: 0.000081  loss: 0.5125 (0.5191)  class_acc: 0.9700 (0.9691)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.7009 (4.6577)  time: 0.7501  data: 0.0924  max mem: 11436
Epoch: [16]  [ 20/164]  eta: 0:01:41  lr: 0.000079  min_lr: 0.000079  loss: 0.5115 (0.5134)  class_acc: 0.9750 (0.9721)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.7009 (4.9457)  time: 0.6585  data: 0.0001  max mem: 11436
Epoch: [16]  [ 30/164]  eta: 0:01:32  lr: 0.000077  min_lr: 0.000077  loss: 0.5084 (0.5119)  class_acc: 0.9750 (0.9726)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.3321 (4.6978)  time: 0.6597  data: 0.0001  max mem: 11436
Epoch: [16]  [ 40/164]  eta: 0:01:24  lr: 0.000074  min_lr: 0.000074  loss: 0.5046 (0.5108)  class_acc: 0.9750 (0.9732)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.0509 (4.5551)  time: 0.6585  data: 0.0001  max mem: 11436
Epoch: [16]  [ 50/164]  eta: 0:01:17  lr: 0.000072  min_lr: 0.000072  loss: 0.5027 (0.5091)  class_acc: 0.9800 (0.9743)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.2811 (4.5981)  time: 0.6581  data: 0.0001  max mem: 11436
Epoch: [16]  [ 60/164]  eta: 0:01:10  lr: 0.000070  min_lr: 0.000070  loss: 0.4998 (0.5081)  class_acc: 0.9750 (0.9744)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.3167 (4.5478)  time: 0.6587  data: 0.0001  max mem: 11436
Epoch: [16]  [ 70/164]  eta: 0:01:03  lr: 0.000068  min_lr: 0.000068  loss: 0.5039 (0.5088)  class_acc: 0.9750 (0.9740)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.1428 (4.5806)  time: 0.6593  data: 0.0002  max mem: 11436
Epoch: [16]  [ 80/164]  eta: 0:00:56  lr: 0.000066  min_lr: 0.000066  loss: 0.5075 (0.5086)  class_acc: 0.9750 (0.9743)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.2657 (4.5934)  time: 0.6592  data: 0.0003  max mem: 11436
Epoch: [16]  [ 90/164]  eta: 0:00:49  lr: 0.000063  min_lr: 0.000063  loss: 0.5114 (0.5098)  class_acc: 0.9750 (0.9737)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.1831 (4.6260)  time: 0.6585  data: 0.0002  max mem: 11436
Epoch: [16]  [100/164]  eta: 0:00:42  lr: 0.000061  min_lr: 0.000061  loss: 0.5076 (0.5095)  class_acc: 0.9700 (0.9738)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.0734 (4.5773)  time: 0.6596  data: 0.0004  max mem: 11436
Epoch: [16]  [110/164]  eta: 0:00:36  lr: 0.000059  min_lr: 0.000059  loss: 0.5103 (0.5093)  class_acc: 0.9750 (0.9739)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.2680 (4.5758)  time: 0.6587  data: 0.0005  max mem: 11436
Epoch: [16]  [120/164]  eta: 0:00:29  lr: 0.000057  min_lr: 0.000057  loss: 0.5133 (0.5097)  class_acc: 0.9700 (0.9736)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.5771 (4.5771)  time: 0.6579  data: 0.0002  max mem: 11436
Epoch: [16]  [130/164]  eta: 0:00:22  lr: 0.000055  min_lr: 0.000055  loss: 0.5106 (0.5104)  class_acc: 0.9650 (0.9734)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.5771 (4.5830)  time: 0.6595  data: 0.0002  max mem: 11436
Epoch: [16]  [140/164]  eta: 0:00:15  lr: 0.000053  min_lr: 0.000053  loss: 0.4981 (0.5097)  class_acc: 0.9750 (0.9737)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.2220 (4.5560)  time: 0.6598  data: 0.0001  max mem: 11436
Epoch: [16]  [150/164]  eta: 0:00:09  lr: 0.000051  min_lr: 0.000051  loss: 0.4977 (0.5096)  class_acc: 0.9750 (0.9738)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.2896 (4.5534)  time: 0.6587  data: 0.0003  max mem: 11436
Epoch: [16]  [160/164]  eta: 0:00:02  lr: 0.000049  min_lr: 0.000049  loss: 0.5218 (0.5102)  class_acc: 0.9700 (0.9735)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.5953 (4.5511)  time: 0.6580  data: 0.0004  max mem: 11436
Epoch: [16]  [163/164]  eta: 0:00:00  lr: 0.000049  min_lr: 0.000049  loss: 0.5219 (0.5102)  class_acc: 0.9700 (0.9735)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.5271 (4.5426)  time: 0.6587  data: 0.0003  max mem: 11436
Epoch: [16] Total time: 0:01:49 (0.6660 s / it)
Averaged stats: lr: 0.000049  min_lr: 0.000049  loss: 0.5219 (0.5109)  class_acc: 0.9700 (0.9732)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.5271 (4.5426)
Val:  [ 0/30]  eta: 0:00:49  loss: 1.0565 (1.0565)  n: 300.0000 (300.0000)  accuracy: 0.6767 (0.6767)  balanced_accuracy: 0.5493 (0.5493)  cohen_kappa: 0.4560 (0.4560)  f1_weighted: 0.6392 (0.6392)  time: 1.6534  data: 1.3942  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [10/30]  eta: 0:00:07  loss: 1.1053 (1.1135)  n: 300.0000 (300.0000)  accuracy: 0.7000 (0.6970)  balanced_accuracy: 0.5608 (0.5532)  cohen_kappa: 0.5129 (0.5108)  f1_weighted: 0.6570 (0.6551)  time: 0.3901  data: 0.1269  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [20/30]  eta: 0:00:03  loss: 1.1155 (1.1271)  n: 300.0000 (300.0000)  accuracy: 0.6967 (0.6927)  balanced_accuracy: 0.5335 (0.5379)  cohen_kappa: 0.5015 (0.5055)  f1_weighted: 0.6532 (0.6499)  time: 0.2641  data: 0.0001  max mem: 11436
Val:  [29/30]  eta: 0:00:00  loss: 1.1385 (1.1240)  n: 300.0000 (299.4333)  accuracy: 0.6833 (0.6897)  balanced_accuracy: 0.5330 (0.5339)  cohen_kappa: 0.4840 (0.5007)  f1_weighted: 0.6423 (0.6476)  time: 0.2632  data: 0.0001  max mem: 11436
Val: Total time: 0:00:09 (0.3131 s / it)
* loss 1.096
{'accuracy': 0.6897473004564176, 'balanced_accuracy': 0.5274150502939261, 'cohen_kappa': 0.5015458167083193, 'f1_weighted': 0.6472021984511864, 'loss': 1.0955977350473405, 'precision': 0.5338406523503547, 'sensitivity': 0.5274150502939261, 'f1': 0.4752950455395797, 'specificity': 0.9144647838121157}
Accuracy of the network on the 17965 val EEG: 0.69%
Test:  [ 0/48]  eta: 0:01:22  loss: 0.7342 (0.7342)  n: 300.0000 (300.0000)  accuracy: 0.8000 (0.8000)  balanced_accuracy: 0.5990 (0.5990)  cohen_kappa: 0.5783 (0.5783)  f1_weighted: 0.7954 (0.7954)  time: 1.7155  data: 1.4616  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [10/48]  eta: 0:00:15  loss: 0.7355 (0.7421)  n: 300.0000 (300.0000)  accuracy: 0.7967 (0.8000)  balanced_accuracy: 0.5669 (0.5523)  cohen_kappa: 0.5728 (0.5777)  f1_weighted: 0.7873 (0.7927)  time: 0.3950  data: 0.1331  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [20/48]  eta: 0:00:09  loss: 0.7447 (0.7593)  n: 300.0000 (300.0000)  accuracy: 0.7933 (0.7935)  balanced_accuracy: 0.5529 (0.5382)  cohen_kappa: 0.5634 (0.5668)  f1_weighted: 0.7845 (0.7857)  time: 0.2642  data: 0.0002  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [30/48]  eta: 0:00:05  loss: 0.8082 (0.7776)  n: 300.0000 (300.0000)  accuracy: 0.7800 (0.7899)  balanced_accuracy: 0.5377 (0.5407)  cohen_kappa: 0.5415 (0.5640)  f1_weighted: 0.7707 (0.7819)  time: 0.2651  data: 0.0002  max mem: 11436
Test:  [40/48]  eta: 0:00:02  loss: 0.8011 (0.7811)  n: 300.0000 (300.0000)  accuracy: 0.7833 (0.7899)  balanced_accuracy: 0.5476 (0.5399)  cohen_kappa: 0.5542 (0.5644)  f1_weighted: 0.7742 (0.7817)  time: 0.2641  data: 0.0001  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [47/48]  eta: 0:00:00  loss: 0.7781 (0.7807)  n: 300.0000 (294.8542)  accuracy: 0.7900 (0.7914)  balanced_accuracy: 0.5333 (0.5399)  cohen_kappa: 0.5666 (0.5662)  f1_weighted: 0.7784 (0.7831)  time: 0.2533  data: 0.0001  max mem: 11436
Test: Total time: 0:00:14 (0.2925 s / it)
* loss 0.774
{'accuracy': 0.7914223132904684, 'balanced_accuracy': 0.5433902041773585, 'cohen_kappa': 0.5664159690417208, 'f1_weighted': 0.7831560793980564, 'loss': 0.7735097495218118, 'precision': 0.5896355707459865, 'sensitivity': 0.5433902041773585, 'f1': 0.5430224032280307, 'specificity': 0.9371649570313884}
Accuracy of the network on the 28305 test EEG: 0.79%
Max accuracy val: 0.69%, max accuracy test: 0.79%
Epoch: [17]  [  0/164]  eta: 0:04:32  lr: 0.000049  min_lr: 0.000049  loss: 0.5114 (0.5114)  class_acc: 0.9600 (0.9600)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.6075 (4.6075)  time: 1.6599  data: 1.0613  max mem: 11436
Epoch: [17]  [ 10/164]  eta: 0:01:55  lr: 0.000047  min_lr: 0.000047  loss: 0.5115 (0.5140)  class_acc: 0.9700 (0.9705)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.6075 (4.9020)  time: 0.7499  data: 0.0967  max mem: 11436
Epoch: [17]  [ 20/164]  eta: 0:01:41  lr: 0.000045  min_lr: 0.000045  loss: 0.5113 (0.5104)  class_acc: 0.9750 (0.9731)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.1850 (4.4805)  time: 0.6586  data: 0.0002  max mem: 11436
Epoch: [17]  [ 30/164]  eta: 0:01:32  lr: 0.000043  min_lr: 0.000043  loss: 0.5019 (0.5079)  class_acc: 0.9750 (0.9747)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.1074 (4.4889)  time: 0.6591  data: 0.0002  max mem: 11436
Epoch: [17]  [ 40/164]  eta: 0:01:24  lr: 0.000041  min_lr: 0.000041  loss: 0.5014 (0.5081)  class_acc: 0.9800 (0.9751)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.1074 (4.3513)  time: 0.6587  data: 0.0002  max mem: 11436
Epoch: [17]  [ 50/164]  eta: 0:01:17  lr: 0.000040  min_lr: 0.000040  loss: 0.5026 (0.5074)  class_acc: 0.9800 (0.9751)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.1429 (4.4433)  time: 0.6583  data: 0.0001  max mem: 11436
Epoch: [17]  [ 60/164]  eta: 0:01:10  lr: 0.000038  min_lr: 0.000038  loss: 0.5053 (0.5071)  class_acc: 0.9750 (0.9748)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.2579 (4.4411)  time: 0.6592  data: 0.0001  max mem: 11436
Epoch: [17]  [ 70/164]  eta: 0:01:03  lr: 0.000036  min_lr: 0.000036  loss: 0.5059 (0.5079)  class_acc: 0.9750 (0.9748)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.1377 (4.4445)  time: 0.6587  data: 0.0001  max mem: 11436
Epoch: [17]  [ 80/164]  eta: 0:00:56  lr: 0.000035  min_lr: 0.000035  loss: 0.5047 (0.5079)  class_acc: 0.9750 (0.9750)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.9105 (4.3773)  time: 0.6593  data: 0.0001  max mem: 11436
Epoch: [17]  [ 90/164]  eta: 0:00:49  lr: 0.000033  min_lr: 0.000033  loss: 0.5034 (0.5079)  class_acc: 0.9750 (0.9748)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.9093 (4.3421)  time: 0.6599  data: 0.0002  max mem: 11436
Epoch: [17]  [100/164]  eta: 0:00:42  lr: 0.000032  min_lr: 0.000032  loss: 0.5116 (0.5081)  class_acc: 0.9700 (0.9745)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.9988 (4.3013)  time: 0.6594  data: 0.0002  max mem: 11436
Epoch: [17]  [110/164]  eta: 0:00:36  lr: 0.000030  min_lr: 0.000030  loss: 0.4968 (0.5074)  class_acc: 0.9750 (0.9749)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.7210 (4.2780)  time: 0.6586  data: 0.0001  max mem: 11436
Epoch: [17]  [120/164]  eta: 0:00:29  lr: 0.000029  min_lr: 0.000029  loss: 0.4923 (0.5071)  class_acc: 0.9800 (0.9748)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.9076 (4.2570)  time: 0.6591  data: 0.0003  max mem: 11436
Epoch: [17]  [130/164]  eta: 0:00:22  lr: 0.000027  min_lr: 0.000027  loss: 0.5059 (0.5067)  class_acc: 0.9750 (0.9748)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.9108 (4.2397)  time: 0.6594  data: 0.0003  max mem: 11436
Epoch: [17]  [140/164]  eta: 0:00:15  lr: 0.000026  min_lr: 0.000026  loss: 0.5017 (0.5061)  class_acc: 0.9750 (0.9750)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.8947 (4.2299)  time: 0.6574  data: 0.0002  max mem: 11436
Epoch: [17]  [150/164]  eta: 0:00:09  lr: 0.000024  min_lr: 0.000024  loss: 0.5046 (0.5059)  class_acc: 0.9750 (0.9751)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.8875 (4.2258)  time: 0.6577  data: 0.0002  max mem: 11436
Epoch: [17]  [160/164]  eta: 0:00:02  lr: 0.000023  min_lr: 0.000023  loss: 0.5045 (0.5057)  class_acc: 0.9750 (0.9750)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.6958 (4.2061)  time: 0.6593  data: 0.0001  max mem: 11436
Epoch: [17]  [163/164]  eta: 0:00:00  lr: 0.000023  min_lr: 0.000023  loss: 0.5045 (0.5061)  class_acc: 0.9750 (0.9747)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.6958 (4.2374)  time: 0.6590  data: 0.0001  max mem: 11436
Epoch: [17] Total time: 0:01:49 (0.6658 s / it)
Averaged stats: lr: 0.000023  min_lr: 0.000023  loss: 0.5045 (0.5072)  class_acc: 0.9750 (0.9738)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.6958 (4.2374)
Val:  [ 0/30]  eta: 0:00:38  loss: 1.0705 (1.0705)  n: 300.0000 (300.0000)  accuracy: 0.6867 (0.6867)  balanced_accuracy: 0.5534 (0.5534)  cohen_kappa: 0.4685 (0.4685)  f1_weighted: 0.6515 (0.6515)  time: 1.2943  data: 1.0378  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [10/30]  eta: 0:00:07  loss: 1.1046 (1.1283)  n: 300.0000 (300.0000)  accuracy: 0.6867 (0.6845)  balanced_accuracy: 0.5545 (0.5460)  cohen_kappa: 0.4888 (0.4860)  f1_weighted: 0.6515 (0.6420)  time: 0.3566  data: 0.0945  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [20/30]  eta: 0:00:03  loss: 1.1475 (1.1405)  n: 300.0000 (300.0000)  accuracy: 0.6800 (0.6792)  balanced_accuracy: 0.5230 (0.5313)  cohen_kappa: 0.4839 (0.4801)  f1_weighted: 0.6420 (0.6370)  time: 0.2640  data: 0.0001  max mem: 11436
Val:  [29/30]  eta: 0:00:00  loss: 1.1475 (1.1373)  n: 300.0000 (299.4333)  accuracy: 0.6733 (0.6763)  balanced_accuracy: 0.5177 (0.5253)  cohen_kappa: 0.4694 (0.4751)  f1_weighted: 0.6287 (0.6343)  time: 0.2637  data: 0.0001  max mem: 11436
Val: Total time: 0:00:09 (0.3015 s / it)
* loss 1.109
{'accuracy': 0.6762774128910164, 'balanced_accuracy': 0.5199780425371241, 'cohen_kappa': 0.476017569981947, 'f1_weighted': 0.6338074797700362, 'loss': 1.108917698264122, 'precision': 0.5310400755363657, 'sensitivity': 0.5199780425371241, 'f1': 0.47042871806640657, 'specificity': 0.9098173134626807}
Accuracy of the network on the 17965 val EEG: 0.68%
Test:  [ 0/48]  eta: 0:01:11  loss: 0.7182 (0.7182)  n: 300.0000 (300.0000)  accuracy: 0.7967 (0.7967)  balanced_accuracy: 0.5902 (0.5902)  cohen_kappa: 0.5681 (0.5681)  f1_weighted: 0.7918 (0.7918)  time: 1.4825  data: 1.2306  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [10/48]  eta: 0:00:14  loss: 0.7182 (0.7234)  n: 300.0000 (300.0000)  accuracy: 0.7967 (0.8012)  balanced_accuracy: 0.5745 (0.5518)  cohen_kappa: 0.5713 (0.5752)  f1_weighted: 0.7918 (0.7932)  time: 0.3749  data: 0.1120  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [20/48]  eta: 0:00:09  loss: 0.7216 (0.7408)  n: 300.0000 (300.0000)  accuracy: 0.7933 (0.7944)  balanced_accuracy: 0.5573 (0.5351)  cohen_kappa: 0.5705 (0.5641)  f1_weighted: 0.7868 (0.7858)  time: 0.2642  data: 0.0002  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [30/48]  eta: 0:00:05  loss: 0.7816 (0.7594)  n: 300.0000 (300.0000)  accuracy: 0.7833 (0.7898)  balanced_accuracy: 0.5319 (0.5363)  cohen_kappa: 0.5315 (0.5592)  f1_weighted: 0.7682 (0.7808)  time: 0.2642  data: 0.0002  max mem: 11436
Test:  [40/48]  eta: 0:00:02  loss: 0.7671 (0.7628)  n: 300.0000 (300.0000)  accuracy: 0.7833 (0.7900)  balanced_accuracy: 0.5374 (0.5367)  cohen_kappa: 0.5504 (0.5602)  f1_weighted: 0.7723 (0.7810)  time: 0.2644  data: 0.0002  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [47/48]  eta: 0:00:00  loss: 0.7557 (0.7619)  n: 300.0000 (294.8542)  accuracy: 0.7900 (0.7911)  balanced_accuracy: 0.5319 (0.5372)  cohen_kappa: 0.5580 (0.5614)  f1_weighted: 0.7810 (0.7821)  time: 0.2539  data: 0.0001  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test: Total time: 0:00:13 (0.2874 s / it)
* loss 0.755
{'accuracy': 0.7911396876987211, 'balanced_accuracy': 0.5407633603028706, 'cohen_kappa': 0.561699531343343, 'f1_weighted': 0.7822481446725181, 'loss': 0.7547791711986065, 'precision': 0.5914720817487362, 'sensitivity': 0.5407633603028706, 'f1': 0.5439485944519563, 'specificity': 0.935209650111616}
Accuracy of the network on the 28305 test EEG: 0.79%
Max accuracy val: 0.69%, max accuracy test: 0.79%
Epoch: [18]  [  0/164]  eta: 0:04:43  lr: 0.000023  min_lr: 0.000023  loss: 0.4963 (0.4963)  class_acc: 0.9850 (0.9850)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.4791 (3.4791)  time: 1.7293  data: 1.0729  max mem: 11436
Epoch: [18]  [ 10/164]  eta: 0:01:56  lr: 0.000021  min_lr: 0.000021  loss: 0.4963 (0.4955)  class_acc: 0.9750 (0.9777)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.6294 (3.7764)  time: 0.7564  data: 0.0976  max mem: 11436
Epoch: [18]  [ 20/164]  eta: 0:01:42  lr: 0.000020  min_lr: 0.000020  loss: 0.5020 (0.5074)  class_acc: 0.9700 (0.9719)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.8778 (4.0749)  time: 0.6595  data: 0.0001  max mem: 11436
Epoch: [18]  [ 30/164]  eta: 0:01:33  lr: 0.000019  min_lr: 0.000019  loss: 0.5020 (0.5046)  class_acc: 0.9700 (0.9734)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.9298 (4.0057)  time: 0.6598  data: 0.0001  max mem: 11436
Epoch: [18]  [ 40/164]  eta: 0:01:24  lr: 0.000018  min_lr: 0.000018  loss: 0.4948 (0.5050)  class_acc: 0.9750 (0.9732)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.7360 (4.0540)  time: 0.6583  data: 0.0001  max mem: 11436
Epoch: [18]  [ 50/164]  eta: 0:01:17  lr: 0.000017  min_lr: 0.000017  loss: 0.4931 (0.5033)  class_acc: 0.9750 (0.9741)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.8780 (4.0278)  time: 0.6584  data: 0.0003  max mem: 11436
Epoch: [18]  [ 60/164]  eta: 0:01:10  lr: 0.000015  min_lr: 0.000015  loss: 0.4891 (0.5033)  class_acc: 0.9800 (0.9744)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.0657 (4.0257)  time: 0.6590  data: 0.0003  max mem: 11436
Epoch: [18]  [ 70/164]  eta: 0:01:03  lr: 0.000014  min_lr: 0.000014  loss: 0.5009 (0.5039)  class_acc: 0.9750 (0.9739)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.0263 (4.0270)  time: 0.6576  data: 0.0001  max mem: 11436
Epoch: [18]  [ 80/164]  eta: 0:00:56  lr: 0.000013  min_lr: 0.000013  loss: 0.5055 (0.5042)  class_acc: 0.9700 (0.9741)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.9904 (4.0741)  time: 0.6587  data: 0.0003  max mem: 11436
Epoch: [18]  [ 90/164]  eta: 0:00:49  lr: 0.000012  min_lr: 0.000012  loss: 0.5055 (0.5047)  class_acc: 0.9700 (0.9740)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.0952 (4.0979)  time: 0.6597  data: 0.0003  max mem: 11436
Epoch: [18]  [100/164]  eta: 0:00:42  lr: 0.000012  min_lr: 0.000012  loss: 0.5005 (0.5047)  class_acc: 0.9700 (0.9736)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.0952 (4.1101)  time: 0.6593  data: 0.0001  max mem: 11436
Epoch: [18]  [110/164]  eta: 0:00:36  lr: 0.000011  min_lr: 0.000011  loss: 0.4949 (0.5038)  class_acc: 0.9700 (0.9739)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.9149 (4.1099)  time: 0.6589  data: 0.0001  max mem: 11436
Epoch: [18]  [120/164]  eta: 0:00:29  lr: 0.000010  min_lr: 0.000010  loss: 0.4947 (0.5038)  class_acc: 0.9800 (0.9740)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.6168 (4.1122)  time: 0.6590  data: 0.0002  max mem: 11436
Epoch: [18]  [130/164]  eta: 0:00:22  lr: 0.000009  min_lr: 0.000009  loss: 0.4931 (0.5033)  class_acc: 0.9750 (0.9740)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.8424 (4.1015)  time: 0.6606  data: 0.0003  max mem: 11436
Epoch: [18]  [140/164]  eta: 0:00:16  lr: 0.000008  min_lr: 0.000008  loss: 0.4952 (0.5034)  class_acc: 0.9750 (0.9740)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.7942 (4.0781)  time: 0.6602  data: 0.0003  max mem: 11436
Epoch: [18]  [150/164]  eta: 0:00:09  lr: 0.000007  min_lr: 0.000007  loss: 0.5057 (0.5033)  class_acc: 0.9750 (0.9742)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.7708 (4.0873)  time: 0.6598  data: 0.0003  max mem: 11436
Epoch: [18]  [160/164]  eta: 0:00:02  lr: 0.000007  min_lr: 0.000007  loss: 0.5057 (0.5037)  class_acc: 0.9700 (0.9739)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.0172 (4.0862)  time: 0.6598  data: 0.0003  max mem: 11436
Epoch: [18]  [163/164]  eta: 0:00:00  lr: 0.000007  min_lr: 0.000007  loss: 0.5070 (0.5037)  class_acc: 0.9700 (0.9740)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.0172 (4.0816)  time: 0.6594  data: 0.0001  max mem: 11436
Epoch: [18] Total time: 0:01:49 (0.6669 s / it)
Averaged stats: lr: 0.000007  min_lr: 0.000007  loss: 0.5070 (0.5050)  class_acc: 0.9700 (0.9739)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.0172 (4.0816)
Val:  [ 0/30]  eta: 0:00:47  loss: 1.0828 (1.0828)  n: 300.0000 (300.0000)  accuracy: 0.6833 (0.6833)  balanced_accuracy: 0.5482 (0.5482)  cohen_kappa: 0.4582 (0.4582)  f1_weighted: 0.6419 (0.6419)  time: 1.5851  data: 1.3284  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [10/30]  eta: 0:00:07  loss: 1.1131 (1.1416)  n: 300.0000 (300.0000)  accuracy: 0.6800 (0.6815)  balanced_accuracy: 0.5482 (0.5409)  cohen_kappa: 0.4897 (0.4798)  f1_weighted: 0.6453 (0.6388)  time: 0.3825  data: 0.1209  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [20/30]  eta: 0:00:03  loss: 1.1578 (1.1542)  n: 300.0000 (300.0000)  accuracy: 0.6800 (0.6757)  balanced_accuracy: 0.5222 (0.5268)  cohen_kappa: 0.4814 (0.4724)  f1_weighted: 0.6399 (0.6331)  time: 0.2633  data: 0.0001  max mem: 11436
Val:  [29/30]  eta: 0:00:00  loss: 1.1578 (1.1509)  n: 300.0000 (299.4333)  accuracy: 0.6667 (0.6725)  balanced_accuracy: 0.5198 (0.5217)  cohen_kappa: 0.4565 (0.4672)  f1_weighted: 0.6219 (0.6303)  time: 0.2637  data: 0.0001  max mem: 11436
Val: Total time: 0:00:09 (0.3122 s / it)
* loss 1.122
{'accuracy': 0.6724924858065234, 'balanced_accuracy': 0.5139727079646564, 'cohen_kappa': 0.4681223206607459, 'f1_weighted': 0.6299845544921161, 'loss': 1.122428098320961, 'precision': 0.5403609683728842, 'sensitivity': 0.5139727079646564, 'f1': 0.4744565893739705, 'specificity': 0.908180719784832}
Accuracy of the network on the 17965 val EEG: 0.67%
Test:  [ 0/48]  eta: 0:01:09  loss: 0.7203 (0.7203)  n: 300.0000 (300.0000)  accuracy: 0.7967 (0.7967)  balanced_accuracy: 0.5970 (0.5970)  cohen_kappa: 0.5704 (0.5704)  f1_weighted: 0.7922 (0.7922)  time: 1.4524  data: 1.1980  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [10/48]  eta: 0:00:14  loss: 0.7201 (0.7192)  n: 300.0000 (300.0000)  accuracy: 0.7967 (0.8009)  balanced_accuracy: 0.5736 (0.5474)  cohen_kappa: 0.5759 (0.5750)  f1_weighted: 0.7922 (0.7936)  time: 0.3719  data: 0.1091  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [20/48]  eta: 0:00:08  loss: 0.7201 (0.7363)  n: 300.0000 (300.0000)  accuracy: 0.7967 (0.7948)  balanced_accuracy: 0.5340 (0.5314)  cohen_kappa: 0.5639 (0.5645)  f1_weighted: 0.7820 (0.7866)  time: 0.2643  data: 0.0002  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [30/48]  eta: 0:00:05  loss: 0.7781 (0.7549)  n: 300.0000 (300.0000)  accuracy: 0.7800 (0.7896)  balanced_accuracy: 0.5374 (0.5319)  cohen_kappa: 0.5399 (0.5585)  f1_weighted: 0.7662 (0.7808)  time: 0.2653  data: 0.0002  max mem: 11436
Test:  [40/48]  eta: 0:00:02  loss: 0.7604 (0.7579)  n: 300.0000 (300.0000)  accuracy: 0.7800 (0.7899)  balanced_accuracy: 0.5382 (0.5331)  cohen_kappa: 0.5527 (0.5598)  f1_weighted: 0.7722 (0.7810)  time: 0.2647  data: 0.0001  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [47/48]  eta: 0:00:00  loss: 0.7472 (0.7567)  n: 300.0000 (294.8542)  accuracy: 0.7900 (0.7914)  balanced_accuracy: 0.5319 (0.5332)  cohen_kappa: 0.5586 (0.5615)  f1_weighted: 0.7830 (0.7824)  time: 0.2535  data: 0.0001  max mem: 11436
Test: Total time: 0:00:13 (0.2870 s / it)
* loss 0.750
{'accuracy': 0.7913516568925316, 'balanced_accuracy': 0.5364015911542825, 'cohen_kappa': 0.5617817109745822, 'f1_weighted': 0.7824554205488384, 'loss': 0.750146464134256, 'precision': 0.5812041595172789, 'sensitivity': 0.5364015911542825, 'f1': 0.534298027319652, 'specificity': 0.9353769855488056}
Accuracy of the network on the 28305 test EEG: 0.79%
Max accuracy val: 0.69%, max accuracy test: 0.79%
Epoch: [19]  [  0/164]  eta: 0:04:21  lr: 0.000006  min_lr: 0.000006  loss: 0.4846 (0.4846)  class_acc: 0.9850 (0.9850)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 2.7880 (2.7880)  time: 1.5959  data: 0.9304  max mem: 11436
Epoch: [19]  [ 10/164]  eta: 0:01:54  lr: 0.000006  min_lr: 0.000006  loss: 0.5184 (0.5131)  class_acc: 0.9600 (0.9677)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.1532 (4.1296)  time: 0.7433  data: 0.0848  max mem: 11436
Epoch: [19]  [ 20/164]  eta: 0:01:41  lr: 0.000005  min_lr: 0.000005  loss: 0.5081 (0.5081)  class_acc: 0.9750 (0.9733)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.8520 (4.1979)  time: 0.6584  data: 0.0002  max mem: 11436
Epoch: [19]  [ 30/164]  eta: 0:01:32  lr: 0.000005  min_lr: 0.000005  loss: 0.4921 (0.5040)  class_acc: 0.9800 (0.9753)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.7562 (4.1490)  time: 0.6590  data: 0.0001  max mem: 11436
Epoch: [19]  [ 40/164]  eta: 0:01:24  lr: 0.000004  min_lr: 0.000004  loss: 0.4945 (0.5012)  class_acc: 0.9800 (0.9766)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.7381 (4.0265)  time: 0.6581  data: 0.0003  max mem: 11436
Epoch: [19]  [ 50/164]  eta: 0:01:17  lr: 0.000004  min_lr: 0.000004  loss: 0.5025 (0.5046)  class_acc: 0.9750 (0.9751)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.9577 (4.1102)  time: 0.6581  data: 0.0006  max mem: 11436
Epoch: [19]  [ 60/164]  eta: 0:01:10  lr: 0.000003  min_lr: 0.000003  loss: 0.5039 (0.5040)  class_acc: 0.9750 (0.9755)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.9577 (4.0501)  time: 0.6589  data: 0.0005  max mem: 11436
Epoch: [19]  [ 70/164]  eta: 0:01:03  lr: 0.000003  min_lr: 0.000003  loss: 0.5083 (0.5053)  class_acc: 0.9700 (0.9746)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.9122 (4.0329)  time: 0.6584  data: 0.0001  max mem: 11436
Epoch: [19]  [ 80/164]  eta: 0:00:56  lr: 0.000002  min_lr: 0.000002  loss: 0.5055 (0.5042)  class_acc: 0.9700 (0.9749)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.9926 (4.0143)  time: 0.6582  data: 0.0001  max mem: 11436
Epoch: [19]  [ 90/164]  eta: 0:00:49  lr: 0.000002  min_lr: 0.000002  loss: 0.4986 (0.5040)  class_acc: 0.9750 (0.9750)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.1286 (4.0579)  time: 0.6589  data: 0.0002  max mem: 11436
Epoch: [19]  [100/164]  eta: 0:00:42  lr: 0.000002  min_lr: 0.000002  loss: 0.5011 (0.5035)  class_acc: 0.9750 (0.9751)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 4.1286 (4.0395)  time: 0.6600  data: 0.0002  max mem: 11436
Epoch: [19]  [110/164]  eta: 0:00:36  lr: 0.000002  min_lr: 0.000002  loss: 0.5025 (0.5037)  class_acc: 0.9750 (0.9750)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.9538 (4.0631)  time: 0.6593  data: 0.0001  max mem: 11436
Epoch: [19]  [120/164]  eta: 0:00:29  lr: 0.000001  min_lr: 0.000001  loss: 0.4920 (0.5035)  class_acc: 0.9750 (0.9749)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.9538 (4.0569)  time: 0.6586  data: 0.0001  max mem: 11436
Epoch: [19]  [130/164]  eta: 0:00:22  lr: 0.000001  min_lr: 0.000001  loss: 0.4920 (0.5033)  class_acc: 0.9800 (0.9750)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.8641 (4.0628)  time: 0.6604  data: 0.0001  max mem: 11436
Epoch: [19]  [140/164]  eta: 0:00:15  lr: 0.000001  min_lr: 0.000001  loss: 0.4990 (0.5034)  class_acc: 0.9800 (0.9751)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.8685 (4.0453)  time: 0.6602  data: 0.0002  max mem: 11436
Epoch: [19]  [150/164]  eta: 0:00:09  lr: 0.000001  min_lr: 0.000001  loss: 0.5061 (0.5041)  class_acc: 0.9750 (0.9750)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.7251 (4.0344)  time: 0.6587  data: 0.0002  max mem: 11436
Epoch: [19]  [160/164]  eta: 0:00:02  lr: 0.000001  min_lr: 0.000001  loss: 0.5025 (0.5043)  class_acc: 0.9750 (0.9749)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.6955 (4.0336)  time: 0.6593  data: 0.0001  max mem: 11436
Epoch: [19]  [163/164]  eta: 0:00:00  lr: 0.000001  min_lr: 0.000001  loss: 0.4986 (0.5040)  class_acc: 0.9750 (0.9749)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.5849 (4.0351)  time: 0.6595  data: 0.0001  max mem: 11436
Epoch: [19] Total time: 0:01:49 (0.6656 s / it)
Averaged stats: lr: 0.000001  min_lr: 0.000001  loss: 0.4986 (0.5039)  class_acc: 0.9750 (0.9751)  loss_scale: 8192.0000 (8192.0000)  weight_decay: 0.0500 (0.0500)  grad_norm: 3.5849 (4.0351)
Val:  [ 0/30]  eta: 0:00:41  loss: 1.0901 (1.0901)  n: 300.0000 (300.0000)  accuracy: 0.6633 (0.6633)  balanced_accuracy: 0.5321 (0.5321)  cohen_kappa: 0.4149 (0.4149)  f1_weighted: 0.6101 (0.6101)  time: 1.3818  data: 1.1267  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [10/30]  eta: 0:00:07  loss: 1.1200 (1.1513)  n: 300.0000 (300.0000)  accuracy: 0.6667 (0.6682)  balanced_accuracy: 0.5321 (0.5155)  cohen_kappa: 0.4523 (0.4526)  f1_weighted: 0.6236 (0.6223)  time: 0.3663  data: 0.1026  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Val:  [20/30]  eta: 0:00:03  loss: 1.1699 (1.1634)  n: 300.0000 (300.0000)  accuracy: 0.6633 (0.6625)  balanced_accuracy: 0.4740 (0.4997)  cohen_kappa: 0.4506 (0.4454)  f1_weighted: 0.6185 (0.6161)  time: 0.2646  data: 0.0001  max mem: 11436
Val:  [29/30]  eta: 0:00:00  loss: 1.1699 (1.1609)  n: 300.0000 (299.4333)  accuracy: 0.6533 (0.6594)  balanced_accuracy: 0.4740 (0.4990)  cohen_kappa: 0.4366 (0.4406)  f1_weighted: 0.6122 (0.6136)  time: 0.2634  data: 0.0001  max mem: 11436
Val: Total time: 0:00:09 (0.3042 s / it)
* loss 1.132
{'accuracy': 0.6593565623956362, 'balanced_accuracy': 0.49375031457341284, 'cohen_kappa': 0.4416629243417166, 'f1_weighted': 0.6133275474188893, 'loss': 1.1322225034236908, 'precision': 0.5291108459541393, 'sensitivity': 0.49375031457341284, 'f1': 0.4606758025098898, 'specificity': 0.9032847240426646}
Accuracy of the network on the 17965 val EEG: 0.66%
Test:  [ 0/48]  eta: 0:01:10  loss: 0.7123 (0.7123)  n: 300.0000 (300.0000)  accuracy: 0.7967 (0.7967)  balanced_accuracy: 0.6166 (0.6166)  cohen_kappa: 0.5630 (0.5630)  f1_weighted: 0.7867 (0.7867)  time: 1.4630  data: 1.2074  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [10/48]  eta: 0:00:14  loss: 0.7115 (0.7075)  n: 300.0000 (300.0000)  accuracy: 0.7967 (0.8045)  balanced_accuracy: 0.5646 (0.5474)  cohen_kappa: 0.5728 (0.5781)  f1_weighted: 0.7883 (0.7946)  time: 0.3720  data: 0.1099  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [20/48]  eta: 0:00:08  loss: 0.7115 (0.7253)  n: 300.0000 (300.0000)  accuracy: 0.7967 (0.7965)  balanced_accuracy: 0.5285 (0.5289)  cohen_kappa: 0.5644 (0.5637)  f1_weighted: 0.7860 (0.7856)  time: 0.2638  data: 0.0002  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [30/48]  eta: 0:00:05  loss: 0.7669 (0.7444)  n: 300.0000 (300.0000)  accuracy: 0.7800 (0.7922)  balanced_accuracy: 0.5285 (0.5305)  cohen_kappa: 0.5376 (0.5595)  f1_weighted: 0.7636 (0.7808)  time: 0.2652  data: 0.0002  max mem: 11436
Test:  [40/48]  eta: 0:00:02  loss: 0.7481 (0.7478)  n: 300.0000 (300.0000)  accuracy: 0.7833 (0.7924)  balanced_accuracy: 0.5365 (0.5307)  cohen_kappa: 0.5486 (0.5604)  f1_weighted: 0.7664 (0.7809)  time: 0.2652  data: 0.0001  max mem: 11436
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
/home/aa2650/playground/EEGPT/virtualenv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:2458: UserWarning: y_pred contains classes not in y_true
  warnings.warn("y_pred contains classes not in y_true")
Test:  [47/48]  eta: 0:00:00  loss: 0.7398 (0.7470)  n: 300.0000 (294.8542)  accuracy: 0.7933 (0.7938)  balanced_accuracy: 0.5365 (0.5306)  cohen_kappa: 0.5636 (0.5619)  f1_weighted: 0.7851 (0.7823)  time: 0.2541  data: 0.0001  max mem: 11436
Test: Total time: 0:00:13 (0.2869 s / it)
* loss 0.740
{'accuracy': 0.7937539744223839, 'balanced_accuracy': 0.5331693639001641, 'cohen_kappa': 0.5622041096913108, 'f1_weighted': 0.7825441380529592, 'loss': 0.7404048449049393, 'precision': 0.5816556097207034, 'sensitivity': 0.5331693639001641, 'f1': 0.53411717252124, 'specificity': 0.9345057842023382}
Accuracy of the network on the 28305 test EEG: 0.79%
Max accuracy val: 0.69%, max accuracy test: 0.79%
Training time 0:45:02
